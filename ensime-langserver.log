[2019-08-13 14:13:00,912] INFO org.github.dragos.vscode.Main$ - Starting server in /home/air/openmrs-etl
[2019-08-13 14:13:00,912] INFO org.github.dragos.vscode.Main$ - Starting server in /home/air/openmrs-etl
[2019-08-13 14:13:00,917] INFO org.github.dragos.vscode.Main$ - Classpath: /home/air/.vscode/extensions/dragos.scala-lsp-0.2.3/coursier
[2019-08-13 14:13:00,917] INFO org.github.dragos.vscode.Main$ - Classpath: /home/air/.vscode/extensions/dragos.scala-lsp-0.2.3/coursier
[2019-08-13 14:13:00,985] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1171
[2019-08-13 14:13:00,985] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1171
[2019-08-13 14:13:00,994] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":24536,"rootPath":"/home/air/openmrs-etl","rootUri":"file:///home/air/openmrs-etl","capabilities":{"workspace":{"applyEdit":true,"didChangeConfiguration":{"dynamicRegistration":false},"didChangeWatchedFiles":{"dynamicRegistration":false},"symbol":{"dynamicRegistration":true},"executeCommand":{"dynamicRegistration":true}},"textDocument":{"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"completionItem":{"snippetSupport":true}},"hover":{"dynamicRegistration":true},"signatureHelp":{"dynamicRegistration":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"definition":{"dynamicRegistration":true},"codeAction":{"dynamicRegistration":true},"codeLens":{"dynamicRegistration":true},"documentLink":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true}}},"trace":"off"}}
[2019-08-13 14:13:00,994] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":24536,"rootPath":"/home/air/openmrs-etl","rootUri":"file:///home/air/openmrs-etl","capabilities":{"workspace":{"applyEdit":true,"didChangeConfiguration":{"dynamicRegistration":false},"didChangeWatchedFiles":{"dynamicRegistration":false},"symbol":{"dynamicRegistration":true},"executeCommand":{"dynamicRegistration":true}},"textDocument":{"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"completionItem":{"snippetSupport":true}},"hover":{"dynamicRegistration":true},"signatureHelp":{"dynamicRegistration":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"definition":{"dynamicRegistration":true},"codeAction":{"dynamicRegistration":true},"codeLens":{"dynamicRegistration":true},"documentLink":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true}}},"trace":"off"}}
[2019-08-13 14:13:01,288] INFO org.github.dragos.vscode.EnsimeLanguageServer - Initialized with 24536, /home/air/openmrs-etl, ClientCapabilities()
[2019-08-13 14:13:01,288] INFO org.github.dragos.vscode.EnsimeLanguageServer - Initialized with 24536, /home/air/openmrs-etl, ClientCapabilities()
[2019-08-13 14:13:01,290] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - ensime.config = "/home/air/openmrs-etl/.ensime" 
[2019-08-13 14:13:01,290] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - ensime.config = "/home/air/openmrs-etl/.ensime" 
[2019-08-13 14:13:01,536] INFO akka.event.slf4j.Slf4jLogger - Slf4jLogger started
[2019-08-13 14:13:01,621] ERROR org.github.dragos.vscode.EnsimeLanguageServer - initializeEnsime Error: /home/air/openmrs-etl/.ensime
[2019-08-13 14:13:01,621] ERROR org.github.dragos.vscode.EnsimeLanguageServer - initializeEnsime Error: /home/air/openmrs-etl/.ensime
[2019-08-13 14:13:01,665] DEBUG langserver.core.MessageWriter - Content-Length: 146



{"jsonrpc":"2.0","method":"window/showMessage","params":{"tpe":1,"message":"No .ensime file in directory. Run `sbt ensimeConfig` to create one."}}
[2019-08-13 14:13:01,665] DEBUG langserver.core.MessageWriter - Content-Length: 146



{"jsonrpc":"2.0","method":"window/showMessage","params":{"tpe":1,"message":"No .ensime file in directory. Run `sbt ensimeConfig` to create one."}}
[2019-08-13 14:13:01,665] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","method":"window/showMessage","params":{"tpe":1,"message":"No .ensime file in directory. Run `sbt ensimeConfig` to create one."}}
[2019-08-13 14:13:01,665] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","method":"window/showMessage","params":{"tpe":1,"message":"No .ensime file in directory. Run `sbt ensimeConfig` to create one."}}
[2019-08-13 14:13:01,715] DEBUG langserver.core.MessageWriter - Content-Length: 441



{"jsonrpc":"2.0","result":{"capabilities":{"textDocumentSync":1,"hoverProvider":true,"completionProvider":{"resolveProvider":false,"triggerCharacters":["."]},"definitionProvider":true,"referencesProvider":false,"documentHighlightProvider":false,"documentSymbolProvider":true,"workspaceSymbolProvider":false,"codeActionProvider":false,"documentFormattingProvider":false,"documentRangeFormattingProvider":false,"renameProvider":false}},"id":0}
[2019-08-13 14:13:01,715] DEBUG langserver.core.MessageWriter - Content-Length: 441



{"jsonrpc":"2.0","result":{"capabilities":{"textDocumentSync":1,"hoverProvider":true,"completionProvider":{"resolveProvider":false,"triggerCharacters":["."]},"definitionProvider":true,"referencesProvider":false,"documentHighlightProvider":false,"documentSymbolProvider":true,"workspaceSymbolProvider":false,"codeActionProvider":false,"documentFormattingProvider":false,"documentRangeFormattingProvider":false,"renameProvider":false}},"id":0}
[2019-08-13 14:13:01,715] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":{"capabilities":{"textDocumentSync":1,"hoverProvider":true,"completionProvider":{"resolveProvider":false,"triggerCharacters":["."]},"definitionProvider":true,"referencesProvider":false,"documentHighlightProvider":false,"documentSymbolProvider":true,"workspaceSymbolProvider":false,"codeActionProvider":false,"documentFormattingProvider":false,"documentRangeFormattingProvider":false,"renameProvider":false}},"id":0}
[2019-08-13 14:13:01,715] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":{"capabilities":{"textDocumentSync":1,"hoverProvider":true,"completionProvider":{"resolveProvider":false,"triggerCharacters":["."]},"definitionProvider":true,"referencesProvider":false,"documentHighlightProvider":false,"documentSymbolProvider":true,"workspaceSymbolProvider":false,"codeActionProvider":false,"documentFormattingProvider":false,"documentRangeFormattingProvider":false,"renameProvider":false}},"id":0}
[2019-08-13 14:13:01,716] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 52
[2019-08-13 14:13:01,716] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 52
[2019-08-13 14:13:01,717] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"initialized","params":{}}
[2019-08-13 14:13:01,717] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"initialized","params":{}}
[2019-08-13 14:13:01,729] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification Initialized()
[2019-08-13 14:13:01,729] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification Initialized()
[2019-08-13 14:13:01,729] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:13:01,729] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:13:01,730] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:13:01,730] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:13:01,736] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 192
[2019-08-13 14:13:01,736] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 192
[2019-08-13 14:13:01,736] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":1,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:13:01,736] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":1,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:13:01,739] DEBUG langserver.core.MessageWriter - Content-Length: 36



{"jsonrpc":"2.0","result":[],"id":1}
[2019-08-13 14:13:01,739] DEBUG langserver.core.MessageWriter - Content-Length: 36



{"jsonrpc":"2.0","result":[],"id":1}
[2019-08-13 14:13:01,739] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":1}
[2019-08-13 14:13:01,739] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":1}
[2019-08-13 14:14:13,240] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:14:13,240] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:14:13,243] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":2,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":10,"character":0}}}
[2019-08-13 14:14:13,243] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":2,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":10,"character":0}}}
[2019-08-13 14:14:13,252] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (10, 0).
[2019-08-13 14:14:13,252] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (10, 0).
[2019-08-13 14:14:13,295] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:14:13,295] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:14:13,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:14:13,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:14:13,428] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:14:13,428] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:14:13,430] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":2}}
[2019-08-13 14:14:13,430] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":2}}
[2019-08-13 14:14:13,439] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(2)
[2019-08-13 14:14:13,439] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(2)
[2019-08-13 14:15:37,691] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:15:37,691] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:15:37,693] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":3,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":8,"character":40}}}
[2019-08-13 14:15:37,693] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":3,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":8,"character":40}}}
[2019-08-13 14:15:37,697] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (8, 40).
[2019-08-13 14:15:37,697] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (8, 40).
[2019-08-13 14:15:37,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:37,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:37,701] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:37,701] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:37,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:37,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:37,744] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":3}}
[2019-08-13 14:15:37,744] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":3}}
[2019-08-13 14:15:37,751] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(3)
[2019-08-13 14:15:37,751] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(3)
[2019-08-13 14:15:38,807] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 219
[2019-08-13 14:15:38,807] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 219
[2019-08-13 14:15:38,810] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":4,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":8,"character":4}}}
[2019-08-13 14:15:38,810] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":4,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":8,"character":4}}}
[2019-08-13 14:15:38,821] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (8, 4).
[2019-08-13 14:15:38,821] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (8, 4).
[2019-08-13 14:15:38,823] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:38,823] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:38,823] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:38,823] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:38,922] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:38,922] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:38,923] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":4}}
[2019-08-13 14:15:38,923] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":4}}
[2019-08-13 14:15:38,927] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(4)
[2019-08-13 14:15:38,927] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(4)
[2019-08-13 14:15:40,235] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 14:15:40,235] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 14:15:40,237] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":5,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":16,"character":15}}}
[2019-08-13 14:15:40,237] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":5,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":16,"character":15}}}
[2019-08-13 14:15:40,241] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 15).
[2019-08-13 14:15:40,241] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 15).
[2019-08-13 14:15:40,242] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:40,242] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:40,242] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:40,242] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:41,394] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:41,394] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:41,394] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":5}}
[2019-08-13 14:15:41,394] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":5}}
[2019-08-13 14:15:41,396] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(5)
[2019-08-13 14:15:41,396] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(5)
[2019-08-13 14:15:41,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 930
[2019-08-13 14:15:41,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 930
[2019-08-13 14:15:41,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":2},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:15:41,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":2},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:15:41,620] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:15:41,620] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:15:41,736] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 192
[2019-08-13 14:15:41,736] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 192
[2019-08-13 14:15:41,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":6,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:15:41,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":6,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:15:41,738] DEBUG langserver.core.MessageWriter - Content-Length: 36



{"jsonrpc":"2.0","result":[],"id":6}
[2019-08-13 14:15:41,738] DEBUG langserver.core.MessageWriter - Content-Length: 36



{"jsonrpc":"2.0","result":[],"id":6}
[2019-08-13 14:15:41,738] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":6}
[2019-08-13 14:15:41,738] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":6}
[2019-08-13 14:15:42,992] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 978
[2019-08-13 14:15:42,992] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 978
[2019-08-13 14:15:42,995] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":3},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:15:42,995] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":3},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:15:43,003] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:15:43,003] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:15:43,134] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 192
[2019-08-13 14:15:43,134] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 192
[2019-08-13 14:15:43,135] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":7,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:15:43,135] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":7,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:15:43,139] DEBUG langserver.core.MessageWriter - Content-Length: 36



{"jsonrpc":"2.0","result":[],"id":7}
[2019-08-13 14:15:43,139] DEBUG langserver.core.MessageWriter - Content-Length: 36



{"jsonrpc":"2.0","result":[],"id":7}
[2019-08-13 14:15:43,139] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":7}
[2019-08-13 14:15:43,139] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":7}
[2019-08-13 14:15:50,386] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 14:15:50,386] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 14:15:50,388] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":8,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":21}}}
[2019-08-13 14:15:50,388] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":8,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":21}}}
[2019-08-13 14:15:50,390] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 21).
[2019-08-13 14:15:50,390] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 21).
[2019-08-13 14:15:50,391] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:50,391] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:50,392] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:50,392] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:51,233] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:51,233] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:51,234] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":8}}
[2019-08-13 14:15:51,234] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":8}}
[2019-08-13 14:15:51,240] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(8)
[2019-08-13 14:15:51,240] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(8)
[2019-08-13 14:15:51,483] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 14:15:51,483] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 14:15:51,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":9,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":22}}}
[2019-08-13 14:15:51,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":9,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":22}}}
[2019-08-13 14:15:51,488] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 22).
[2019-08-13 14:15:51,488] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 22).
[2019-08-13 14:15:51,489] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:51,489] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:51,489] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:51,489] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:51,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:51,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 62
[2019-08-13 14:15:51,744] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":9}}
[2019-08-13 14:15:51,744] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":9}}
[2019-08-13 14:15:51,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(9)
[2019-08-13 14:15:51,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(9)
[2019-08-13 14:15:53,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:15:53,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:15:53,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":10,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":31}}}
[2019-08-13 14:15:53,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":10,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":31}}}
[2019-08-13 14:15:53,529] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 31).
[2019-08-13 14:15:53,529] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 31).
[2019-08-13 14:15:53,530] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:53,531] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:53,530] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:15:53,531] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:15:53,858] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:15:53,858] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:15:53,859] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":10}}
[2019-08-13 14:15:53,859] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":10}}
[2019-08-13 14:15:53,863] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(10)
[2019-08-13 14:15:53,863] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(10)
[2019-08-13 14:16:06,463] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:16:06,463] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:16:06,465] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":11,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":21}}}
[2019-08-13 14:16:06,465] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":11,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":11,"character":21}}}
[2019-08-13 14:16:06,468] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 21).
[2019-08-13 14:16:06,468] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (11, 21).
[2019-08-13 14:16:06,469] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:16:06,469] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:16:06,469] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:16:06,469] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:16:06,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:06,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:06,543] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":11}}
[2019-08-13 14:16:06,543] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":11}}
[2019-08-13 14:16:06,547] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(11)
[2019-08-13 14:16:06,547] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(11)
[2019-08-13 14:16:07,319] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:16:07,319] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:16:07,319] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":12,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":21,"character":44}}}
[2019-08-13 14:16:07,319] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":12,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":21,"character":44}}}
[2019-08-13 14:16:07,320] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (21, 44).
[2019-08-13 14:16:07,320] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (21, 44).
[2019-08-13 14:16:07,320] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:16:07,320] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:16:07,320] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:16:07,320] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:16:08,009] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:08,009] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:08,009] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":12}}
[2019-08-13 14:16:08,009] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":12}}
[2019-08-13 14:16:08,011] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(12)
[2019-08-13 14:16:08,011] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(12)
[2019-08-13 14:16:08,210] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 979
[2019-08-13 14:16:08,210] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 979
[2019-08-13 14:16:08,210] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":4},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:08,210] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":4},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:08,212] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:08,212] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:08,415] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 980
[2019-08-13 14:16:08,415] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 980
[2019-08-13 14:16:08,415] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":5},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KaCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:08,415] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":5},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KaCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:08,417] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:08,417] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:08,765] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 981
[2019-08-13 14:16:08,765] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 981
[2019-08-13 14:16:08,766] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":6},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KafCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:08,766] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":6},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KafCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:08,768] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:08,768] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:08,908] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:08,908] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:08,908] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":13,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:08,908] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":13,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:08,909] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":13}
[2019-08-13 14:16:08,909] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":13}
[2019-08-13 14:16:08,909] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":13}
[2019-08-13 14:16:08,909] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":13}
[2019-08-13 14:16:09,350] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 983
[2019-08-13 14:16:09,350] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 983
[2019-08-13 14:16:09,350] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":8},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KafkaCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:09,350] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":8},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KafkaCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:09,351] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:09,351] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:09,574] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 984
[2019-08-13 14:16:09,574] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 984
[2019-08-13 14:16:09,575] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":9},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:09,575] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":9},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:09,576] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:09,576] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:09,716] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:09,716] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:09,716] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":14,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:09,716] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":14,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:09,717] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":14}
[2019-08-13 14:16:09,717] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":14}
[2019-08-13 14:16:09,717] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":14}
[2019-08-13 14:16:09,717] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":14}
[2019-08-13 14:16:34,160] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:16:34,160] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:16:34,161] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":15,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":15,"character":10}}}
[2019-08-13 14:16:34,161] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":15,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":15,"character":10}}}
[2019-08-13 14:16:34,163] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 10).
[2019-08-13 14:16:34,163] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 10).
[2019-08-13 14:16:34,164] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:16:34,164] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:16:34,164] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:16:34,164] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:16:34,746] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:34,746] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:34,747] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":15}}
[2019-08-13 14:16:34,747] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":15}}
[2019-08-13 14:16:34,751] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(15)
[2019-08-13 14:16:34,751] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(15)
[2019-08-13 14:16:34,898] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 981
[2019-08-13 14:16:34,898] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 981
[2019-08-13 14:16:34,899] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":10},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\no SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:34,899] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":10},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\no SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:34,904] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:34,904] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:34,905] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 226
[2019-08-13 14:16:34,905] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 226
[2019-08-13 14:16:34,906] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":16,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":13,"character":1}}}
[2019-08-13 14:16:34,906] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":16,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":13,"character":1}}}
[2019-08-13 14:16:34,911] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 14:16:34,911] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 14:16:35,093] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:35,093] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:35,094] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":17,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:35,094] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":17,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:35,097] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":17}
[2019-08-13 14:16:35,097] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":17}
[2019-08-13 14:16:35,097] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":17}
[2019-08-13 14:16:35,097] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":17}
[2019-08-13 14:16:36,015] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 986
[2019-08-13 14:16:36,015] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 986
[2019-08-13 14:16:36,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":15},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\nobject SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:36,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":15},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\nobject SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:16:36,021] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:36,021] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:16:36,128] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:36,128] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:16:36,129] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":18,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:36,129] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":18,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:16:36,133] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":18}
[2019-08-13 14:16:36,133] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":18}
[2019-08-13 14:16:36,134] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":18}
[2019-08-13 14:16:36,134] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":18}
[2019-08-13 14:16:37,204] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:37,204] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:16:37,205] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":16}}
[2019-08-13 14:16:37,205] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":16}}
[2019-08-13 14:16:37,207] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(16)
[2019-08-13 14:16:37,207] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(16)
[2019-08-13 14:16:45,936] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1719
[2019-08-13 14:16:45,936] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1719
[2019-08-13 14:16:45,937] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport org.apache.spark._\nimport org.scalatest._\n\ntrait SparkSpec extends BeforeAndAfterAll {\n  this: Suite =>\n\n  private var scVar: SparkContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    val conf = new SparkConf()\n      .setMaster(\"local[*]\")\n      .setAppName(this.getClass.getSimpleName)\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    scVar = new SparkContext(conf)\n  }\n\n  def sparkConfig: Map[String, String] = Map.empty\n\n  override def afterAll(): Unit = {\n    if (scVar != null) {\n      scVar.stop()\n      scVar = null // scalastyle:ignore null\n    }\n    super.afterAll()\n  }\n\n  def sc: SparkContext = scVar\n\n}\n"}}}
[2019-08-13 14:16:45,937] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport org.apache.spark._\nimport org.scalatest._\n\ntrait SparkSpec extends BeforeAndAfterAll {\n  this: Suite =>\n\n  private var scVar: SparkContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    val conf = new SparkConf()\n      .setMaster(\"local[*]\")\n      .setAppName(this.getClass.getSimpleName)\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    scVar = new SparkContext(conf)\n  }\n\n  def sparkConfig: Map[String, String] = Map.empty\n\n  override def afterAll(): Unit = {\n    if (scVar != null) {\n      scVar.stop()\n      scVar = null // scalastyle:ignore null\n    }\n    super.afterAll()\n  }\n\n  def sc: SparkContext = scVar\n\n}\n"}}}
[2019-08-13 14:16:45,938] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 177
[2019-08-13 14:16:45,938] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 177
[2019-08-13 14:16:45,938] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":19,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:16:45,938] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":19,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:16:45,938] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":19}
[2019-08-13 14:16:45,938] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":19}
[2019-08-13 14:16:45,938] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":19}
[2019-08-13 14:16:45,938] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":19}
[2019-08-13 14:16:50,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2315
[2019-08-13 14:16:50,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2315
[2019-08-13 14:16:50,596] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.streaming._\nimport org.scalatest._\n\ntrait SparkStreamingSpec extends SparkSpec {\n  this: Suite =>\n\n  import java.nio.file.Files\n  import java.util.concurrent.TimeUnit\n\n  import ClockWrapper._\n\n  private var sscVar: StreamingContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    sscVar = new StreamingContext(sc, batchDuration)\n    sscVar.checkpoint(checkpointDir)\n  }\n\n  def batchDuration: Duration = Seconds(1)\n\n  def checkpointDir: String = Files.createTempDirectory(this.getClass.getSimpleName).toUri.toString\n\n  override def afterAll(): Unit = {\n    if (sscVar != null) {\n      sscVar.stop(stopSparkContext = false, stopGracefully = false)\n      sscVar = null // scalastyle:ignore null\n    }\n\n    super.afterAll()\n  }\n\n  override def sparkConfig: Map[String, String] = {\n    super.sparkConfig + (\"spark.streaming.clock\" -> \"org.apache.spark.streaming.util.ManualClock\")\n  }\n\n  def ssc: StreamingContext = sscVar\n\n  def advanceClock(timeToAdd: FiniteDuration): Unit = {\n    advance(sscVar, timeToAdd)\n  }\n\n  def advanceClockOneBatch(): Unit = {\n    advance(sscVar, FiniteDuration(batchDuration.milliseconds, TimeUnit.MILLISECONDS))\n  }\n\n}\n"}}}
[2019-08-13 14:16:50,596] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.streaming._\nimport org.scalatest._\n\ntrait SparkStreamingSpec extends SparkSpec {\n  this: Suite =>\n\n  import java.nio.file.Files\n  import java.util.concurrent.TimeUnit\n\n  import ClockWrapper._\n\n  private var sscVar: StreamingContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    sscVar = new StreamingContext(sc, batchDuration)\n    sscVar.checkpoint(checkpointDir)\n  }\n\n  def batchDuration: Duration = Seconds(1)\n\n  def checkpointDir: String = Files.createTempDirectory(this.getClass.getSimpleName).toUri.toString\n\n  override def afterAll(): Unit = {\n    if (sscVar != null) {\n      sscVar.stop(stopSparkContext = false, stopGracefully = false)\n      sscVar = null // scalastyle:ignore null\n    }\n\n    super.afterAll()\n  }\n\n  override def sparkConfig: Map[String, String] = {\n    super.sparkConfig + (\"spark.streaming.clock\" -> \"org.apache.spark.streaming.util.ManualClock\")\n  }\n\n  def ssc: StreamingContext = sscVar\n\n  def advanceClock(timeToAdd: FiniteDuration): Unit = {\n    advance(sscVar, timeToAdd)\n  }\n\n  def advanceClockOneBatch(): Unit = {\n    advance(sscVar, FiniteDuration(batchDuration.milliseconds, TimeUnit.MILLISECONDS))\n  }\n\n}\n"}}}
[2019-08-13 14:16:50,597] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 186
[2019-08-13 14:16:50,597] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 186
[2019-08-13 14:16:50,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":20,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 14:16:50,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":20,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 14:16:50,599] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":20}
[2019-08-13 14:16:50,599] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":20}
[2019-08-13 14:16:50,599] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":20}
[2019-08-13 14:16:50,599] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":20}
[2019-08-13 14:17:20,295] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:17:20,295] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:17:20,297] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":21,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":54,"character":19}}}
[2019-08-13 14:17:20,297] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":21,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":54,"character":19}}}
[2019-08-13 14:17:20,299] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 19).
[2019-08-13 14:17:20,299] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 19).
[2019-08-13 14:17:20,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:17:20,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:17:20,301] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:17:20,301] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:17:20,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:20,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:20,622] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":21}}
[2019-08-13 14:17:20,622] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":21}}
[2019-08-13 14:17:20,624] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(21)
[2019-08-13 14:17:20,624] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(21)
[2019-08-13 14:17:20,733] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:20,733] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:20,734] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":22,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:20,734] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":22,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:20,736] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 17).
[2019-08-13 14:17:20,736] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 17).
[2019-08-13 14:17:20,742] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:20,742] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:20,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:17:20,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:17:20,869] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":23,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:20,869] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":23,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:20,870] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 17).
[2019-08-13 14:17:20,870] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 17).
[2019-08-13 14:17:20,872] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:17:20,872] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:17:20,872] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:17:20,872] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:17:20,891] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:20,891] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:20,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":23}}
[2019-08-13 14:17:20,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":23}}
[2019-08-13 14:17:20,895] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(23)
[2019-08-13 14:17:20,895] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(23)
[2019-08-13 14:17:20,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:20,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:20,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":22}}
[2019-08-13 14:17:20,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":22}}
[2019-08-13 14:17:20,924] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(22)
[2019-08-13 14:17:20,924] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(22)
[2019-08-13 14:17:20,924] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:20,924] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:20,925] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":24,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:20,925] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":24,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:20,927] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 17).
[2019-08-13 14:17:20,927] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 17).
[2019-08-13 14:17:20,929] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:20,929] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:21,069] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:17:21,069] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:17:21,070] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":25,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:21,070] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":25,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":17}}}
[2019-08-13 14:17:21,071] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 17).
[2019-08-13 14:17:21,071] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 17).
[2019-08-13 14:17:21,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:17:21,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:17:21,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:17:21,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:17:21,131] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,131] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,132] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":25}}
[2019-08-13 14:17:21,132] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":25}}
[2019-08-13 14:17:21,135] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(25)
[2019-08-13 14:17:21,135] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(25)
[2019-08-13 14:17:21,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,223] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":24}}
[2019-08-13 14:17:21,223] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":24}}
[2019-08-13 14:17:21,226] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(24)
[2019-08-13 14:17:21,226] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(24)
[2019-08-13 14:17:21,227] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:21,227] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:21,227] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":26,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":18}}}
[2019-08-13 14:17:21,227] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":26,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":18}}}
[2019-08-13 14:17:21,229] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 18).
[2019-08-13 14:17:21,229] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 18).
[2019-08-13 14:17:21,231] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:21,231] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:21,421] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,421] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,422] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":26}}
[2019-08-13 14:17:21,422] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":26}}
[2019-08-13 14:17:21,425] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(26)
[2019-08-13 14:17:21,425] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(26)
[2019-08-13 14:17:21,425] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:21,425] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:21,426] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":27,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":18}}}
[2019-08-13 14:17:21,426] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":27,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":60,"character":18}}}
[2019-08-13 14:17:21,428] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 18).
[2019-08-13 14:17:21,428] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 18).
[2019-08-13 14:17:21,429] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:21,429] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:21,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:21,623] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":27}}
[2019-08-13 14:17:21,623] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":27}}
[2019-08-13 14:17:21,626] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(27)
[2019-08-13 14:17:21,626] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(27)
[2019-08-13 14:17:21,627] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:21,627] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:21,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":28,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":53,"character":23}}}
[2019-08-13 14:17:21,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":28,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":53,"character":23}}}
[2019-08-13 14:17:21,629] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (53, 23).
[2019-08-13 14:17:21,629] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (53, 23).
[2019-08-13 14:17:21,631] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:21,631] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:32,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:32,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:32,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":28}}
[2019-08-13 14:17:32,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":28}}
[2019-08-13 14:17:32,775] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(28)
[2019-08-13 14:17:32,775] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(28)
[2019-08-13 14:17:32,776] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:32,776] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:32,776] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":29,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":53,"character":40}}}
[2019-08-13 14:17:32,776] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":29,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":53,"character":40}}}
[2019-08-13 14:17:32,779] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (53, 40).
[2019-08-13 14:17:32,779] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (53, 40).
[2019-08-13 14:17:32,780] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:32,780] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:33,271] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:33,271] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:33,272] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":29}}
[2019-08-13 14:17:33,272] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":29}}
[2019-08-13 14:17:33,275] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(29)
[2019-08-13 14:17:33,275] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(29)
[2019-08-13 14:17:33,276] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:33,276] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:33,277] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":30,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":47,"character":43}}}
[2019-08-13 14:17:33,277] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":30,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":47,"character":43}}}
[2019-08-13 14:17:33,278] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (47, 43).
[2019-08-13 14:17:33,278] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (47, 43).
[2019-08-13 14:17:33,280] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:33,280] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:33,372] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:33,372] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:33,373] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":30}}
[2019-08-13 14:17:33,373] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":30}}
[2019-08-13 14:17:33,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(30)
[2019-08-13 14:17:33,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(30)
[2019-08-13 14:17:33,376] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:33,376] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 220
[2019-08-13 14:17:33,376] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":31,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":46,"character":28}}}
[2019-08-13 14:17:33,376] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":31,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"},"position":{"line":46,"character":28}}}
[2019-08-13 14:17:33,378] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (46, 28).
[2019-08-13 14:17:33,378] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (46, 28).
[2019-08-13 14:17:33,381] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:33,381] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:34,154] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 986
[2019-08-13 14:17:34,154] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 986
[2019-08-13 14:17:34,155] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":15},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\nobject SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:34,155] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":15},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\nobject SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:34,157] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:34,157] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:34,401] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:34,401] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:34,402] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":31}}
[2019-08-13 14:17:34,402] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":31}}
[2019-08-13 14:17:34,404] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(31)
[2019-08-13 14:17:34,404] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(31)
[2019-08-13 14:17:34,404] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 226
[2019-08-13 14:17:34,404] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 226
[2019-08-13 14:17:34,404] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":32,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":8,"character":33}}}
[2019-08-13 14:17:34,404] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":32,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":8,"character":33}}}
[2019-08-13 14:17:34,405] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (8, 33).
[2019-08-13 14:17:34,405] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (8, 33).
[2019-08-13 14:17:34,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:34,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:34,656] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:34,656] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:34,658] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":32}}
[2019-08-13 14:17:34,658] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":32}}
[2019-08-13 14:17:34,660] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(32)
[2019-08-13 14:17:34,660] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(32)
[2019-08-13 14:17:34,661] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 985
[2019-08-13 14:17:34,661] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 985
[2019-08-13 14:17:34,662] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":21},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:34,662] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":21},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Kafka Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:34,665] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:34,665] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:34,666] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 227
[2019-08-13 14:17:34,666] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 227
[2019-08-13 14:17:34,667] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":33,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":13,"character":33}}}
[2019-08-13 14:17:34,667] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":33,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":13,"character":33}}}
[2019-08-13 14:17:34,669] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (13, 33).
[2019-08-13 14:17:34,669] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (13, 33).
[2019-08-13 14:17:34,670] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:34,670] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:34,883] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:17:34,883] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:17:34,885] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":34,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:34,885] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":34,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:34,887] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":34}
[2019-08-13 14:17:34,887] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":34}
[2019-08-13 14:17:34,887] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":34}
[2019-08-13 14:17:34,887] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":34}
[2019-08-13 14:17:35,173] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 984
[2019-08-13 14:17:35,173] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 984
[2019-08-13 14:17:35,175] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":22},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KafkaCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:35,175] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":22},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming KafkaCassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:35,179] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:35,179] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:35,322] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:17:35,322] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:17:35,322] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":35,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:35,322] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":35,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:35,323] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":35}
[2019-08-13 14:17:35,323] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":35}
[2019-08-13 14:17:35,324] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":35}
[2019-08-13 14:17:35,324] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":35}
[2019-08-13 14:17:35,539] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 979
[2019-08-13 14:17:35,539] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 979
[2019-08-13 14:17:35,540] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":27},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:35,540] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":27},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\n/**\n  * Spark Streaming Cassandra Example\n  */\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:35,542] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:35,542] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:35,977] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 929
[2019-08-13 14:17:35,977] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 929
[2019-08-13 14:17:35,978] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":29},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:35,978] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","version":29},"contentChanges":[{"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}]}}
[2019-08-13 14:17:35,980] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:35,980] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:17:36,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:17:36,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:17:36,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":36,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:36,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":36,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:36,126] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":36}
[2019-08-13 14:17:36,126] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":36}
[2019-08-13 14:17:36,127] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":36}
[2019-08-13 14:17:36,127] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":36}
[2019-08-13 14:17:36,712] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:36,712] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:17:36,713] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":33}}
[2019-08-13 14:17:36,713] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":33}}
[2019-08-13 14:17:36,715] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(33)
[2019-08-13 14:17:36,715] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(33)
[2019-08-13 14:17:36,715] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 227
[2019-08-13 14:17:36,715] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 227
[2019-08-13 14:17:36,715] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":37,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":14,"character":33}}}
[2019-08-13 14:17:36,715] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":37,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":14,"character":33}}}
[2019-08-13 14:17:36,717] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (14, 33).
[2019-08-13 14:17:36,717] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (14, 33).
[2019-08-13 14:17:36,718] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:36,718] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:17:39,276] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:17:39,276] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:17:39,276] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:39,276] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:17:39,279] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:17:39,279] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:17:41,289] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 163
[2019-08-13 14:17:41,289] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 163
[2019-08-13 14:17:41,290] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:17:41,290] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:17:41,291] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala from Ensime.
[2019-08-13 14:17:41,291] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala from Ensime.
[2019-08-13 14:17:42,703] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 172
[2019-08-13 14:17:42,703] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 172
[2019-08-13 14:17:42,703] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 14:17:42,703] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 14:17:42,704] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala from Ensime.
[2019-08-13 14:17:42,704] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala from Ensime.
[2019-08-13 14:19:54,206] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:19:54,206] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:19:54,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","languageId":"scala","version":1,"text":""}}}
[2019-08-13 14:19:54,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","languageId":"scala","version":1,"text":""}}}
[2019-08-13 14:19:54,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:19:54,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:19:54,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":38,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:19:54,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":38,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:19:54,208] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":38}
[2019-08-13 14:19:54,208] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":38}
[2019-08-13 14:19:54,208] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":38}
[2019-08-13 14:19:54,208] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":38}
[2019-08-13 14:20:00,063] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1719
[2019-08-13 14:20:00,063] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1719
[2019-08-13 14:20:00,064] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport org.apache.spark._\nimport org.scalatest._\n\ntrait SparkSpec extends BeforeAndAfterAll {\n  this: Suite =>\n\n  private var scVar: SparkContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    val conf = new SparkConf()\n      .setMaster(\"local[*]\")\n      .setAppName(this.getClass.getSimpleName)\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    scVar = new SparkContext(conf)\n  }\n\n  def sparkConfig: Map[String, String] = Map.empty\n\n  override def afterAll(): Unit = {\n    if (scVar != null) {\n      scVar.stop()\n      scVar = null // scalastyle:ignore null\n    }\n    super.afterAll()\n  }\n\n  def sc: SparkContext = scVar\n\n}\n"}}}
[2019-08-13 14:20:00,064] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport org.apache.spark._\nimport org.scalatest._\n\ntrait SparkSpec extends BeforeAndAfterAll {\n  this: Suite =>\n\n  private var scVar: SparkContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    val conf = new SparkConf()\n      .setMaster(\"local[*]\")\n      .setAppName(this.getClass.getSimpleName)\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    scVar = new SparkContext(conf)\n  }\n\n  def sparkConfig: Map[String, String] = Map.empty\n\n  override def afterAll(): Unit = {\n    if (scVar != null) {\n      scVar.stop()\n      scVar = null // scalastyle:ignore null\n    }\n    super.afterAll()\n  }\n\n  def sc: SparkContext = scVar\n\n}\n"}}}
[2019-08-13 14:20:00,064] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 177
[2019-08-13 14:20:00,064] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 177
[2019-08-13 14:20:00,065] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":39,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:20:00,065] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":39,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:20:00,065] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":39}
[2019-08-13 14:20:00,065] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":39}
[2019-08-13 14:20:00,065] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":39}
[2019-08-13 14:20:00,065] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":39}
[2019-08-13 14:20:01,650] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 204
[2019-08-13 14:20:01,650] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 204
[2019-08-13 14:20:01,651] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":40,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":4,"character":9}}}
[2019-08-13 14:20:01,651] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":40,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":4,"character":9}}}
[2019-08-13 14:20:01,653] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (4, 9).
[2019-08-13 14:20:01,653] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (4, 9).
[2019-08-13 14:20:01,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:01,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:01,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:01,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:01,798] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:01,798] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:01,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":40}}
[2019-08-13 14:20:01,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":40}}
[2019-08-13 14:20:01,801] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(40)
[2019-08-13 14:20:01,801] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(40)
[2019-08-13 14:20:01,949] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 205
[2019-08-13 14:20:01,949] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 205
[2019-08-13 14:20:01,950] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":41,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":5,"character":11}}}
[2019-08-13 14:20:01,950] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":41,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":5,"character":11}}}
[2019-08-13 14:20:01,953] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 11).
[2019-08-13 14:20:01,953] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 11).
[2019-08-13 14:20:01,953] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:01,953] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:01,954] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:01,954] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:01,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:01,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:01,999] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":41}}
[2019-08-13 14:20:01,999] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":41}}
[2019-08-13 14:20:02,001] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(41)
[2019-08-13 14:20:02,001] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(41)
[2019-08-13 14:20:05,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 206
[2019-08-13 14:20:05,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 206
[2019-08-13 14:20:05,147] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":42,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":16,"character":10}}}
[2019-08-13 14:20:05,147] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":42,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":16,"character":10}}}
[2019-08-13 14:20:05,149] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 10).
[2019-08-13 14:20:05,149] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 10).
[2019-08-13 14:20:05,150] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:05,150] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:05,150] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:05,150] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:05,296] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:05,296] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:05,297] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":42}}
[2019-08-13 14:20:05,297] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":42}}
[2019-08-13 14:20:05,300] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(42)
[2019-08-13 14:20:05,300] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(42)
[2019-08-13 14:20:05,447] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 206
[2019-08-13 14:20:05,447] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 206
[2019-08-13 14:20:05,448] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":43,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":16,"character":10}}}
[2019-08-13 14:20:05,448] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":43,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":16,"character":10}}}
[2019-08-13 14:20:05,449] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 10).
[2019-08-13 14:20:05,449] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 10).
[2019-08-13 14:20:05,451] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:05,451] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:05,451] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:05,451] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:05,760] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:05,760] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:05,762] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":43}}
[2019-08-13 14:20:05,762] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":43}}
[2019-08-13 14:20:05,765] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(43)
[2019-08-13 14:20:05,765] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(43)
[2019-08-13 14:20:10,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 241
[2019-08-13 14:20:10,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 241
[2019-08-13 14:20:10,918] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":2},"contentChanges":[{"text":"package org.spark.stream"}]}}
[2019-08-13 14:20:10,918] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":2},"contentChanges":[{"text":"package org.spark.stream"}]}}
[2019-08-13 14:20:10,922] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:10,922] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:11,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:11,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:11,060] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":44,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:11,060] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":44,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:11,062] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":44}
[2019-08-13 14:20:11,062] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":44}
[2019-08-13 14:20:11,063] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":44}
[2019-08-13 14:20:11,063] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":44}
[2019-08-13 14:20:22,684] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 214
[2019-08-13 14:20:22,684] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 214
[2019-08-13 14:20:22,685] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":45,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":0,"character":5}}}
[2019-08-13 14:20:22,685] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":45,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":0,"character":5}}}
[2019-08-13 14:20:22,687] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (0, 5).
[2019-08-13 14:20:22,687] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (0, 5).
[2019-08-13 14:20:22,687] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:22,687] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:22,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:22,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:22,736] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:22,736] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:22,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":45}}
[2019-08-13 14:20:22,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":45}}
[2019-08-13 14:20:22,740] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(45)
[2019-08-13 14:20:22,740] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(45)
[2019-08-13 14:20:26,038] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 243
[2019-08-13 14:20:26,038] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 243
[2019-08-13 14:20:26,038] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":3},"contentChanges":[{"text":"package org.spark.stream\n"}]}}
[2019-08-13 14:20:26,038] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":3},"contentChanges":[{"text":"package org.spark.stream\n"}]}}
[2019-08-13 14:20:26,039] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:26,039] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:26,181] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:26,181] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:26,181] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":46,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:26,181] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":46,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:26,182] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":46}
[2019-08-13 14:20:26,182] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":46}
[2019-08-13 14:20:26,182] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":46}
[2019-08-13 14:20:26,182] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":46}
[2019-08-13 14:20:26,543] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 245
[2019-08-13 14:20:26,543] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 245
[2019-08-13 14:20:26,544] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":4},"contentChanges":[{"text":"package org.spark.stream\n\n"}]}}
[2019-08-13 14:20:26,544] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":4},"contentChanges":[{"text":"package org.spark.stream\n\n"}]}}
[2019-08-13 14:20:26,544] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:26,544] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:26,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:26,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:26,692] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":47,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:26,692] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":47,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:26,693] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":47}
[2019-08-13 14:20:26,693] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":47}
[2019-08-13 14:20:26,693] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":47}
[2019-08-13 14:20:26,693] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":47}
[2019-08-13 14:20:27,208] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2622
[2019-08-13 14:20:27,208] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2622
[2019-08-13 14:20:27,209] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":5},"contentChanges":[{"text":"package org.spark.stream\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:20:27,209] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":5},"contentChanges":[{"text":"package org.spark.stream\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:20:27,210] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:27,210] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:27,359] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:27,359] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:27,360] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":48,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:27,360] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":48,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:27,362] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":48}
[2019-08-13 14:20:27,362] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":48}
[2019-08-13 14:20:27,363] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":48}
[2019-08-13 14:20:27,363] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":48}
[2019-08-13 14:20:50,698] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:20:50,698] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:20:50,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":49,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":5,"character":20}}}
[2019-08-13 14:20:50,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":49,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":5,"character":20}}}
[2019-08-13 14:20:50,700] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 20).
[2019-08-13 14:20:50,700] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 20).
[2019-08-13 14:20:50,701] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:50,701] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:50,701] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:50,701] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:50,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:50,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:50,750] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":49}}
[2019-08-13 14:20:50,750] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":49}}
[2019-08-13 14:20:50,752] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(49)
[2019-08-13 14:20:50,752] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(49)
[2019-08-13 14:20:54,937] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2626
[2019-08-13 14:20:54,937] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2626
[2019-08-13 14:20:54,938] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":7},"contentChanges":[{"text":"package org.spark.stream\n\n\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:20:54,938] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":7},"contentChanges":[{"text":"package org.spark.stream\n\n\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:20:54,941] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:54,941] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:55,055] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:55,055] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:55,056] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":50,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:55,056] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":50,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:55,058] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":50}
[2019-08-13 14:20:55,058] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":50}
[2019-08-13 14:20:55,058] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":50}
[2019-08-13 14:20:55,058] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":50}
[2019-08-13 14:20:55,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2802
[2019-08-13 14:20:55,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2802
[2019-08-13 14:20:55,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":8},"contentChanges":[{"text":"package org.spark.stream\n\nimport com.datapyro.kafka.util.ConfigUtil\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:20:55,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":8},"contentChanges":[{"text":"package org.spark.stream\n\nimport com.datapyro.kafka.util.ConfigUtil\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:20:55,815] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:55,815] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:20:55,951] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:55,951] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:20:55,952] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":51,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:55,952] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":51,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:20:55,954] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":51}
[2019-08-13 14:20:55,954] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":51}
[2019-08-13 14:20:55,954] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":51}
[2019-08-13 14:20:55,954] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":51}
[2019-08-13 14:20:57,897] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:20:57,897] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:20:57,898] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":52,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":34}}}
[2019-08-13 14:20:57,898] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":52,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":34}}}
[2019-08-13 14:20:57,899] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 34).
[2019-08-13 14:20:57,899] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 34).
[2019-08-13 14:20:57,900] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:57,900] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:20:57,900] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:57,900] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:20:58,043] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:58,043] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:20:58,044] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":52}}
[2019-08-13 14:20:58,044] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":52}}
[2019-08-13 14:20:58,046] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(52)
[2019-08-13 14:20:58,046] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(52)
[2019-08-13 14:23:01,242] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:23:01,242] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:23:01,242] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":53,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":2,"character":40}}}
[2019-08-13 14:23:01,242] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":53,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":2,"character":40}}}
[2019-08-13 14:23:01,243] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (2, 40).
[2019-08-13 14:23:01,243] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (2, 40).
[2019-08-13 14:23:01,245] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:23:01,245] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:23:01,245] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:23:01,245] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:23:01,335] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:23:01,335] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:23:01,335] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":53}}
[2019-08-13 14:23:01,335] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":53}}
[2019-08-13 14:23:01,337] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(53)
[2019-08-13 14:23:01,337] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(53)
[2019-08-13 14:23:04,387] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:23:04,387] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:23:04,388] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":54,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":5,"character":18}}}
[2019-08-13 14:23:04,388] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":54,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":5,"character":18}}}
[2019-08-13 14:23:04,389] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 18).
[2019-08-13 14:23:04,389] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 18).
[2019-08-13 14:23:04,390] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:23:04,390] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:23:04,390] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:23:04,390] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:23:08,930] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:23:08,930] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:23:08,930] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":54}}
[2019-08-13 14:23:08,930] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":54}}
[2019-08-13 14:23:08,932] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(54)
[2019-08-13 14:23:08,932] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(54)
[2019-08-13 14:23:09,131] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2761
[2019-08-13 14:23:09,131] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2761
[2019-08-13 14:23:09,132] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":9},"contentChanges":[{"text":"package org.spark.stream\n\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:23:09,132] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":9},"contentChanges":[{"text":"package org.spark.stream\n\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:23:09,136] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:23:09,136] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:23:09,278] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:23:09,278] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:23:09,279] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":55,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:23:09,279] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":55,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:23:09,281] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":55}
[2019-08-13 14:23:09,281] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":55}
[2019-08-13 14:23:09,282] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":55}
[2019-08-13 14:23:09,282] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":55}
[2019-08-13 14:23:10,490] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2760
[2019-08-13 14:23:10,490] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2760
[2019-08-13 14:23:10,491] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":10},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:23:10,491] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":10},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra Example\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:23:10,494] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:23:10,494] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:23:10,637] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:23:10,637] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:23:10,638] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":56,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:23:10,638] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":56,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:23:10,641] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":56}
[2019-08-13 14:23:10,641] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":56}
[2019-08-13 14:23:10,641] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":56}
[2019-08-13 14:23:10,641] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":56}
[2019-08-13 14:23:13,068] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:23:13,068] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:23:13,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":57,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":46}}}
[2019-08-13 14:23:13,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":57,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":46}}}
[2019-08-13 14:23:13,070] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 46).
[2019-08-13 14:23:13,070] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 46).
[2019-08-13 14:23:13,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:23:13,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:23:13,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:23:13,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:23:13,117] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:23:13,117] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:23:13,117] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":57}}
[2019-08-13 14:23:13,117] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":57}}
[2019-08-13 14:23:13,119] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(57)
[2019-08-13 14:23:13,119] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(57)
[2019-08-13 14:24:06,897] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:24:06,897] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:24:06,897] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":58,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":19}}}
[2019-08-13 14:24:06,897] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":58,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":19}}}
[2019-08-13 14:24:06,899] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 19).
[2019-08-13 14:24:06,899] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 19).
[2019-08-13 14:24:06,899] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:24:06,899] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:24:06,899] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:24:06,899] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:24:06,965] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:24:06,965] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:24:06,966] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":58}}
[2019-08-13 14:24:06,966] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":58}}
[2019-08-13 14:24:06,967] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(58)
[2019-08-13 14:24:06,967] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(58)
[2019-08-13 14:24:07,313] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:24:07,313] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:24:07,314] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":59,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":17}}}
[2019-08-13 14:24:07,314] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":59,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":17}}}
[2019-08-13 14:24:07,315] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 17).
[2019-08-13 14:24:07,315] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 17).
[2019-08-13 14:24:07,316] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:24:07,316] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:24:07,316] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:24:07,316] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:24:07,471] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:24:07,471] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:24:07,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":59}}
[2019-08-13 14:24:07,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":59}}
[2019-08-13 14:24:07,474] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(59)
[2019-08-13 14:24:07,474] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(59)
[2019-08-13 14:24:37,139] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2753
[2019-08-13 14:24:37,139] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2753
[2019-08-13 14:24:37,139] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":11},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra \n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:37,139] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":11},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra \n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:37,143] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:37,143] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:37,286] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:37,286] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:37,287] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":60,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:37,287] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":60,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:37,290] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":60}
[2019-08-13 14:24:37,290] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":60}
[2019-08-13 14:24:37,290] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":60}
[2019-08-13 14:24:37,290] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":60}
[2019-08-13 14:24:37,651] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2752
[2019-08-13 14:24:37,651] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2752
[2019-08-13 14:24:37,652] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":12},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:37,652] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":12},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:37,655] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:37,655] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:37,798] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:37,798] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:37,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":61,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:37,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":61,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:37,801] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":61}
[2019-08-13 14:24:37,801] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":61}
[2019-08-13 14:24:37,801] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":61}
[2019-08-13 14:24:37,801] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":61}
[2019-08-13 14:24:44,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2753
[2019-08-13 14:24:44,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2753
[2019-08-13 14:24:44,523] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":13},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:44,523] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":13},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:44,526] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:44,526] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:44,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2754
[2019-08-13 14:24:44,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2754
[2019-08-13 14:24:44,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":14},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KACassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:44,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":14},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KACassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:44,747] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:44,747] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:44,870] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:44,870] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:44,870] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":62,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:44,870] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":62,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:44,871] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":62}
[2019-08-13 14:24:44,871] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":62}
[2019-08-13 14:24:44,872] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":62}
[2019-08-13 14:24:44,872] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":62}
[2019-08-13 14:24:45,810] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2753
[2019-08-13 14:24:45,810] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2753
[2019-08-13 14:24:45,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":15},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:45,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":15},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:45,813] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:45,813] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:46,103] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2754
[2019-08-13 14:24:46,103] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2754
[2019-08-13 14:24:46,104] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":16},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KaCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:46,104] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":16},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KaCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:46,106] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:46,106] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:46,378] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2755
[2019-08-13 14:24:46,378] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2755
[2019-08-13 14:24:46,379] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":17},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KafCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:46,379] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":17},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KafCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:46,382] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:46,382] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:46,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:46,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:46,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":63,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:46,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":63,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:46,505] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":63}
[2019-08-13 14:24:46,505] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":63}
[2019-08-13 14:24:46,506] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":63}
[2019-08-13 14:24:46,506] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":63}
[2019-08-13 14:24:46,965] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2757
[2019-08-13 14:24:46,965] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2757
[2019-08-13 14:24:46,966] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":19},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KafkaCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:46,966] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":19},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming KafkaCassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:46,969] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:46,969] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:47,088] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:47,088] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:47,089] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":64,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:47,089] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":64,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:47,091] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":64}
[2019-08-13 14:24:47,091] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":64}
[2019-08-13 14:24:47,091] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":64}
[2019-08-13 14:24:47,091] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":64}
[2019-08-13 14:24:47,458] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2758
[2019-08-13 14:24:47,458] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2758
[2019-08-13 14:24:47,458] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:47,458] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:24:47,461] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:47,461] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:24:47,584] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:47,584] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:24:47,585] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":65,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:47,585] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":65,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:24:47,587] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":65}
[2019-08-13 14:24:47,587] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":65}
[2019-08-13 14:24:47,587] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":65}
[2019-08-13 14:24:47,587] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":65}
[2019-08-13 14:24:58,835] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:24:58,835] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:24:58,836] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":66,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":33,"character":49}}}
[2019-08-13 14:24:58,836] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":66,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":33,"character":49}}}
[2019-08-13 14:24:58,837] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (33, 49).
[2019-08-13 14:24:58,837] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (33, 49).
[2019-08-13 14:24:58,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:24:58,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:24:58,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:24:58,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:00,487] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:00,487] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:00,488] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":66}}
[2019-08-13 14:25:00,488] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":66}}
[2019-08-13 14:25:00,489] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(66)
[2019-08-13 14:25:00,489] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(66)
[2019-08-13 14:25:04,447] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:04,447] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:04,448] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":67,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":31}}}
[2019-08-13 14:25:04,448] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":67,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":31}}}
[2019-08-13 14:25:04,449] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 31).
[2019-08-13 14:25:04,449] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 31).
[2019-08-13 14:25:04,450] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:04,450] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:04,450] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:04,450] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:04,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:04,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:04,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":67}}
[2019-08-13 14:25:04,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":67}}
[2019-08-13 14:25:04,528] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(67)
[2019-08-13 14:25:04,528] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(67)
[2019-08-13 14:25:05,403] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:05,403] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:05,404] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":68,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":35}}}
[2019-08-13 14:25:05,404] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":68,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":35}}}
[2019-08-13 14:25:05,405] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 35).
[2019-08-13 14:25:05,405] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 35).
[2019-08-13 14:25:05,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:05,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:05,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:05,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:05,453] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:05,453] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:05,454] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":68}}
[2019-08-13 14:25:05,454] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":68}}
[2019-08-13 14:25:05,456] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(68)
[2019-08-13 14:25:05,456] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(68)
[2019-08-13 14:25:05,906] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:05,906] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:05,906] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":69,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":21,"character":11}}}
[2019-08-13 14:25:05,906] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":69,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":21,"character":11}}}
[2019-08-13 14:25:05,908] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (21, 11).
[2019-08-13 14:25:05,908] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (21, 11).
[2019-08-13 14:25:05,909] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:05,909] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:05,909] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:05,909] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:05,989] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:05,989] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:05,989] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":69}}
[2019-08-13 14:25:05,989] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":69}}
[2019-08-13 14:25:05,991] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(69)
[2019-08-13 14:25:05,991] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(69)
[2019-08-13 14:25:09,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:09,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:09,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":70,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":35}}}
[2019-08-13 14:25:09,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":70,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":35}}}
[2019-08-13 14:25:09,376] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 35).
[2019-08-13 14:25:09,376] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 35).
[2019-08-13 14:25:09,377] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:09,377] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:09,377] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:09,377] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:09,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:09,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:09,794] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":70}}
[2019-08-13 14:25:09,794] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":70}}
[2019-08-13 14:25:09,796] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(70)
[2019-08-13 14:25:09,796] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(70)
[2019-08-13 14:25:11,151] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:11,151] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:11,152] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":71,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":16,"character":21}}}
[2019-08-13 14:25:11,152] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":71,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":16,"character":21}}}
[2019-08-13 14:25:11,153] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 21).
[2019-08-13 14:25:11,153] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 21).
[2019-08-13 14:25:11,154] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:11,154] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:11,155] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:11,155] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:11,199] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:11,199] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:11,199] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":71}}
[2019-08-13 14:25:11,199] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":71}}
[2019-08-13 14:25:11,201] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(71)
[2019-08-13 14:25:11,201] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(71)
[2019-08-13 14:25:11,449] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:11,449] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:11,450] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":72,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":38}}}
[2019-08-13 14:25:11,450] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":72,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":38}}}
[2019-08-13 14:25:11,451] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 38).
[2019-08-13 14:25:11,451] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 38).
[2019-08-13 14:25:11,452] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:11,452] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:11,452] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:11,452] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:11,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:11,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:11,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":72}}
[2019-08-13 14:25:11,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":72}}
[2019-08-13 14:25:11,600] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(72)
[2019-08-13 14:25:11,600] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(72)
[2019-08-13 14:25:14,017] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,017] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,018] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":73,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":34}}}
[2019-08-13 14:25:14,018] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":73,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":34}}}
[2019-08-13 14:25:14,019] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 34).
[2019-08-13 14:25:14,019] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 34).
[2019-08-13 14:25:14,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:14,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:14,067] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:14,067] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:14,068] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":73}}
[2019-08-13 14:25:14,068] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":73}}
[2019-08-13 14:25:14,069] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(73)
[2019-08-13 14:25:14,069] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(73)
[2019-08-13 14:25:14,218] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,218] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,219] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":74,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":34}}}
[2019-08-13 14:25:14,219] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":74,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":34}}}
[2019-08-13 14:25:14,220] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 34).
[2019-08-13 14:25:14,220] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 34).
[2019-08-13 14:25:14,221] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,221] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:14,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:14,267] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:14,267] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:14,268] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":74}}
[2019-08-13 14:25:14,268] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":74}}
[2019-08-13 14:25:14,269] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(74)
[2019-08-13 14:25:14,269] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(74)
[2019-08-13 14:25:14,519] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,519] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,519] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":75,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":35}}}
[2019-08-13 14:25:14,519] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":75,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":35}}}
[2019-08-13 14:25:14,520] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 35).
[2019-08-13 14:25:14,520] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 35).
[2019-08-13 14:25:14,521] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,521] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,521] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:14,521] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:14,569] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:14,569] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:14,570] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":75}}
[2019-08-13 14:25:14,570] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":75}}
[2019-08-13 14:25:14,572] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(75)
[2019-08-13 14:25:14,572] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(75)
[2019-08-13 14:25:14,719] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,719] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:14,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":76,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":35}}}
[2019-08-13 14:25:14,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":76,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":35}}}
[2019-08-13 14:25:14,722] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 35).
[2019-08-13 14:25:14,722] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 35).
[2019-08-13 14:25:14,723] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,723] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:14,723] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:14,723] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:15,150] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:15,150] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:15,150] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":76}}
[2019-08-13 14:25:15,150] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":76}}
[2019-08-13 14:25:15,152] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(76)
[2019-08-13 14:25:15,152] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(76)
[2019-08-13 14:25:15,403] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:15,403] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:15,403] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":77,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":34}}}
[2019-08-13 14:25:15,403] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":77,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":34}}}
[2019-08-13 14:25:15,404] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 34).
[2019-08-13 14:25:15,404] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 34).
[2019-08-13 14:25:15,405] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:15,405] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:15,405] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:15,405] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:16,896] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:16,896] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:16,897] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":77}}
[2019-08-13 14:25:16,897] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":77}}
[2019-08-13 14:25:16,898] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(77)
[2019-08-13 14:25:16,898] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(77)
[2019-08-13 14:25:21,881] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:21,881] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:21,882] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":78,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":56}}}
[2019-08-13 14:25:21,882] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":78,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":56}}}
[2019-08-13 14:25:21,883] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 56).
[2019-08-13 14:25:21,883] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 56).
[2019-08-13 14:25:21,884] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:21,884] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:21,884] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:21,884] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:23,291] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:23,291] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:23,291] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":78}}
[2019-08-13 14:25:23,291] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":78}}
[2019-08-13 14:25:23,292] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(78)
[2019-08-13 14:25:23,292] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(78)
[2019-08-13 14:25:25,451] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:25,451] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:25:25,451] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":79,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":55}}}
[2019-08-13 14:25:25,451] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":79,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":55}}}
[2019-08-13 14:25:25,452] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 55).
[2019-08-13 14:25:25,452] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 55).
[2019-08-13 14:25:25,454] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:25,454] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:25:25,454] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:25,454] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:25:26,563] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:26,563] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:25:26,564] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":79}}
[2019-08-13 14:25:26,564] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":79}}
[2019-08-13 14:25:26,566] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(79)
[2019-08-13 14:25:26,566] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(79)
[2019-08-13 14:25:34,153] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 163
[2019-08-13 14:25:34,153] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 163
[2019-08-13 14:25:34,153] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:25:34,153] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 14:25:34,154] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala from Ensime.
[2019-08-13 14:25:34,154] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala from Ensime.
[2019-08-13 14:25:34,163] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:25:34,163] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:25:34,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:25:34,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:25:34,163] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 184
[2019-08-13 14:25:34,163] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 184
[2019-08-13 14:25:34,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":80,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:25:34,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":80,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:25:34,164] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":80}
[2019-08-13 14:25:34,164] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":80}
[2019-08-13 14:25:34,164] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":80}
[2019-08-13 14:25:34,164] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":80}
[2019-08-13 14:25:54,014] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2758
[2019-08-13 14:25:54,014] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2758
[2019-08-13 14:25:54,014] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:25:54,014] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:25:54,016] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:25:54,016] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:26:01,527] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 14:26:01,527] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 14:26:01,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:26:01,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:26:01,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 14:26:01,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 14:26:01,536] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1015
[2019-08-13 14:26:01,536] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1015
[2019-08-13 14:26:01,536] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport kafka.serializer.DefaultDecoder\nimport org.apache.spark.streaming.StreamingContext\nimport org.apache.spark.streaming.dstream.DStream\nimport org.apache.spark.streaming.kafka.KafkaUtils\n\nclass KafkaDStreamSource(config: Map[String, String]) {\n\n  def createSource(ssc: StreamingContext, topic: String): DStream[KafkaPayload] = {\n    val kafkaParams = config\n    val kafkaTopics = Set(topic)\n\n    KafkaUtils.\n      createDirectStream[Array[Byte], Array[Byte], DefaultDecoder, DefaultDecoder](\n      ssc,\n      kafkaParams,\n      kafkaTopics).\n      map(dstream => KafkaPayload(Option(dstream._1), dstream._2))\n  }\n\n}\n\nobject KafkaDStreamSource {\n  def apply(config: Map[String, String]): KafkaDStreamSource = new KafkaDStreamSource(config)\n}\n"}}}
[2019-08-13 14:26:01,536] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport kafka.serializer.DefaultDecoder\nimport org.apache.spark.streaming.StreamingContext\nimport org.apache.spark.streaming.dstream.DStream\nimport org.apache.spark.streaming.kafka.KafkaUtils\n\nclass KafkaDStreamSource(config: Map[String, String]) {\n\n  def createSource(ssc: StreamingContext, topic: String): DStream[KafkaPayload] = {\n    val kafkaParams = config\n    val kafkaTopics = Set(topic)\n\n    KafkaUtils.\n      createDirectStream[Array[Byte], Array[Byte], DefaultDecoder, DefaultDecoder](\n      ssc,\n      kafkaParams,\n      kafkaTopics).\n      map(dstream => KafkaPayload(Option(dstream._1), dstream._2))\n  }\n\n}\n\nobject KafkaDStreamSource {\n  def apply(config: Map[String, String]): KafkaDStreamSource = new KafkaDStreamSource(config)\n}\n"}}}
[2019-08-13 14:26:01,537] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 186
[2019-08-13 14:26:01,537] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 186
[2019-08-13 14:26:01,537] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":81,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala"}}}
[2019-08-13 14:26:01,537] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":81,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala"}}}
[2019-08-13 14:26:01,538] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":81}
[2019-08-13 14:26:01,538] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":81}
[2019-08-13 14:26:01,538] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":81}
[2019-08-13 14:26:01,538] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":81}
[2019-08-13 14:26:12,080] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 172
[2019-08-13 14:26:12,080] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 172
[2019-08-13 14:26:12,081] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala"}}}
[2019-08-13 14:26:12,081] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala"}}}
[2019-08-13 14:26:12,081] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala from Ensime.
[2019-08-13 14:26:12,081] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/KafkaDStreamSource.scala from Ensime.
[2019-08-13 14:26:12,097] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:26:12,097] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:26:12,097] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:26:12,097] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:26:12,098] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 184
[2019-08-13 14:26:12,098] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 184
[2019-08-13 14:26:12,098] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":82,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:26:12,098] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":82,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:26:12,099] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":82}
[2019-08-13 14:26:12,099] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":82}
[2019-08-13 14:26:12,099] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":82}
[2019-08-13 14:26:12,099] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":82}
[2019-08-13 14:26:14,051] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 14:26:14,051] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 14:26:14,052] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:26:14,052] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:26:14,052] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 14:26:14,052] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 14:26:14,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:26:14,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:26:14,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:26:14,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:26:14,074] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:26:14,074] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 193
[2019-08-13 14:26:14,074] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":83,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:26:14,074] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":83,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:26:14,074] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":83}
[2019-08-13 14:26:14,074] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":83}
[2019-08-13 14:26:14,074] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":83}
[2019-08-13 14:26:14,074] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":83}
[2019-08-13 14:26:20,323] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:26:20,323] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:26:20,323] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":84,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":23,"character":15}}}
[2019-08-13 14:26:20,323] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":84,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"},"position":{"line":23,"character":15}}}
[2019-08-13 14:26:20,324] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (23, 15).
[2019-08-13 14:26:20,324] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (23, 15).
[2019-08-13 14:26:20,324] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:26:20,324] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:26:20,324] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:26:20,324] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:26:21,124] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:26:21,124] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:26:21,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":84}}
[2019-08-13 14:26:21,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":84}}
[2019-08-13 14:26:21,126] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(84)
[2019-08-13 14:26:21,126] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(84)
[2019-08-13 14:26:32,114] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2758
[2019-08-13 14:26:32,114] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2758
[2019-08-13 14:26:32,115] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:26:32,115] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master(config.getProperty(\"spark.master\"))\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:26:32,116] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:26:32,116] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:26:41,476] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:26:41,476] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:26:41,477] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":85,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":14,"character":36}}}
[2019-08-13 14:26:41,477] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":85,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":14,"character":36}}}
[2019-08-13 14:26:41,478] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (14, 36).
[2019-08-13 14:26:41,478] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (14, 36).
[2019-08-13 14:26:41,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:26:41,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:26:41,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:26:41,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:26:41,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:26:41,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:26:41,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":85}}
[2019-08-13 14:26:41,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":85}}
[2019-08-13 14:26:41,773] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(85)
[2019-08-13 14:26:41,773] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(85)
[2019-08-13 14:26:47,442] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:26:47,442] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:26:47,442] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":86,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":11}}}
[2019-08-13 14:26:47,442] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":86,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":11}}}
[2019-08-13 14:26:47,443] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 11).
[2019-08-13 14:26:47,443] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 11).
[2019-08-13 14:26:47,444] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:26:47,444] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:26:47,444] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:26:47,444] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:26:47,653] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:26:47,653] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:26:47,654] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":86}}
[2019-08-13 14:26:47,654] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":86}}
[2019-08-13 14:26:47,656] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(86)
[2019-08-13 14:26:47,656] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(86)
[2019-08-13 14:27:02,237] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:27:02,237] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:27:02,238] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":87,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":16,"character":16}}}
[2019-08-13 14:27:02,238] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":87,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":16,"character":16}}}
[2019-08-13 14:27:02,239] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 16).
[2019-08-13 14:27:02,239] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 16).
[2019-08-13 14:27:02,241] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:02,241] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:02,241] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:02,241] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:02,365] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:02,365] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:02,366] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":87}}
[2019-08-13 14:27:02,366] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":87}}
[2019-08-13 14:27:02,367] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(87)
[2019-08-13 14:27:02,367] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(87)
[2019-08-13 14:27:02,717] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:27:02,717] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:27:02,717] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":88,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":16,"character":12}}}
[2019-08-13 14:27:02,717] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":88,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":16,"character":12}}}
[2019-08-13 14:27:02,718] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 12).
[2019-08-13 14:27:02,718] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (16, 12).
[2019-08-13 14:27:02,719] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:02,719] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:02,719] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:02,719] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:02,867] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:02,867] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:02,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":88}}
[2019-08-13 14:27:02,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":88}}
[2019-08-13 14:27:02,869] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(88)
[2019-08-13 14:27:02,869] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(88)
[2019-08-13 14:27:03,018] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:27:03,018] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:27:03,018] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":89,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":12}}}
[2019-08-13 14:27:03,018] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":89,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":12}}}
[2019-08-13 14:27:03,019] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 12).
[2019-08-13 14:27:03,019] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 12).
[2019-08-13 14:27:03,020] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:03,020] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:03,020] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:03,020] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:03,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:03,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:03,147] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":89}}
[2019-08-13 14:27:03,147] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":89}}
[2019-08-13 14:27:03,148] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(89)
[2019-08-13 14:27:03,148] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(89)
[2019-08-13 14:27:10,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2722
[2019-08-13 14:27:10,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2722
[2019-08-13 14:27:10,919] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":21},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master()\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:10,919] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":21},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .master()\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:10,922] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:10,922] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:11,032] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:11,032] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:11,032] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":90,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:11,032] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":90,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:11,034] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":90}
[2019-08-13 14:27:11,034] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":90}
[2019-08-13 14:27:11,035] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":90}
[2019-08-13 14:27:11,035] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":90}
[2019-08-13 14:27:28,034] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:27:28,034] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 215
[2019-08-13 14:27:28,035] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":91,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":3}}}
[2019-08-13 14:27:28,035] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":91,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":3}}}
[2019-08-13 14:27:28,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 3).
[2019-08-13 14:27:28,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 3).
[2019-08-13 14:27:28,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:28,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:27:28,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:28,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:27:28,389] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:28,389] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:27:28,390] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":91}}
[2019-08-13 14:27:28,390] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":91}}
[2019-08-13 14:27:28,392] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(91)
[2019-08-13 14:27:28,392] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(91)
[2019-08-13 14:27:30,350] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2713
[2019-08-13 14:27:30,350] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2713
[2019-08-13 14:27:30,350] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":22},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    \n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:30,350] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":22},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    \n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:30,354] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:30,354] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:30,496] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:30,496] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:30,497] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":92,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:30,497] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":92,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:30,499] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":92}
[2019-08-13 14:27:30,499] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":92}
[2019-08-13 14:27:30,499] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":92}
[2019-08-13 14:27:30,499] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":92}
[2019-08-13 14:27:30,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2709
[2019-08-13 14:27:30,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2709
[2019-08-13 14:27:30,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":23},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:30,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":23},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:30,775] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:30,775] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:30,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:30,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:30,921] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":93,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:30,921] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":93,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:30,922] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":93}
[2019-08-13 14:27:30,922] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":93}
[2019-08-13 14:27:30,922] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":93}
[2019-08-13 14:27:30,922] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":93}
[2019-08-13 14:27:31,279] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2707
[2019-08-13 14:27:31,279] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2707
[2019-08-13 14:27:31,279] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":24},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:31,279] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":24},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:27:31,281] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:31,281] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:27:31,377] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:31,377] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:27:31,378] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":94,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:31,378] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":94,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:27:31,379] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":94}
[2019-08-13 14:27:31,379] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":94}
[2019-08-13 14:27:31,380] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":94}
[2019-08-13 14:27:31,380] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":94}
[2019-08-13 14:28:01,756] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:28:01,756] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:28:01,756] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":95,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":14,"character":31}}}
[2019-08-13 14:28:01,756] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":95,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":14,"character":31}}}
[2019-08-13 14:28:01,757] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (14, 31).
[2019-08-13 14:28:01,757] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (14, 31).
[2019-08-13 14:28:01,757] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:01,757] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:01,758] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:01,758] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:01,803] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:28:01,803] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:28:01,803] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":95}}
[2019-08-13 14:28:01,803] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":95}}
[2019-08-13 14:28:01,805] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(95)
[2019-08-13 14:28:01,805] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(95)
[2019-08-13 14:28:03,914] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2713
[2019-08-13 14:28:03,914] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2713
[2019-08-13 14:28:03,915] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":25},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    \n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:03,915] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":25},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    \n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:03,918] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:03,918] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:04,022] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:04,022] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:04,022] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":96,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:04,022] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":96,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:04,024] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":96}
[2019-08-13 14:28:04,024] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":96}
[2019-08-13 14:28:04,024] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":96}
[2019-08-13 14:28:04,024] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":96}
[2019-08-13 14:28:05,018] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2969
[2019-08-13 14:28:05,018] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2969
[2019-08-13 14:28:05,018] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":26},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\\\n            .config('spark.driver.memory', '10G')\\\n            .config('spark.driver.maxResultSize', '10G')\\\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:05,018] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":26},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\\\n            .config('spark.driver.memory', '10G')\\\n            .config('spark.driver.maxResultSize', '10G')\\\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:05,021] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:05,021] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:05,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:05,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:05,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":97,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:05,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":97,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:05,164] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":97}
[2019-08-13 14:28:05,164] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":97}
[2019-08-13 14:28:05,164] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":97}
[2019-08-13 14:28:05,164] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":97}
[2019-08-13 14:28:06,935] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2967
[2019-08-13 14:28:06,935] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2967
[2019-08-13 14:28:06,936] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":27},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\\\n            .config('spark.driver.memory', '10G')\\\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:06,936] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":27},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\\\n            .config('spark.driver.memory', '10G')\\\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:06,938] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:06,938] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:07,056] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:07,056] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:07,056] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":98,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:07,056] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":98,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:07,058] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":98}
[2019-08-13 14:28:07,058] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":98}
[2019-08-13 14:28:07,058] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":98}
[2019-08-13 14:28:07,058] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":98}
[2019-08-13 14:28:09,589] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2965
[2019-08-13 14:28:09,589] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2965
[2019-08-13 14:28:09,590] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":28},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\\\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:09,590] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":28},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\\\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:09,593] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:09,593] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:09,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:09,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 14:28:09,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":99,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:09,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":99,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:09,739] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":99}
[2019-08-13 14:28:09,739] DEBUG langserver.core.MessageWriter - Content-Length: 37



{"jsonrpc":"2.0","result":[],"id":99}
[2019-08-13 14:28:09,739] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":99}
[2019-08-13 14:28:09,739] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":99}
[2019-08-13 14:28:12,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2963
[2019-08-13 14:28:12,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2963
[2019-08-13 14:28:12,502] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":29},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:12,502] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":29},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \\\n            .config('spark.executor.memory', '10G')\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:12,504] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:12,504] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:12,648] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:12,648] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:12,649] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":100,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:12,649] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":100,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:12,651] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":100}
[2019-08-13 14:28:12,651] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":100}
[2019-08-13 14:28:12,651] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":100}
[2019-08-13 14:28:12,651] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":100}
[2019-08-13 14:28:16,021] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2961
[2019-08-13 14:28:16,021] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2961
[2019-08-13 14:28:16,022] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":30},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \n            .config('spark.executor.memory', '10G')\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:16,022] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":30},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\") \n            .config('spark.executor.memory', '10G')\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:16,024] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:16,024] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:16,169] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:16,169] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:16,169] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":101,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:16,169] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":101,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:16,171] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":101}
[2019-08-13 14:28:16,171] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":101}
[2019-08-13 14:28:16,171] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":101}
[2019-08-13 14:28:16,171] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":101}
[2019-08-13 14:28:16,829] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2960
[2019-08-13 14:28:16,829] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2960
[2019-08-13 14:28:16,830] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":31},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n            .config('spark.executor.memory', '10G')\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:16,830] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":31},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n            .config('spark.executor.memory', '10G')\n            .config('spark.driver.memory', '10G')\n            .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:16,832] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:16,832] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:16,976] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:16,976] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:16,977] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":102,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:16,977] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":102,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:16,979] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":102}
[2019-08-13 14:28:16,979] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":102}
[2019-08-13 14:28:16,979] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":102}
[2019-08-13 14:28:16,979] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":102}
[2019-08-13 14:28:23,668] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:23,668] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:23,669] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":103,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":16}}}
[2019-08-13 14:28:23,669] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":103,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":15,"character":16}}}
[2019-08-13 14:28:23,670] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 16).
[2019-08-13 14:28:23,670] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (15, 16).
[2019-08-13 14:28:23,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:23,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:23,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:23,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:23,717] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:23,717] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:23,718] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":103}}
[2019-08-13 14:28:23,718] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":103}}
[2019-08-13 14:28:23,719] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(103)
[2019-08-13 14:28:23,719] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(103)
[2019-08-13 14:28:23,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:23,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:23,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":104,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":17,"character":12}}}
[2019-08-13 14:28:23,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":104,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":17,"character":12}}}
[2019-08-13 14:28:23,870] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (17, 12).
[2019-08-13 14:28:23,870] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (17, 12).
[2019-08-13 14:28:23,870] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:23,870] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:23,871] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:23,871] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:24,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:24,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:24,123] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":104}}
[2019-08-13 14:28:24,123] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":104}}
[2019-08-13 14:28:24,125] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(104)
[2019-08-13 14:28:24,125] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(104)
[2019-08-13 14:28:25,980] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:28:25,980] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:28:25,980] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":32},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n        .config('spark.executor.memory', '10G')\n        .config('spark.driver.memory', '10G')\n        .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:25,980] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":32},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n        .config('spark.executor.memory', '10G')\n        .config('spark.driver.memory', '10G')\n        .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:25,983] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:25,983] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:26,126] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:26,126] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:26,126] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":105,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:26,126] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":105,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:26,128] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":105}
[2019-08-13 14:28:26,128] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":105}
[2019-08-13 14:28:26,128] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":105}
[2019-08-13 14:28:26,128] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":105}
[2019-08-13 14:28:26,386] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2936
[2019-08-13 14:28:26,386] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2936
[2019-08-13 14:28:26,387] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":33},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config('spark.executor.memory', '10G')\n    .config('spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:26,387] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":33},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config('spark.executor.memory', '10G')\n    .config('spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:26,389] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:26,389] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:26,530] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:26,530] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:26,530] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":106,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:26,530] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":106,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:26,532] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":106}
[2019-08-13 14:28:26,532] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":106}
[2019-08-13 14:28:26,532] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":106}
[2019-08-13 14:28:26,532] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":106}
[2019-08-13 14:28:29,578] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:29,578] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:29,578] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":107,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":17,"character":12}}}
[2019-08-13 14:28:29,578] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":107,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":17,"character":12}}}
[2019-08-13 14:28:29,579] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (17, 12).
[2019-08-13 14:28:29,579] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (17, 12).
[2019-08-13 14:28:29,580] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:29,580] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:29,580] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:29,580] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:29,631] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:29,631] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:29,631] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":107}}
[2019-08-13 14:28:29,631] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":107}}
[2019-08-13 14:28:29,633] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(107)
[2019-08-13 14:28:29,633] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(107)
[2019-08-13 14:28:30,247] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:30,247] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:28:30,248] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":108,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":23}}}
[2019-08-13 14:28:30,248] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":108,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":23}}}
[2019-08-13 14:28:30,249] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 23).
[2019-08-13 14:28:30,249] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 23).
[2019-08-13 14:28:30,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:30,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:28:30,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:30,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:28:31,042] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:31,042] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:28:31,043] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":108}}
[2019-08-13 14:28:31,043] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":108}}
[2019-08-13 14:28:31,044] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(108)
[2019-08-13 14:28:31,044] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(108)
[2019-08-13 14:28:31,245] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2935
[2019-08-13 14:28:31,245] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2935
[2019-08-13 14:28:31,246] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":34},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(spark.executor.memory', '10G')\n    .config('spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:31,246] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":34},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(spark.executor.memory', '10G')\n    .config('spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:31,249] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:31,249] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:31,392] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:31,392] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:31,392] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":109,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:31,392] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":109,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:31,394] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":109}
[2019-08-13 14:28:31,394] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":109}
[2019-08-13 14:28:31,394] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":109}
[2019-08-13 14:28:31,394] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":109}
[2019-08-13 14:28:32,185] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2937
[2019-08-13 14:28:32,185] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2937
[2019-08-13 14:28:32,186] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":35},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config('spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:32,186] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":35},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config('spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:32,188] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:32,188] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:32,307] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:32,307] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:32,307] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":110,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:32,307] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":110,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:32,309] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":110}
[2019-08-13 14:28:32,309] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":110}
[2019-08-13 14:28:32,309] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":110}
[2019-08-13 14:28:32,309] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":110}
[2019-08-13 14:28:33,983] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2936
[2019-08-13 14:28:33,983] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2936
[2019-08-13 14:28:33,983] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":36},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:33,983] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":36},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:33,986] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:33,986] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:34,128] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:34,128] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:34,129] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":111,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:34,129] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":111,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:34,131] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":111}
[2019-08-13 14:28:34,131] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":111}
[2019-08-13 14:28:34,131] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":111}
[2019-08-13 14:28:34,131] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":111}
[2019-08-13 14:28:34,990] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2938
[2019-08-13 14:28:34,990] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2938
[2019-08-13 14:28:34,991] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":37},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:34,991] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":37},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config('spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:34,993] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:34,993] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:35,114] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:35,114] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:35,115] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":112,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:35,115] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":112,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:35,116] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":112}
[2019-08-13 14:28:35,116] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":112}
[2019-08-13 14:28:35,117] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":112}
[2019-08-13 14:28:35,117] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":112}
[2019-08-13 14:28:36,525] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2937
[2019-08-13 14:28:36,525] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2937
[2019-08-13 14:28:36,525] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":38},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:36,525] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":38},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:36,527] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:36,527] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:36,643] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:36,643] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:36,644] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":113,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:36,644] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":113,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:36,646] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":113}
[2019-08-13 14:28:36,646] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":113}
[2019-08-13 14:28:36,646] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":113}
[2019-08-13 14:28:36,646] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":113}
[2019-08-13 14:28:37,740] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2939
[2019-08-13 14:28:37,740] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2939
[2019-08-13 14:28:37,740] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":39},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(\"spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:37,740] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":39},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(\"spark.driver.maxResultSize', '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:37,742] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:37,742] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:37,858] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:37,858] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:37,858] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":114,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:37,858] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":114,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:37,859] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":114}
[2019-08-13 14:28:37,859] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":114}
[2019-08-13 14:28:37,859] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":114}
[2019-08-13 14:28:37,859] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":114}
[2019-08-13 14:28:40,842] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2938
[2019-08-13 14:28:40,842] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2938
[2019-08-13 14:28:40,843] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":40},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(\"spark.driver.maxResultSize, '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:40,843] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":40},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(\"spark.driver.maxResultSize, '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:40,844] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:40,844] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:41,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2940
[2019-08-13 14:28:41,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2940
[2019-08-13 14:28:41,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":41},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:41,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":41},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory', '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:41,182] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:41,182] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:41,311] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:41,311] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:41,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":115,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:41,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":115,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:41,314] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":115}
[2019-08-13 14:28:41,314] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":115}
[2019-08-13 14:28:41,314] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":115}
[2019-08-13 14:28:41,314] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":115}
[2019-08-13 14:28:43,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2939
[2019-08-13 14:28:43,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2939
[2019-08-13 14:28:43,486] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":42},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory, '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:43,486] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":42},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory, '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:43,488] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:43,488] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:43,633] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:43,633] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:43,634] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":116,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:43,634] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":116,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:43,636] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":116}
[2019-08-13 14:28:43,636] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":116}
[2019-08-13 14:28:43,636] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":116}
[2019-08-13 14:28:43,636] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":116}
[2019-08-13 14:28:43,884] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2941
[2019-08-13 14:28:43,884] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2941
[2019-08-13 14:28:43,885] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":43},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:43,885] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":43},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory', '10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:43,887] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:43,887] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:44,003] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:44,003] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:44,004] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":117,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:44,004] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":117,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:44,007] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":117}
[2019-08-13 14:28:44,007] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":117}
[2019-08-13 14:28:44,007] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":117}
[2019-08-13 14:28:44,007] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":117}
[2019-08-13 14:28:45,622] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2940
[2019-08-13 14:28:45,622] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2940
[2019-08-13 14:28:45,623] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":44},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory, '10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:45,623] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":44},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory, '10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:45,626] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:45,626] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:45,768] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:45,768] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:45,768] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":118,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:45,768] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":118,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:45,769] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":118}
[2019-08-13 14:28:45,769] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":118}
[2019-08-13 14:28:45,769] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":118}
[2019-08-13 14:28:45,769] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":118}
[2019-08-13 14:28:46,695] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2942
[2019-08-13 14:28:46,695] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2942
[2019-08-13 14:28:46,696] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":45},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", '10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:46,696] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":45},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", '10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:46,698] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:46,698] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:46,820] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:46,820] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:46,820] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":119,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:46,820] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":119,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:46,823] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":119}
[2019-08-13 14:28:46,823] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":119}
[2019-08-13 14:28:46,823] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":119}
[2019-08-13 14:28:46,823] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":119}
[2019-08-13 14:28:48,542] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2941
[2019-08-13 14:28:48,542] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2941
[2019-08-13 14:28:48,543] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":46},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", 10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:48,543] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":46},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", 10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:48,544] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:48,544] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:48,689] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:48,689] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:48,690] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":120,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:48,690] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":120,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:48,691] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":120}
[2019-08-13 14:28:48,691] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":120}
[2019-08-13 14:28:48,691] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":120}
[2019-08-13 14:28:48,691] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":120}
[2019-08-13 14:28:49,569] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2943
[2019-08-13 14:28:49,569] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2943
[2019-08-13 14:28:49,570] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":47},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:49,570] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":47},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G')\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:49,572] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:49,572] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:49,691] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:49,691] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:49,691] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":121,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:49,691] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":121,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:49,694] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":121}
[2019-08-13 14:28:49,694] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":121}
[2019-08-13 14:28:49,694] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":121}
[2019-08-13 14:28:49,694] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":121}
[2019-08-13 14:28:51,371] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2942
[2019-08-13 14:28:51,371] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2942
[2019-08-13 14:28:51,371] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":48},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G)\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:51,371] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":48},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G)\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:51,374] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:51,374] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:51,497] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:51,497] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:51,498] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":122,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:51,498] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":122,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:51,500] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":122}
[2019-08-13 14:28:51,500] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":122}
[2019-08-13 14:28:51,500] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":122}
[2019-08-13 14:28:51,500] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":122}
[2019-08-13 14:28:52,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2944
[2019-08-13 14:28:52,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2944
[2019-08-13 14:28:52,162] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":49},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:52,162] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":49},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", '10G')\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:28:52,165] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:52,165] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:28:52,283] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:52,283] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:28:52,284] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":123,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:52,284] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":123,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:28:52,286] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":123}
[2019-08-13 14:28:52,286] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":123}
[2019-08-13 14:28:52,286] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":123}
[2019-08-13 14:28:52,286] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":123}
[2019-08-13 14:31:56,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2943
[2019-08-13 14:31:56,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2943
[2019-08-13 14:31:56,473] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":50},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", '10G)\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:31:56,473] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":50},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", '10G)\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:31:56,476] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:31:56,476] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:31:56,618] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:31:56,618] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:31:56,618] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":124,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:31:56,618] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":124,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:31:56,619] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":124}
[2019-08-13 14:31:56,619] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":124}
[2019-08-13 14:31:56,619] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":124}
[2019-08-13 14:31:56,619] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":124}
[2019-08-13 14:31:57,552] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2945
[2019-08-13 14:31:57,552] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2945
[2019-08-13 14:31:57,553] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":51},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", '10G\")\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:31:57,553] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":51},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", '10G\")\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:31:57,556] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:31:57,556] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:31:57,670] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:31:57,670] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:31:57,671] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":125,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:31:57,671] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":125,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:31:57,673] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":125}
[2019-08-13 14:31:57,673] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":125}
[2019-08-13 14:31:57,673] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":125}
[2019-08-13 14:31:57,673] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":125}
[2019-08-13 14:32:00,361] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2944
[2019-08-13 14:32:00,361] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2944
[2019-08-13 14:32:00,362] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":52},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", 10G\")\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:00,362] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":52},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", 10G\")\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:00,365] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:00,365] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:00,508] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:00,508] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:00,509] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":126,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:00,509] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":126,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:00,510] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":126}
[2019-08-13 14:32:00,510] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":126}
[2019-08-13 14:32:00,510] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":126}
[2019-08-13 14:32:00,510] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":126}
[2019-08-13 14:32:00,748] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2946
[2019-08-13 14:32:00,748] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2946
[2019-08-13 14:32:00,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":53},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:00,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":53},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", '10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:00,751] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:00,751] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:00,870] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:00,870] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:00,871] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":127,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:00,871] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":127,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:00,873] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":127}
[2019-08-13 14:32:00,873] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":127}
[2019-08-13 14:32:00,874] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":127}
[2019-08-13 14:32:00,874] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":127}
[2019-08-13 14:32:03,512] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2945
[2019-08-13 14:32:03,512] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2945
[2019-08-13 14:32:03,513] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":54},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", 10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:03,513] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":54},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", 10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:03,516] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:03,516] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:03,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:03,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:03,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":128,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:03,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":128,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:03,659] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":128}
[2019-08-13 14:32:03,659] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":128}
[2019-08-13 14:32:03,659] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":128}
[2019-08-13 14:32:03,659] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":128}
[2019-08-13 14:32:03,975] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2947
[2019-08-13 14:32:03,975] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2947
[2019-08-13 14:32:03,976] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":55},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:03,976] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":55},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G')\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:03,977] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:03,977] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:04,102] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:04,102] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:04,103] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":129,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:04,103] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":129,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:04,105] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":129}
[2019-08-13 14:32:04,105] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":129}
[2019-08-13 14:32:04,105] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":129}
[2019-08-13 14:32:04,105] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":129}
[2019-08-13 14:32:06,225] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2946
[2019-08-13 14:32:06,225] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2946
[2019-08-13 14:32:06,226] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":56},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:06,226] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":56},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G)\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:06,228] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:06,228] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:06,373] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:06,373] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:06,373] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":130,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:06,373] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":130,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:06,375] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":130}
[2019-08-13 14:32:06,375] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":130}
[2019-08-13 14:32:06,375] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":130}
[2019-08-13 14:32:06,375] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":130}
[2019-08-13 14:32:06,679] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:32:06,679] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:32:06,679] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":57},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:06,679] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":57},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:32:06,681] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:06,681] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:32:06,805] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:06,805] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:32:06,806] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":131,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:06,806] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":131,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:32:06,808] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":131}
[2019-08-13 14:32:06,808] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":131}
[2019-08-13 14:32:06,808] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":131}
[2019-08-13 14:32:06,808] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":131}
[2019-08-13 14:32:53,858] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:53,858] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:53,858] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":132,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":43}}}
[2019-08-13 14:32:53,858] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":132,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":43}}}
[2019-08-13 14:32:53,860] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 43).
[2019-08-13 14:32:53,860] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 43).
[2019-08-13 14:32:53,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:53,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:53,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:53,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:53,947] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:53,947] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:53,948] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":132}}
[2019-08-13 14:32:53,948] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":132}}
[2019-08-13 14:32:53,949] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(132)
[2019-08-13 14:32:53,949] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(132)
[2019-08-13 14:32:56,194] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:56,194] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:56,194] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":133,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":14}}}
[2019-08-13 14:32:56,194] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":133,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":14}}}
[2019-08-13 14:32:56,195] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 14).
[2019-08-13 14:32:56,195] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 14).
[2019-08-13 14:32:56,196] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:56,196] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:56,196] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:56,196] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:56,243] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:56,243] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:56,243] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":133}}
[2019-08-13 14:32:56,243] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":133}}
[2019-08-13 14:32:56,244] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(133)
[2019-08-13 14:32:56,244] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(133)
[2019-08-13 14:32:56,594] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:56,594] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:56,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":134,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":11}}}
[2019-08-13 14:32:56,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":134,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":11}}}
[2019-08-13 14:32:56,596] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 11).
[2019-08-13 14:32:56,596] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 11).
[2019-08-13 14:32:56,596] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:56,596] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:56,597] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:56,597] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:56,682] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:56,682] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:56,683] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":134}}
[2019-08-13 14:32:56,683] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":134}}
[2019-08-13 14:32:56,684] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(134)
[2019-08-13 14:32:56,684] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(134)
[2019-08-13 14:32:57,032] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:57,032] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:32:57,033] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":135,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":27,"character":45}}}
[2019-08-13 14:32:57,033] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":135,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":27,"character":45}}}
[2019-08-13 14:32:57,034] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (27, 45).
[2019-08-13 14:32:57,034] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (27, 45).
[2019-08-13 14:32:57,035] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:57,035] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:32:57,035] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:57,035] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:32:57,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:57,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:32:57,172] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":135}}
[2019-08-13 14:32:57,172] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":135}}
[2019-08-13 14:32:57,173] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(135)
[2019-08-13 14:32:57,173] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(135)
[2019-08-13 14:33:05,549] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:33:05,549] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:33:05,549] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":136,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":6}}}
[2019-08-13 14:33:05,549] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":136,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":6}}}
[2019-08-13 14:33:05,550] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 6).
[2019-08-13 14:33:05,550] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 6).
[2019-08-13 14:33:05,551] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:33:05,551] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:33:05,551] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:33:05,551] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:33:05,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:33:05,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:33:05,599] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":136}}
[2019-08-13 14:33:05,599] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":136}}
[2019-08-13 14:33:05,600] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(136)
[2019-08-13 14:33:05,600] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(136)
[2019-08-13 14:33:06,975] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:33:06,975] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:33:06,975] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":137,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":32,"character":38}}}
[2019-08-13 14:33:06,975] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":137,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":32,"character":38}}}
[2019-08-13 14:33:06,976] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 38).
[2019-08-13 14:33:06,976] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 38).
[2019-08-13 14:33:06,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:33:06,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:33:06,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:33:06,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:33:08,872] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:33:08,872] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:33:08,873] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":137}}
[2019-08-13 14:33:08,873] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":137}}
[2019-08-13 14:33:08,875] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(137)
[2019-08-13 14:33:08,875] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(137)
[2019-08-13 14:33:16,967] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:33:16,967] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:33:16,967] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":138,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":27,"character":47}}}
[2019-08-13 14:33:16,967] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":138,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":27,"character":47}}}
[2019-08-13 14:33:16,967] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (27, 47).
[2019-08-13 14:33:16,967] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (27, 47).
[2019-08-13 14:33:16,968] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:33:16,968] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:33:16,968] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:33:16,968] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:33:17,015] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:33:17,015] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:33:17,015] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":138}}
[2019-08-13 14:33:17,015] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":138}}
[2019-08-13 14:33:17,016] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(138)
[2019-08-13 14:33:17,016] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(138)
[2019-08-13 14:37:40,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:37:40,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:37:40,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":139,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":49}}}
[2019-08-13 14:37:40,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":139,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":49}}}
[2019-08-13 14:37:40,222] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 49).
[2019-08-13 14:37:40,222] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 49).
[2019-08-13 14:37:40,237] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:37:40,237] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:37:40,237] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:37:40,237] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:37:40,271] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:37:40,271] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:37:40,271] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":139}}
[2019-08-13 14:37:40,271] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":139}}
[2019-08-13 14:37:40,272] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(139)
[2019-08-13 14:37:40,272] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(139)
[2019-08-13 14:38:14,949] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:38:14,949] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:38:14,949] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":140,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":19,"character":14}}}
[2019-08-13 14:38:14,949] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":140,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":19,"character":14}}}
[2019-08-13 14:38:14,950] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (19, 14).
[2019-08-13 14:38:14,950] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (19, 14).
[2019-08-13 14:38:14,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:38:14,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:38:14,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:38:14,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:38:15,099] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:38:15,099] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:38:15,100] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":140}}
[2019-08-13 14:38:15,100] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":140}}
[2019-08-13 14:38:15,101] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(140)
[2019-08-13 14:38:15,101] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(140)
[2019-08-13 14:38:28,764] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:38:28,764] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:38:28,764] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:38:28,764] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:38:28,765] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:38:28,765] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:39:26,390] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2413
[2019-08-13 14:39:26,390] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2413
[2019-08-13 14:39:26,390] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","languageId":"scala","version":1,"text":"\nlazy val kafkaVersion = \"0.8.2.1\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}}}
[2019-08-13 14:39:26,390] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","languageId":"scala","version":1,"text":"\nlazy val kafkaVersion = \"0.8.2.1\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}}}
[2019-08-13 14:39:26,391] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:39:26,391] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:39:26,391] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":141,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:39:26,391] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":141,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:39:26,392] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":141}
[2019-08-13 14:39:26,392] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":141}
[2019-08-13 14:39:26,392] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":141}
[2019-08-13 14:39:26,392] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":141}
[2019-08-13 14:39:29,070] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:39:29,070] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:39:29,071] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":142,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":41,"character":41}}}
[2019-08-13 14:39:29,071] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":142,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":41,"character":41}}}
[2019-08-13 14:39:29,072] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (41, 41).
[2019-08-13 14:39:29,072] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (41, 41).
[2019-08-13 14:39:29,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:39:29,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:39:29,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:39:29,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:39:33,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:39:33,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:39:33,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":142}}
[2019-08-13 14:39:33,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":142}}
[2019-08-13 14:39:33,017] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(142)
[2019-08-13 14:39:33,017] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(142)
[2019-08-13 14:39:33,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:39:33,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:39:33,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":143,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":39,"character":46}}}
[2019-08-13 14:39:33,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":143,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":39,"character":46}}}
[2019-08-13 14:39:33,869] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (39, 46).
[2019-08-13 14:39:33,869] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (39, 46).
[2019-08-13 14:39:33,869] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:39:33,869] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:39:33,870] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:39:33,870] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:39:34,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:39:34,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:39:34,017] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":143}}
[2019-08-13 14:39:34,017] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":143}}
[2019-08-13 14:39:34,018] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(143)
[2019-08-13 14:39:34,018] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(143)
[2019-08-13 14:40:07,005] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:07,005] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:07,006] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":144,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":51}}}
[2019-08-13 14:40:07,006] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":144,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":51}}}
[2019-08-13 14:40:07,007] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 51).
[2019-08-13 14:40:07,007] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 51).
[2019-08-13 14:40:07,007] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:07,007] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:07,007] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:07,007] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:07,053] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:07,053] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:07,054] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":144}}
[2019-08-13 14:40:07,054] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":144}}
[2019-08-13 14:40:07,055] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(144)
[2019-08-13 14:40:07,055] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(144)
[2019-08-13 14:40:07,404] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:07,404] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:07,404] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":145,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":29,"character":48}}}
[2019-08-13 14:40:07,404] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":145,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":29,"character":48}}}
[2019-08-13 14:40:07,405] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (29, 48).
[2019-08-13 14:40:07,405] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (29, 48).
[2019-08-13 14:40:07,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:07,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:07,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:07,406] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:07,467] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:07,467] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:07,468] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":145}}
[2019-08-13 14:40:07,468] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":145}}
[2019-08-13 14:40:07,469] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(145)
[2019-08-13 14:40:07,469] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(145)
[2019-08-13 14:40:21,161] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:21,161] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:21,161] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":146,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":22,"character":14}}}
[2019-08-13 14:40:21,161] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":146,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":22,"character":14}}}
[2019-08-13 14:40:21,162] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (22, 14).
[2019-08-13 14:40:21,162] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (22, 14).
[2019-08-13 14:40:21,163] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:21,163] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:21,163] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:21,163] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:21,506] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:21,506] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:21,507] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":146}}
[2019-08-13 14:40:21,507] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":146}}
[2019-08-13 14:40:21,508] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(146)
[2019-08-13 14:40:21,508] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(146)
[2019-08-13 14:40:51,682] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:51,682] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:51,682] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":147,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":60}}}
[2019-08-13 14:40:51,682] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":147,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":60}}}
[2019-08-13 14:40:51,683] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 60).
[2019-08-13 14:40:51,683] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 60).
[2019-08-13 14:40:51,684] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:51,684] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:51,684] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:51,684] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:51,748] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:51,748] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:40:51,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":147}}
[2019-08-13 14:40:51,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":147}}
[2019-08-13 14:40:51,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(147)
[2019-08-13 14:40:51,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(147)
[2019-08-13 14:40:53,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:53,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:40:53,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":148,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":39,"character":50}}}
[2019-08-13 14:40:53,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":148,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":39,"character":50}}}
[2019-08-13 14:40:53,486] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (39, 50).
[2019-08-13 14:40:53,486] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (39, 50).
[2019-08-13 14:40:53,487] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:53,487] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:40:53,487] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:40:53,487] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:11,755] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:11,755] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:11,755] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":148}}
[2019-08-13 14:41:11,755] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":148}}
[2019-08-13 14:41:11,756] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(148)
[2019-08-13 14:41:11,756] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(148)
[2019-08-13 14:41:18,260] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:18,260] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:18,261] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":149,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":5,"character":31}}}
[2019-08-13 14:41:18,261] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":149,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":5,"character":31}}}
[2019-08-13 14:41:18,262] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 31).
[2019-08-13 14:41:18,262] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 31).
[2019-08-13 14:41:18,262] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:18,262] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:18,263] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:18,263] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:18,338] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:18,338] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:18,339] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":149}}
[2019-08-13 14:41:18,339] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":149}}
[2019-08-13 14:41:18,340] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(149)
[2019-08-13 14:41:18,340] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(149)
[2019-08-13 14:41:30,434] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:30,434] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:30,435] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":150,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":1,"character":31}}}
[2019-08-13 14:41:30,435] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":150,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":1,"character":31}}}
[2019-08-13 14:41:30,436] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (1, 31).
[2019-08-13 14:41:30,436] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (1, 31).
[2019-08-13 14:41:30,436] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:30,436] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:30,436] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:30,436] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:30,710] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:30,710] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:30,710] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":150}}
[2019-08-13 14:41:30,710] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":150}}
[2019-08-13 14:41:30,711] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(150)
[2019-08-13 14:41:30,711] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(150)
[2019-08-13 14:41:33,410] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2414
[2019-08-13 14:41:33,410] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2414
[2019-08-13 14:41:33,411] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":2},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.8.2.\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:33,411] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":2},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.8.2.\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:33,413] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:33,413] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:34,094] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2410
[2019-08-13 14:41:34,094] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2410
[2019-08-13 14:41:34,095] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":6},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:34,095] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":6},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:34,097] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:34,097] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:34,241] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:34,241] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:34,241] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":151,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:34,241] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":151,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:34,242] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":151}
[2019-08-13 14:41:34,242] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":151}
[2019-08-13 14:41:34,242] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":151}
[2019-08-13 14:41:34,242] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":151}
[2019-08-13 14:41:35,727] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2411
[2019-08-13 14:41:35,727] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2411
[2019-08-13 14:41:35,727] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":7},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:35,727] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":7},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"1.6.0\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:35,729] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:35,729] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:35,852] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:35,852] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:35,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":152,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:35,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":152,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:35,854] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":152}
[2019-08-13 14:41:35,854] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":152}
[2019-08-13 14:41:35,854] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":152}
[2019-08-13 14:41:35,854] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":152}
[2019-08-13 14:41:44,950] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:44,950] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:44,951] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":153,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":30}}}
[2019-08-13 14:41:44,951] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":153,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":30}}}
[2019-08-13 14:41:44,952] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (2, 30).
[2019-08-13 14:41:44,952] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (2, 30).
[2019-08-13 14:41:44,952] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:44,952] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:44,952] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:44,952] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:45,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:45,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:45,175] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":153}}
[2019-08-13 14:41:45,175] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":153}}
[2019-08-13 14:41:45,176] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(153)
[2019-08-13 14:41:45,176] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(153)
[2019-08-13 14:41:45,325] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:45,325] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:45,326] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":154,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":29}}}
[2019-08-13 14:41:45,326] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":154,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":29}}}
[2019-08-13 14:41:45,327] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (2, 29).
[2019-08-13 14:41:45,327] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (2, 29).
[2019-08-13 14:41:45,327] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:45,327] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:45,327] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:45,327] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:46,006] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:46,006] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:46,006] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":154}}
[2019-08-13 14:41:46,006] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":154}}
[2019-08-13 14:41:46,007] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(154)
[2019-08-13 14:41:46,007] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(154)
[2019-08-13 14:41:48,607] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2407
[2019-08-13 14:41:48,607] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2407
[2019-08-13 14:41:48,607] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":8},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:48,607] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":8},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:48,608] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:48,608] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:48,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:48,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:48,749] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":155,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:48,749] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":155,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:48,750] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":155}
[2019-08-13 14:41:48,750] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":155}
[2019-08-13 14:41:48,750] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":155}
[2019-08-13 14:41:48,750] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":155}
[2019-08-13 14:41:49,686] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2408
[2019-08-13 14:41:49,686] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2408
[2019-08-13 14:41:49,686] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":9},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:49,686] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":9},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:49,687] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:49,687] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:49,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-13 14:41:49,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-13 14:41:49,687] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":156,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":27}}}
[2019-08-13 14:41:49,687] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":156,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":27}}}
[2019-08-13 14:41:49,687] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 14:41:49,687] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 14:41:50,029] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:50,029] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:50,029] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":157,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:50,029] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":157,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:50,030] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":157}
[2019-08-13 14:41:50,030] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":157}
[2019-08-13 14:41:50,030] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":157}
[2019-08-13 14:41:50,030] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":157}
[2019-08-13 14:41:50,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:50,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:50,208] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":156}}
[2019-08-13 14:41:50,208] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":156}}
[2019-08-13 14:41:50,208] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(156)
[2019-08-13 14:41:50,208] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(156)
[2019-08-13 14:41:50,410] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2410
[2019-08-13 14:41:50,410] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2410
[2019-08-13 14:41:50,410] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":10},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:50,410] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":10},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:50,412] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:50,412] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:50,551] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:50,551] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:50,551] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":158,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:50,551] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":158,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:50,552] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":158}
[2019-08-13 14:41:50,552] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":158}
[2019-08-13 14:41:50,552] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":158}
[2019-08-13 14:41:50,552] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":158}
[2019-08-13 14:41:51,856] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2411
[2019-08-13 14:41:51,856] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2411
[2019-08-13 14:41:51,857] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":11},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:51,857] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":11},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:51,859] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:51,859] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:51,860] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-13 14:41:51,860] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-13 14:41:51,860] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":159,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":29}}}
[2019-08-13 14:41:51,860] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":159,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":2,"character":29}}}
[2019-08-13 14:41:51,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 14:41:51,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 14:41:52,178] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:52,178] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:52,179] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":160,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:52,179] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":160,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:52,180] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":160}
[2019-08-13 14:41:52,180] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":160}
[2019-08-13 14:41:52,181] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":160}
[2019-08-13 14:41:52,181] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":160}
[2019-08-13 14:41:52,595] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:52,595] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:52,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":159}}
[2019-08-13 14:41:52,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":159}}
[2019-08-13 14:41:52,597] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(159)
[2019-08-13 14:41:52,597] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(159)
[2019-08-13 14:41:52,793] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2412
[2019-08-13 14:41:52,793] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2412
[2019-08-13 14:41:52,793] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":12},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:52,793] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":12},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:41:52,795] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:52,795] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:41:52,944] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:52,944] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:41:52,944] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":161,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:52,944] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":161,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:41:52,947] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":161}
[2019-08-13 14:41:52,947] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":161}
[2019-08-13 14:41:52,947] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":161}
[2019-08-13 14:41:52,947] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":161}
[2019-08-13 14:41:54,077] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:54,077] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:41:54,078] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":162,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":1,"character":26}}}
[2019-08-13 14:41:54,078] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":162,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":1,"character":26}}}
[2019-08-13 14:41:54,079] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (1, 26).
[2019-08-13 14:41:54,079] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (1, 26).
[2019-08-13 14:41:54,080] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:54,080] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:54,080] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:54,080] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:54,127] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:54,127] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:41:54,128] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":162}}
[2019-08-13 14:41:54,128] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":162}}
[2019-08-13 14:41:54,130] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(162)
[2019-08-13 14:41:54,130] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(162)
[2019-08-13 14:41:56,816] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:41:56,816] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:41:56,816] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":163,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":27,"character":54}}}
[2019-08-13 14:41:56,816] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":163,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":27,"character":54}}}
[2019-08-13 14:41:56,817] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (27, 54).
[2019-08-13 14:41:56,817] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (27, 54).
[2019-08-13 14:41:56,818] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:56,818] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:41:56,818] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:41:56,818] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:00,033] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:00,033] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:00,033] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":163}}
[2019-08-13 14:42:00,033] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":163}}
[2019-08-13 14:42:00,034] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(163)
[2019-08-13 14:42:00,034] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(163)
[2019-08-13 14:42:05,182] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:42:05,182] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:42:05,182] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":164,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":0}}}
[2019-08-13 14:42:05,182] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":164,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":0}}}
[2019-08-13 14:42:05,183] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 0).
[2019-08-13 14:42:05,183] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 0).
[2019-08-13 14:42:05,185] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:05,185] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:05,185] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:05,185] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:05,599] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:05,599] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:05,599] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":164}}
[2019-08-13 14:42:05,599] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":164}}
[2019-08-13 14:42:05,600] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(164)
[2019-08-13 14:42:05,600] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(164)
[2019-08-13 14:42:10,499] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:42:10,499] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:42:10,499] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":165,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":1}}}
[2019-08-13 14:42:10,499] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":165,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":1}}}
[2019-08-13 14:42:10,500] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 1).
[2019-08-13 14:42:10,500] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 1).
[2019-08-13 14:42:10,500] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:10,500] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:10,500] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:10,500] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:11,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:11,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:11,795] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":165}}
[2019-08-13 14:42:11,795] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":165}}
[2019-08-13 14:42:11,796] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(165)
[2019-08-13 14:42:11,796] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(165)
[2019-08-13 14:42:11,945] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:42:11,945] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 168
[2019-08-13 14:42:11,945] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":166,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":2}}}
[2019-08-13 14:42:11,945] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":166,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":31,"character":2}}}
[2019-08-13 14:42:11,946] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 2).
[2019-08-13 14:42:11,946] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 2).
[2019-08-13 14:42:11,947] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:11,947] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:11,947] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:11,947] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:12,376] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:12,376] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:12,377] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":166}}
[2019-08-13 14:42:12,377] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":166}}
[2019-08-13 14:42:12,378] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(166)
[2019-08-13 14:42:12,378] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(166)
[2019-08-13 14:42:18,666] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2416
[2019-08-13 14:42:18,666] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2416
[2019-08-13 14:42:18,666] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":13},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:18,666] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":13},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:18,668] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:18,668] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:18,869] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2481
[2019-08-13 14:42:18,869] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2481
[2019-08-13 14:42:18,870] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":14},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:18,870] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":14},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:18,872] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:18,872] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:19,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:19,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:19,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":167,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:19,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":167,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:19,018] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":167}
[2019-08-13 14:42:19,018] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":167}
[2019-08-13 14:42:19,019] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":167}
[2019-08-13 14:42:19,019] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":167}
[2019-08-13 14:42:36,646] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:36,646] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:36,646] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":168,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":23}}}
[2019-08-13 14:42:36,646] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":168,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":23}}}
[2019-08-13 14:42:36,647] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 23).
[2019-08-13 14:42:36,647] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 23).
[2019-08-13 14:42:36,648] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:36,648] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:36,648] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:36,648] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:36,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:36,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:36,693] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":168}}
[2019-08-13 14:42:36,693] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":168}}
[2019-08-13 14:42:36,694] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(168)
[2019-08-13 14:42:36,694] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(168)
[2019-08-13 14:42:36,844] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:36,844] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:36,844] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":169,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":25}}}
[2019-08-13 14:42:36,844] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":169,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":25}}}
[2019-08-13 14:42:36,845] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 25).
[2019-08-13 14:42:36,845] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 25).
[2019-08-13 14:42:36,846] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:36,846] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:36,846] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:36,846] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:37,089] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:37,089] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:37,089] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":169}}
[2019-08-13 14:42:37,089] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":169}}
[2019-08-13 14:42:37,091] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(169)
[2019-08-13 14:42:37,091] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(169)
[2019-08-13 14:42:37,656] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:37,656] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:37,657] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":170,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":34,"character":45}}}
[2019-08-13 14:42:37,657] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":170,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":34,"character":45}}}
[2019-08-13 14:42:37,658] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (34, 45).
[2019-08-13 14:42:37,658] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (34, 45).
[2019-08-13 14:42:37,659] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:37,659] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:37,659] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:37,659] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:37,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:37,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:37,705] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":170}}
[2019-08-13 14:42:37,705] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":170}}
[2019-08-13 14:42:37,706] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(170)
[2019-08-13 14:42:37,706] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(170)
[2019-08-13 14:42:38,155] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:38,155] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:42:38,156] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":171,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":46}}}
[2019-08-13 14:42:38,156] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":171,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":46}}}
[2019-08-13 14:42:38,157] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 46).
[2019-08-13 14:42:38,157] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 46).
[2019-08-13 14:42:38,157] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:38,157] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:42:38,157] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:38,157] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:42:38,416] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:38,416] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:42:38,416] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":171}}
[2019-08-13 14:42:38,416] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":171}}
[2019-08-13 14:42:38,418] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(171)
[2019-08-13 14:42:38,418] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(171)
[2019-08-13 14:42:40,145] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2477
[2019-08-13 14:42:40,145] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2477
[2019-08-13 14:42:40,145] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":15},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"sspark-sql-kafka-\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:40,145] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":15},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"sspark-sql-kafka-\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:40,148] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:40,148] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:40,263] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:40,263] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:40,263] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":172,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:40,263] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":172,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:40,265] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":172}
[2019-08-13 14:42:40,265] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":172}
[2019-08-13 14:42:40,265] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":172}
[2019-08-13 14:42:40,265] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":172}
[2019-08-13 14:42:43,189] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2476
[2019-08-13 14:42:43,189] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2476
[2019-08-13 14:42:43,190] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":16},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"sspark-sql-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:43,190] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":16},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"sspark-sql-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:43,192] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:43,192] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:43,311] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:43,311] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:43,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":173,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:43,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":173,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:43,313] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":173}
[2019-08-13 14:42:43,313] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":173}
[2019-08-13 14:42:43,313] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":173}
[2019-08-13 14:42:43,313] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":173}
[2019-08-13 14:42:47,295] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2475
[2019-08-13 14:42:47,295] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2475
[2019-08-13 14:42:47,295] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":17},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:47,295] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":17},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % sparkVersion,\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:42:47,297] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:47,297] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:42:47,420] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:47,420] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:42:47,420] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":174,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:47,420] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":174,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:42:47,422] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":174}
[2019-08-13 14:42:47,422] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":174}
[2019-08-13 14:42:47,422] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":174}
[2019-08-13 14:42:47,422] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":174}
[2019-08-13 14:43:16,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:43:16,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:43:16,147] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":175,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":52}}}
[2019-08-13 14:43:16,147] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":175,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":32,"character":52}}}
[2019-08-13 14:43:16,147] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 52).
[2019-08-13 14:43:16,147] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (32, 52).
[2019-08-13 14:43:16,148] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:16,148] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:16,148] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:16,148] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:16,282] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:16,282] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:16,283] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":175}}
[2019-08-13 14:43:16,283] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":175}}
[2019-08-13 14:43:16,284] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(175)
[2019-08-13 14:43:16,284] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(175)
[2019-08-13 14:43:18,179] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2479
[2019-08-13 14:43:18,179] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2479
[2019-08-13 14:43:18,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":18},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"sparkVersion\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:18,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":18},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"sparkVersion\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:18,182] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:18,182] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:18,296] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:43:18,296] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:43:18,296] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":176,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:43:18,296] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":176,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:43:18,298] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":176}
[2019-08-13 14:43:18,298] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":176}
[2019-08-13 14:43:18,298] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":176}
[2019-08-13 14:43:18,298] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":176}
[2019-08-13 14:43:19,490] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2467
[2019-08-13 14:43:19,490] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2467
[2019-08-13 14:43:19,490] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":19},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:19,490] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":19},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:19,492] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:19,492] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:19,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2482
[2019-08-13 14:43:19,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2482
[2019-08-13 14:43:19,750] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":20},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"0-10_2.11:2.3.3\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:19,750] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":20},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"0-10_2.11:2.3.3\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:19,752] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:19,752] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:19,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:43:19,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 140
[2019-08-13 14:43:19,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":177,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:43:19,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":177,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:43:19,870] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":177}
[2019-08-13 14:43:19,870] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":177}
[2019-08-13 14:43:19,870] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":177}
[2019-08-13 14:43:19,870] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":177}
[2019-08-13 14:43:28,639] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:43:28,639] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 169
[2019-08-13 14:43:28,639] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":178,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":60,"character":42}}}
[2019-08-13 14:43:28,639] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":178,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":60,"character":42}}}
[2019-08-13 14:43:28,640] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 42).
[2019-08-13 14:43:28,640] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 42).
[2019-08-13 14:43:28,640] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:28,640] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:28,641] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:28,641] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:30,201] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:30,201] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:30,202] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":178}}
[2019-08-13 14:43:30,202] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":178}}
[2019-08-13 14:43:30,202] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(178)
[2019-08-13 14:43:30,202] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(178)
[2019-08-13 14:43:39,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 167
[2019-08-13 14:43:39,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 167
[2019-08-13 14:43:39,222] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":179,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":5,"character":0}}}
[2019-08-13 14:43:39,222] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":179,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":5,"character":0}}}
[2019-08-13 14:43:39,222] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 0).
[2019-08-13 14:43:39,222] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 0).
[2019-08-13 14:43:39,223] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:39,223] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:39,223] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:39,223] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:40,587] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:40,587] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:40,587] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":179}}
[2019-08-13 14:43:40,587] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":179}}
[2019-08-13 14:43:40,588] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(179)
[2019-08-13 14:43:40,588] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(179)
[2019-08-13 14:43:40,738] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 167
[2019-08-13 14:43:40,738] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 167
[2019-08-13 14:43:40,738] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":180,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":6,"character":1}}}
[2019-08-13 14:43:40,738] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":180,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"},"position":{"line":6,"character":1}}}
[2019-08-13 14:43:40,739] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (6, 1).
[2019-08-13 14:43:40,739] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (6, 1).
[2019-08-13 14:43:40,739] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:40,739] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:43:40,740] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:40,740] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:43:40,976] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:40,976] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:43:40,976] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":180}}
[2019-08-13 14:43:40,976] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":180}}
[2019-08-13 14:43:40,978] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(180)
[2019-08-13 14:43:40,978] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(180)
[2019-08-13 14:43:45,604] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2482
[2019-08-13 14:43:45,604] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2482
[2019-08-13 14:43:45,605] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":20},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"0-10_2.11:2.3.3\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:45,605] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":20},"contentChanges":[{"text":"\nlazy val kafkaVersion = \"0.9\"\nlazy val sparkVersion = \"2.3.3\"\n\nlazy val commonSettings = Seq(\n  name := \"openmrs-data-stream\",\n  version := \"1.0\",\n  organization := \"http://org.github.io/\",\n  scalaVersion := \"2.11.7\"\n)\n\nlazy val customScalacOptions = Seq(\n  \"-deprecation\",\n  \"-encoding\", \"UTF-8\",\n  \"-feature\",\n  \"-unchecked\",\n  \"-Xfatal-warnings\",\n  \"-Xfuture\",\n  \"-Xlint\",\n  \"-Yno-adapted-args\",\n  \"-Ywarn-dead-code\",\n  \"-Ywarn-numeric-widen\",\n  \"-Ywarn-unused-import\"\n)\n\nlazy val customLibraryDependencies = Seq(\n  \"org.apache.kafka\" %% \"kafka\" % kafkaVersion,\n  \"org.apache.kafka\" % \"kafka-clients\" % kafkaVersion,\n\n  \"org.apache.spark\" %% \"spark-core\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-streaming-kafka\" % sparkVersion,\n  \"org.apache.spark\" %% \"spark-sql-kafka\" % \"0-10_2.11:2.3.3\",\n\n  \"com.twitter\" %% \"bijection-avro\" % \"0.8.1\",\n  \"com.twitter\" %% \"chill-avro\" % \"0.7.2\",\n\n  \"com.typesafe\" % \"config\" % \"1.2.1\",\n  \"net.ceedubs\" %% \"ficus\" % \"1.1.1\",\n\n  \"ch.qos.logback\" % \"logback-classic\" % \"0.9.24\",\n\n  \"org.scalatest\" %% \"scalatest\" % \"2.2.4\" % \"test\"\n)\n\nlazy val commonExcludeDependencies = Seq(\n  \"org.slf4j\" % \"slf4j-log4j12\"\n)\n\nlazy val customJavaOptions = Seq(\n  \"-Xmx1024m\",\n  \"-XX:-MaxFDLimit\"\n)\n\nlazy val compileScalastyle = taskKey[Unit](\"compileScalastyle\")\nlazy val testScalastyle = taskKey[Unit](\"testScalastyle\")\n\nlazy val root = (project in file(\".\"))\n  .settings(commonSettings)\n  .settings(scalacOptions ++= customScalacOptions)\n  .settings(libraryDependencies ++= customLibraryDependencies)\n  .settings(excludeDependencies ++= commonExcludeDependencies)\n  .settings(fork in run := true)\n  .settings(connectInput in run := true)\n  .settings(javaOptions in run ++= customJavaOptions)\n//  .settings(\n//    scalastyleFailOnError := false,\n//    compileScalastyle := scalastyle.in(Compile).toTask(\"\").value,\n//    (compile in Compile) := ((compile in Compile) dependsOn compileScalastyle).value,\n//    testScalastyle := scalastyle.in(Test).toTask(\"\").value,\n//    (test in Test) := ((test in Test) dependsOn testScalastyle).value)"}]}}
[2019-08-13 14:43:45,605] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:45,605] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:43:45,605] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 137
[2019-08-13 14:43:45,605] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 137
[2019-08-13 14:43:45,606] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":20}}}
[2019-08-13 14:43:45,606] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt","version":20}}}
[2019-08-13 14:43:45,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/build.sbt)
[2019-08-13 14:43:45,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/build.sbt)
[2019-08-13 14:43:45,607] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 125
[2019-08-13 14:43:45,607] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 125
[2019-08-13 14:43:45,607] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:43:45,607] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/build.sbt"}}}
[2019-08-13 14:43:45,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/build.sbt from Ensime.
[2019-08-13 14:43:45,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/build.sbt from Ensime.
[2019-08-13 14:43:48,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:43:48,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:43:48,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:43:48,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:43:48,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 194
[2019-08-13 14:43:48,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 194
[2019-08-13 14:43:48,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":181,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:48,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":181,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:48,473] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":181}
[2019-08-13 14:43:48,473] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":181}
[2019-08-13 14:43:48,473] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":181}
[2019-08-13 14:43:48,473] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":181}
[2019-08-13 14:43:50,257] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:43:50,257] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:43:50,257] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:50,257] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:50,258] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:43:50,258] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:43:50,279] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:43:50,279] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:43:50,279] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:43:50,279] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:43:50,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 14:43:50,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 14:43:50,280] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":182,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:43:50,280] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":182,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:43:50,280] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":182}
[2019-08-13 14:43:50,280] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":182}
[2019-08-13 14:43:50,280] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":182}
[2019-08-13 14:43:50,280] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":182}
[2019-08-13 14:43:58,556] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 14:43:58,556] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 14:43:58,556] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:43:58,556] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:43:58,557] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 14:43:58,557] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 14:43:58,577] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:43:58,577] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 926
[2019-08-13 14:43:58,578] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:43:58,578] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.SparkContext\nimport org.apache.spark.streaming.Seconds\nimport org.apache.spark.streaming.StreamingContext\n\ntrait SparkStreamingApplication extends SparkApplication {\n\n  def streamingBatchDuration: FiniteDuration\n\n  def streamingCheckpointDir: String\n\n  def withSparkStreamingContext(f: (SparkContext, StreamingContext) => Unit): Unit = {\n    withSparkContext { sc =>\n      val ssc = new StreamingContext(sc, Seconds(streamingBatchDuration.toSeconds))\n      ssc.checkpoint(streamingCheckpointDir)\n\n      f(sc, ssc)\n\n      ssc.start()\n      ssc.awaitTermination()\n    }\n  }\n\n}\n"}}}
[2019-08-13 14:43:58,578] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 194
[2019-08-13 14:43:58,578] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 194
[2019-08-13 14:43:58,578] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":183,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:58,578] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":183,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:58,578] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":183}
[2019-08-13 14:43:58,578] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":183}
[2019-08-13 14:43:58,578] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":183}
[2019-08-13 14:43:58,578] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":183}
[2019-08-13 14:43:59,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:43:59,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 179
[2019-08-13 14:43:59,998] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:59,998] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala"}}}
[2019-08-13 14:43:59,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:43:59,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkStreamingApplication.scala from Ensime.
[2019-08-13 14:44:00,013] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:44:00,013] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 612
[2019-08-13 14:44:00,014] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:44:00,014] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala","languageId":"scala","version":1,"text":"\n\npackage org.spark.stream\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\n\ntrait SparkApplication {\n\n  def sparkConfig: Map[String, String]\n\n  def withSparkContext(f: SparkContext => Unit): Unit = {\n    val conf = new SparkConf()\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    val sc = new SparkContext(conf)\n\n    f(sc)\n  }\n\n}\n"}}}
[2019-08-13 14:44:00,014] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 14:44:00,014] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 14:44:00,014] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":184,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:44:00,014] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":184,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 14:44:00,015] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":184}
[2019-08-13 14:44:00,015] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":184}
[2019-08-13 14:44:00,015] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":184}
[2019-08-13 14:44:00,015] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":184}
[2019-08-13 14:44:05,157] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:44:05,157] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:44:05,157] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":57},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:05,157] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":57},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:05,158] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:05,158] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:08,431] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:44:08,431] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2948
[2019-08-13 14:44:08,432] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":57},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:08,432] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala","version":57},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:08,432] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:08,432] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:08,432] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-13 14:44:08,432] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-13 14:44:08,432] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:08,432] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:08,432] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala from Ensime.
[2019-08-13 14:44:08,432] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/StructuredStreaming.scala from Ensime.
[2019-08-13 14:44:08,484] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2945
[2019-08-13 14:44:08,484] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2945
[2019-08-13 14:44:08,484] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","languageId":"scala","version":1,"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}}}
[2019-08-13 14:44:08,484] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","languageId":"scala","version":1,"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}}}
[2019-08-13 14:44:08,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2947
[2019-08-13 14:44:08,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2947
[2019-08-13 14:44:08,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":1},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:08,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":1},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", config.getProperty(\"bootstrap.servers\"))\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:08,485] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:08,485] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:08,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:44:08,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:44:08,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":185,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:08,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":185,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:08,486] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":185}
[2019-08-13 14:44:08,486] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":185}
[2019-08-13 14:44:08,486] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":185}
[2019-08-13 14:44:08,486] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":185}
[2019-08-13 14:44:14,696] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:14,696] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:14,697] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":186,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":38}}}
[2019-08-13 14:44:14,697] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":186,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":38}}}
[2019-08-13 14:44:14,698] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 38).
[2019-08-13 14:44:14,698] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 38).
[2019-08-13 14:44:14,698] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:14,698] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:14,698] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:14,698] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:14,747] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:14,747] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:14,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":186}}
[2019-08-13 14:44:14,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":186}}
[2019-08-13 14:44:14,749] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(186)
[2019-08-13 14:44:14,749] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(186)
[2019-08-13 14:44:27,495] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:27,495] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:27,495] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":187,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":50}}}
[2019-08-13 14:44:27,495] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":187,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":50}}}
[2019-08-13 14:44:27,496] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 50).
[2019-08-13 14:44:27,496] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 50).
[2019-08-13 14:44:27,496] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:27,496] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:27,497] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:27,497] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:27,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:27,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:27,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":187}}
[2019-08-13 14:44:27,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":187}}
[2019-08-13 14:44:27,744] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(187)
[2019-08-13 14:44:27,744] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(187)
[2019-08-13 14:44:32,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:32,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:32,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":188,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":46}}}
[2019-08-13 14:44:32,016] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":188,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":46}}}
[2019-08-13 14:44:32,017] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 46).
[2019-08-13 14:44:32,017] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 46).
[2019-08-13 14:44:32,018] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:32,018] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:32,018] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:32,018] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:32,148] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:32,148] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:32,149] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":188}}
[2019-08-13 14:44:32,149] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":188}}
[2019-08-13 14:44:32,150] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(188)
[2019-08-13 14:44:32,150] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(188)
[2019-08-13 14:44:32,999] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:32,999] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:32,999] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":189,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":24}}}
[2019-08-13 14:44:32,999] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":189,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":24}}}
[2019-08-13 14:44:33,000] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 24).
[2019-08-13 14:44:33,000] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 24).
[2019-08-13 14:44:33,000] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:33,000] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:33,001] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:33,001] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:33,101] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:33,101] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:33,101] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":189}}
[2019-08-13 14:44:33,101] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":189}}
[2019-08-13 14:44:33,102] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(189)
[2019-08-13 14:44:33,102] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(189)
[2019-08-13 14:44:33,651] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:33,651] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:33,651] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":190,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":21}}}
[2019-08-13 14:44:33,651] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":190,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":21}}}
[2019-08-13 14:44:33,652] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 21).
[2019-08-13 14:44:33,652] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 21).
[2019-08-13 14:44:33,653] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:33,653] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:33,653] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:33,653] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:33,746] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:33,746] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:33,746] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":190}}
[2019-08-13 14:44:33,746] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":190}}
[2019-08-13 14:44:33,747] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(190)
[2019-08-13 14:44:33,747] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(190)
[2019-08-13 14:44:33,896] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:33,896] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:33,897] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":191,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":21}}}
[2019-08-13 14:44:33,897] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":191,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":21}}}
[2019-08-13 14:44:33,898] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 21).
[2019-08-13 14:44:33,898] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 21).
[2019-08-13 14:44:33,898] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:33,898] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:33,899] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:33,899] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:33,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:33,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:33,969] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":191}}
[2019-08-13 14:44:33,969] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":191}}
[2019-08-13 14:44:33,970] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(191)
[2019-08-13 14:44:33,970] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(191)
[2019-08-13 14:44:34,119] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:34,119] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:34,119] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":192,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":22}}}
[2019-08-13 14:44:34,119] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":192,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":22}}}
[2019-08-13 14:44:34,120] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 22).
[2019-08-13 14:44:34,120] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 22).
[2019-08-13 14:44:34,121] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:34,121] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:34,121] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:34,121] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:34,416] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:34,416] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:34,416] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":192}}
[2019-08-13 14:44:34,416] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":192}}
[2019-08-13 14:44:34,417] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(192)
[2019-08-13 14:44:34,417] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(192)
[2019-08-13 14:44:34,768] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:34,768] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:34,768] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":193,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":19}}}
[2019-08-13 14:44:34,768] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":193,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":19}}}
[2019-08-13 14:44:34,769] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 19).
[2019-08-13 14:44:34,769] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 19).
[2019-08-13 14:44:34,770] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:34,770] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:34,770] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:34,770] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:35,673] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:35,673] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:35,673] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":193}}
[2019-08-13 14:44:35,673] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":193}}
[2019-08-13 14:44:35,674] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(193)
[2019-08-13 14:44:35,674] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(193)
[2019-08-13 14:44:49,502] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:49,502] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:49,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":194,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":38}}}
[2019-08-13 14:44:49,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":194,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":38}}}
[2019-08-13 14:44:49,503] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 38).
[2019-08-13 14:44:49,503] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 38).
[2019-08-13 14:44:49,504] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:49,504] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:49,504] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:49,504] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:49,999] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:49,999] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:49,999] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":194}}
[2019-08-13 14:44:49,999] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":194}}
[2019-08-13 14:44:50,000] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(194)
[2019-08-13 14:44:50,000] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(194)
[2019-08-13 14:44:51,504] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:51,504] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:44:51,505] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":195,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":78}}}
[2019-08-13 14:44:51,505] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":195,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":78}}}
[2019-08-13 14:44:51,505] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 78).
[2019-08-13 14:44:51,505] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 78).
[2019-08-13 14:44:51,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:51,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:44:51,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:51,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:44:51,865] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:51,865] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:44:51,866] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":195}}
[2019-08-13 14:44:51,866] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":195}}
[2019-08-13 14:44:51,866] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(195)
[2019-08-13 14:44:51,866] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(195)
[2019-08-13 14:44:53,825] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2906
[2019-08-13 14:44:53,825] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2906
[2019-08-13 14:44:53,826] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":2},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", )\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:53,826] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":2},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", )\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:53,829] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:53,829] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:53,971] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:44:53,971] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:44:53,971] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":196,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:53,971] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":196,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:53,973] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":196}
[2019-08-13 14:44:53,973] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":196}
[2019-08-13 14:44:53,973] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":196}
[2019-08-13 14:44:53,973] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":196}
[2019-08-13 14:44:54,246] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2924
[2019-08-13 14:44:54,246] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2924
[2019-08-13 14:44:54,246] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":3},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:54,246] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":3},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", config.getProperty(\"topic.names\"))\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:44:54,248] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:54,248] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:44:54,392] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:44:54,392] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:44:54,393] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":197,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:54,393] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":197,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:44:54,394] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":197}
[2019-08-13 14:44:54,394] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":197}
[2019-08-13 14:44:54,394] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":197}
[2019-08-13 14:44:54,394] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":197}
[2019-08-13 14:45:08,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:08,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:08,918] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":198,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":26}}}
[2019-08-13 14:45:08,918] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":198,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":26}}}
[2019-08-13 14:45:08,918] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 26).
[2019-08-13 14:45:08,918] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 26).
[2019-08-13 14:45:08,919] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:08,919] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:08,919] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:08,919] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:08,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:08,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:08,969] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":198}}
[2019-08-13 14:45:08,969] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":198}}
[2019-08-13 14:45:08,970] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(198)
[2019-08-13 14:45:08,970] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(198)
[2019-08-13 14:45:09,119] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:09,119] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:09,119] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":199,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":25}}}
[2019-08-13 14:45:09,119] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":199,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":25}}}
[2019-08-13 14:45:09,120] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 25).
[2019-08-13 14:45:09,120] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 25).
[2019-08-13 14:45:09,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:09,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:09,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:09,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:09,299] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:09,299] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:09,299] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":199}}
[2019-08-13 14:45:09,299] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":199}}
[2019-08-13 14:45:09,300] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(199)
[2019-08-13 14:45:09,300] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(199)
[2019-08-13 14:45:10,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:10,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:10,215] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":200,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":59}}}
[2019-08-13 14:45:10,215] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":200,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":59}}}
[2019-08-13 14:45:10,216] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 59).
[2019-08-13 14:45:10,216] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 59).
[2019-08-13 14:45:10,216] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:10,216] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:10,217] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:10,217] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:10,427] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:10,427] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:10,428] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":200}}
[2019-08-13 14:45:10,428] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":200}}
[2019-08-13 14:45:10,429] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(200)
[2019-08-13 14:45:10,429] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(200)
[2019-08-13 14:45:10,578] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:10,578] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:10,579] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":201,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":57}}}
[2019-08-13 14:45:10,579] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":201,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":57}}}
[2019-08-13 14:45:10,580] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 57).
[2019-08-13 14:45:10,580] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 57).
[2019-08-13 14:45:10,580] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:10,580] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:10,581] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:10,581] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:11,002] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:11,002] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:11,003] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":201}}
[2019-08-13 14:45:11,003] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":201}}
[2019-08-13 14:45:11,004] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(201)
[2019-08-13 14:45:11,004] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(201)
[2019-08-13 14:45:15,197] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2889
[2019-08-13 14:45:15,197] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2889
[2019-08-13 14:45:15,197] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":4},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", )\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:45:15,197] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":4},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", )\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:45:15,200] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:45:15,200] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:45:15,345] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:45:15,345] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:45:15,346] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":202,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:45:15,346] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":202,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:45:15,347] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":202}
[2019-08-13 14:45:15,347] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":202}
[2019-08-13 14:45:15,347] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":202}
[2019-08-13 14:45:15,347] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":202}
[2019-08-13 14:45:15,773] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2918
[2019-08-13 14:45:15,773] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2918
[2019-08-13 14:45:15,773] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":5},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:45:15,773] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":5},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"data\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:45:15,775] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:45:15,775] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:45:15,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:45:15,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:45:15,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":203,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:45:15,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":203,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:45:15,922] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":203}
[2019-08-13 14:45:15,922] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":203}
[2019-08-13 14:45:15,922] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":203}
[2019-08-13 14:45:15,922] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":203}
[2019-08-13 14:45:55,355] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:55,355] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:45:55,356] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":204,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":27}}}
[2019-08-13 14:45:55,356] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":204,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":27}}}
[2019-08-13 14:45:55,356] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 27).
[2019-08-13 14:45:55,356] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 27).
[2019-08-13 14:45:55,357] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:55,357] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:45:55,357] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:55,357] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:45:55,441] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:55,441] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:45:55,442] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":204}}
[2019-08-13 14:45:55,442] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":204}}
[2019-08-13 14:45:55,443] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(204)
[2019-08-13 14:45:55,443] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(204)
[2019-08-13 14:46:15,406] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:15,406] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:15,406] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":205,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":32}}}
[2019-08-13 14:46:15,406] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":205,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":32}}}
[2019-08-13 14:46:15,407] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 32).
[2019-08-13 14:46:15,407] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 32).
[2019-08-13 14:46:15,407] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:15,407] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:15,407] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:15,407] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:15,804] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:15,804] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:15,804] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":205}}
[2019-08-13 14:46:15,804] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":205}}
[2019-08-13 14:46:15,805] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(205)
[2019-08-13 14:46:15,805] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(205)
[2019-08-13 14:46:22,291] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:22,291] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:22,292] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":206,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":31}}}
[2019-08-13 14:46:22,292] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":206,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":31}}}
[2019-08-13 14:46:22,293] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 31).
[2019-08-13 14:46:22,293] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 31).
[2019-08-13 14:46:22,293] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:22,293] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:22,293] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:22,293] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:22,451] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:22,451] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:22,451] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":206}}
[2019-08-13 14:46:22,451] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":206}}
[2019-08-13 14:46:22,452] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(206)
[2019-08-13 14:46:22,452] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(206)
[2019-08-13 14:46:22,601] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:22,601] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:22,602] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":207,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":32}}}
[2019-08-13 14:46:22,602] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":207,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":32}}}
[2019-08-13 14:46:22,603] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 32).
[2019-08-13 14:46:22,603] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 32).
[2019-08-13 14:46:22,603] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:22,603] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:22,603] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:22,603] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:22,888] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:22,888] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:22,888] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":207}}
[2019-08-13 14:46:22,888] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":207}}
[2019-08-13 14:46:22,889] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(207)
[2019-08-13 14:46:22,889] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(207)
[2019-08-13 14:46:38,563] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:38,563] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:38,563] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":208,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":38}}}
[2019-08-13 14:46:38,563] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":208,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":38}}}
[2019-08-13 14:46:38,564] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 38).
[2019-08-13 14:46:38,564] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 38).
[2019-08-13 14:46:38,565] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:38,565] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:38,565] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:38,565] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:38,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:38,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:38,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":208}}
[2019-08-13 14:46:38,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":208}}
[2019-08-13 14:46:38,773] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(208)
[2019-08-13 14:46:38,773] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(208)
[2019-08-13 14:46:40,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:40,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:40,742] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":209,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 14:46:40,742] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":209,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 14:46:40,743] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 38).
[2019-08-13 14:46:40,743] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 38).
[2019-08-13 14:46:40,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:40,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:40,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:40,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:40,791] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:40,791] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:40,792] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":209}}
[2019-08-13 14:46:40,792] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":209}}
[2019-08-13 14:46:40,793] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(209)
[2019-08-13 14:46:40,793] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(209)
[2019-08-13 14:46:40,943] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:40,943] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:40,943] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":210,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":41}}}
[2019-08-13 14:46:40,943] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":210,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":41}}}
[2019-08-13 14:46:40,944] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 41).
[2019-08-13 14:46:40,944] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 41).
[2019-08-13 14:46:40,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:40,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:40,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:40,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:40,990] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:40,990] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:40,991] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":210}}
[2019-08-13 14:46:40,991] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":210}}
[2019-08-13 14:46:40,992] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(210)
[2019-08-13 14:46:40,992] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(210)
[2019-08-13 14:46:42,141] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:42,141] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:42,141] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":211,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":55}}}
[2019-08-13 14:46:42,141] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":211,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":55}}}
[2019-08-13 14:46:42,142] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 55).
[2019-08-13 14:46:42,142] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 55).
[2019-08-13 14:46:42,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:42,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:42,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:42,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:42,191] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:42,191] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:42,192] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":211}}
[2019-08-13 14:46:42,192] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":211}}
[2019-08-13 14:46:42,193] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(211)
[2019-08-13 14:46:42,193] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(211)
[2019-08-13 14:46:43,680] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:43,680] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:43,680] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":212,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":22}}}
[2019-08-13 14:46:43,680] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":212,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":22}}}
[2019-08-13 14:46:43,681] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 22).
[2019-08-13 14:46:43,681] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 22).
[2019-08-13 14:46:43,682] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:43,682] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:43,682] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:43,682] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:43,729] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:43,729] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:43,729] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":212}}
[2019-08-13 14:46:43,729] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":212}}
[2019-08-13 14:46:43,731] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(212)
[2019-08-13 14:46:43,731] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(212)
[2019-08-13 14:46:43,880] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:43,880] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:43,880] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":213,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 14:46:43,880] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":213,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 14:46:43,881] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 14:46:43,881] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 14:46:43,881] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:43,881] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:43,881] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:43,881] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:43,929] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:43,929] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:43,930] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":213}}
[2019-08-13 14:46:43,930] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":213}}
[2019-08-13 14:46:43,931] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(213)
[2019-08-13 14:46:43,931] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(213)
[2019-08-13 14:46:44,080] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:44,080] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:46:44,080] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":214,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 14:46:44,080] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":214,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 14:46:44,081] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 14:46:44,081] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 14:46:44,082] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:44,082] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:44,082] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:46:44,082] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:46:44,230] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:44,230] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:46:44,230] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":214}}
[2019-08-13 14:46:44,230] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":214}}
[2019-08-13 14:46:44,232] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(214)
[2019-08-13 14:46:44,232] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(214)
[2019-08-13 14:53:36,281] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:36,281] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:36,281] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":215,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":41}}}
[2019-08-13 14:53:36,281] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":215,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":41}}}
[2019-08-13 14:53:36,281] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 41).
[2019-08-13 14:53:36,281] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 41).
[2019-08-13 14:53:36,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:36,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:36,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:36,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:36,373] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:36,373] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:36,373] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":215}}
[2019-08-13 14:53:36,373] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":215}}
[2019-08-13 14:53:36,374] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(215)
[2019-08-13 14:53:36,374] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(215)
[2019-08-13 14:53:47,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:47,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:47,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":216,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":31}}}
[2019-08-13 14:53:47,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":216,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":31}}}
[2019-08-13 14:53:47,208] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 31).
[2019-08-13 14:53:47,208] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 31).
[2019-08-13 14:53:47,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:47,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:47,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:47,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:47,262] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:47,262] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:47,263] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":216}}
[2019-08-13 14:53:47,263] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":216}}
[2019-08-13 14:53:47,264] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(216)
[2019-08-13 14:53:47,264] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(216)
[2019-08-13 14:53:57,034] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:57,034] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:57,035] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":217,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":62}}}
[2019-08-13 14:53:57,035] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":217,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":62}}}
[2019-08-13 14:53:57,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 62).
[2019-08-13 14:53:57,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 62).
[2019-08-13 14:53:57,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:57,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:57,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:57,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:57,145] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:57,145] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:57,145] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":217}}
[2019-08-13 14:53:57,145] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":217}}
[2019-08-13 14:53:57,146] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(217)
[2019-08-13 14:53:57,146] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(217)
[2019-08-13 14:53:58,539] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:58,539] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:58,540] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":218,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":17}}}
[2019-08-13 14:53:58,540] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":218,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":17}}}
[2019-08-13 14:53:58,540] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 17).
[2019-08-13 14:53:58,540] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 17).
[2019-08-13 14:53:58,541] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:58,541] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:58,541] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:58,541] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:58,774] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:58,774] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:58,775] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":218}}
[2019-08-13 14:53:58,775] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":218}}
[2019-08-13 14:53:58,776] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(218)
[2019-08-13 14:53:58,776] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(218)
[2019-08-13 14:53:59,231] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:59,231] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:59,231] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":219,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":27}}}
[2019-08-13 14:53:59,231] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":219,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":27}}}
[2019-08-13 14:53:59,232] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 27).
[2019-08-13 14:53:59,232] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 27).
[2019-08-13 14:53:59,233] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:59,233] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:59,233] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:59,233] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:59,582] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:59,582] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:53:59,583] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":219}}
[2019-08-13 14:53:59,583] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":219}}
[2019-08-13 14:53:59,584] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(219)
[2019-08-13 14:53:59,584] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(219)
[2019-08-13 14:53:59,834] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:59,834] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:53:59,835] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":220,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":25}}}
[2019-08-13 14:53:59,835] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":220,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":25}}}
[2019-08-13 14:53:59,836] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 25).
[2019-08-13 14:53:59,836] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 25).
[2019-08-13 14:53:59,836] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:53:59,836] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:59,836] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:53:59,836] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:01,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:01,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:01,162] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":220}}
[2019-08-13 14:54:01,162] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":220}}
[2019-08-13 14:54:01,162] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(220)
[2019-08-13 14:54:01,162] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(220)
[2019-08-13 14:54:02,199] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:02,199] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:02,199] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":221,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":25}}}
[2019-08-13 14:54:02,199] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":221,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":25}}}
[2019-08-13 14:54:02,200] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 25).
[2019-08-13 14:54:02,200] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 25).
[2019-08-13 14:54:02,201] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:02,201] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:02,201] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:02,201] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:12,093] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:12,093] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:12,094] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":221}}
[2019-08-13 14:54:12,094] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":221}}
[2019-08-13 14:54:12,095] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(221)
[2019-08-13 14:54:12,095] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(221)
[2019-08-13 14:54:13,527] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:13,527] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:13,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":222,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":17}}}
[2019-08-13 14:54:13,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":222,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":17}}}
[2019-08-13 14:54:13,528] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 17).
[2019-08-13 14:54:13,528] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 17).
[2019-08-13 14:54:13,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:13,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:13,529] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:13,529] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:13,676] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:13,676] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:13,676] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":222}}
[2019-08-13 14:54:13,676] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":222}}
[2019-08-13 14:54:13,678] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(222)
[2019-08-13 14:54:13,678] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(222)
[2019-08-13 14:54:20,001] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:20,001] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:20,001] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":223,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":49}}}
[2019-08-13 14:54:20,001] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":223,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":49}}}
[2019-08-13 14:54:20,002] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 49).
[2019-08-13 14:54:20,002] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 49).
[2019-08-13 14:54:20,003] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:20,003] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:20,003] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:20,003] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:20,104] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:20,104] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:20,105] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":223}}
[2019-08-13 14:54:20,105] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":223}}
[2019-08-13 14:54:20,105] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(223)
[2019-08-13 14:54:20,105] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(223)
[2019-08-13 14:54:23,051] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2926
[2019-08-13 14:54:23,051] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2926
[2019-08-13 14:54:23,052] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":6},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:54:23,052] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":6},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"data.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:54:23,055] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:54:23,055] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:54:23,056] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:23,056] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:23,056] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":224,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":58}}}
[2019-08-13 14:54:23,056] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":224,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":58}}}
[2019-08-13 14:54:23,057] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 58).
[2019-08-13 14:54:23,057] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 58).
[2019-08-13 14:54:23,057] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:23,057] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:23,058] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:23,058] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:23,093] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:23,093] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:23,093] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":224}}
[2019-08-13 14:54:23,093] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":224}}
[2019-08-13 14:54:23,094] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(224)
[2019-08-13 14:54:23,094] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(224)
[2019-08-13 14:54:23,229] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:54:23,229] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:54:23,229] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":225,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:54:23,229] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":225,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:54:23,230] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":225}
[2019-08-13 14:54:23,230] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":225}
[2019-08-13 14:54:23,230] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":225}
[2019-08-13 14:54:23,230] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":225}
[2019-08-13 14:54:25,115] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:25,115] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:25,116] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":226,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":42}}}
[2019-08-13 14:54:25,116] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":226,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":42}}}
[2019-08-13 14:54:25,117] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 42).
[2019-08-13 14:54:25,117] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 42).
[2019-08-13 14:54:25,117] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:25,117] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:25,117] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:25,117] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:25,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:25,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:25,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":226}}
[2019-08-13 14:54:25,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":226}}
[2019-08-13 14:54:25,181] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(226)
[2019-08-13 14:54:25,181] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(226)
[2019-08-13 14:54:25,417] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:25,417] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:25,417] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":227,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":43}}}
[2019-08-13 14:54:25,417] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":227,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":43}}}
[2019-08-13 14:54:25,418] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 43).
[2019-08-13 14:54:25,418] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 43).
[2019-08-13 14:54:25,418] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:25,418] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:25,418] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:25,418] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:26,318] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:26,318] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:26,318] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":227}}
[2019-08-13 14:54:26,318] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":227}}
[2019-08-13 14:54:26,319] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(227)
[2019-08-13 14:54:26,319] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(227)
[2019-08-13 14:54:26,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:26,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:26,968] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":228,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":38}}}
[2019-08-13 14:54:26,968] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":228,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":38}}}
[2019-08-13 14:54:26,969] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 38).
[2019-08-13 14:54:26,969] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 38).
[2019-08-13 14:54:26,969] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:26,969] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:26,969] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:26,969] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:28,699] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:28,699] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:28,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":228}}
[2019-08-13 14:54:28,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":228}}
[2019-08-13 14:54:28,700] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(228)
[2019-08-13 14:54:28,700] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(228)
[2019-08-13 14:54:30,778] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2934
[2019-08-13 14:54:30,778] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2934
[2019-08-13 14:54:30,779] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":7},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:54:30,779] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":7},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.signals\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:54:30,780] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:54:30,780] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:54:30,780] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:30,780] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:30,781] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":229,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":42}}}
[2019-08-13 14:54:30,781] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":229,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":42}}}
[2019-08-13 14:54:30,781] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 42).
[2019-08-13 14:54:30,781] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 42).
[2019-08-13 14:54:30,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:30,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:30,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:30,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:30,932] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:30,932] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:30,933] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":229}}
[2019-08-13 14:54:30,933] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":229}}
[2019-08-13 14:54:30,934] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(229)
[2019-08-13 14:54:30,934] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(229)
[2019-08-13 14:54:30,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:54:30,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:54:30,968] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":230,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:54:30,968] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":230,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:54:30,970] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":230}
[2019-08-13 14:54:30,970] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":230}
[2019-08-13 14:54:30,970] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":230}
[2019-08-13 14:54:30,970] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":230}
[2019-08-13 14:54:57,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:57,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:57,526] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":231,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":53}}}
[2019-08-13 14:54:57,526] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":231,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":53}}}
[2019-08-13 14:54:57,527] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 53).
[2019-08-13 14:54:57,527] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 53).
[2019-08-13 14:54:57,527] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:57,527] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:57,527] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:57,527] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:57,775] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:57,775] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:57,776] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":231}}
[2019-08-13 14:54:57,776] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":231}}
[2019-08-13 14:54:57,777] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(231)
[2019-08-13 14:54:57,777] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(231)
[2019-08-13 14:54:57,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:57,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:57,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":232,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":53}}}
[2019-08-13 14:54:57,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":232,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":53}}}
[2019-08-13 14:54:57,928] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 53).
[2019-08-13 14:54:57,928] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 53).
[2019-08-13 14:54:57,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:57,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:57,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:57,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:58,118] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:58,118] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:58,119] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":232}}
[2019-08-13 14:54:58,119] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":232}}
[2019-08-13 14:54:58,120] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(232)
[2019-08-13 14:54:58,120] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(232)
[2019-08-13 14:54:58,269] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:58,269] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:58,270] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":233,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":54}}}
[2019-08-13 14:54:58,270] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":233,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":54}}}
[2019-08-13 14:54:58,270] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 54).
[2019-08-13 14:54:58,270] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 54).
[2019-08-13 14:54:58,271] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:58,271] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:58,271] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:58,271] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:58,319] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:58,319] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:58,320] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":233}}
[2019-08-13 14:54:58,320] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":233}}
[2019-08-13 14:54:58,321] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(233)
[2019-08-13 14:54:58,321] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(233)
[2019-08-13 14:54:58,470] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:58,470] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:58,470] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":234,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":55}}}
[2019-08-13 14:54:58,470] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":234,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":55}}}
[2019-08-13 14:54:58,471] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 55).
[2019-08-13 14:54:58,471] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 55).
[2019-08-13 14:54:58,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:58,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:58,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:58,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:59,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:59,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:59,280] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":234}}
[2019-08-13 14:54:59,280] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":234}}
[2019-08-13 14:54:59,281] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(234)
[2019-08-13 14:54:59,281] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(234)
[2019-08-13 14:54:59,421] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:59,421] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:59,421] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":235,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":54}}}
[2019-08-13 14:54:59,421] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":235,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":54}}}
[2019-08-13 14:54:59,422] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 54).
[2019-08-13 14:54:59,422] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 54).
[2019-08-13 14:54:59,422] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:59,422] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:59,423] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:59,423] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:59,589] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:59,589] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:59,589] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":235}}
[2019-08-13 14:54:59,589] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":235}}
[2019-08-13 14:54:59,590] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(235)
[2019-08-13 14:54:59,590] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(235)
[2019-08-13 14:54:59,740] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:59,740] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:54:59,740] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":236,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":53}}}
[2019-08-13 14:54:59,740] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":236,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":53}}}
[2019-08-13 14:54:59,741] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 53).
[2019-08-13 14:54:59,741] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 53).
[2019-08-13 14:54:59,741] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:59,741] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:54:59,741] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:59,741] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:54:59,905] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:59,905] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:54:59,905] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":236}}
[2019-08-13 14:54:59,905] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":236}}
[2019-08-13 14:54:59,906] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(236)
[2019-08-13 14:54:59,906] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(236)
[2019-08-13 14:55:06,064] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:55:06,064] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:55:06,064] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":237,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":50}}}
[2019-08-13 14:55:06,064] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":237,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":50}}}
[2019-08-13 14:55:06,065] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 50).
[2019-08-13 14:55:06,065] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 50).
[2019-08-13 14:55:06,066] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:55:06,066] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:55:06,066] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:55:06,066] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:55:06,198] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:55:06,198] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:55:06,198] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":237}}
[2019-08-13 14:55:06,198] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":237}}
[2019-08-13 14:55:06,199] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(237)
[2019-08-13 14:55:06,199] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(237)
[2019-08-13 14:55:09,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2934
[2019-08-13 14:55:09,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2934
[2019-08-13 14:55:09,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":8},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:55:09,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":8},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"network_signals\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:55:09,929] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:55:09,929] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:55:10,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:55:10,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:55:10,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":238,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:55:10,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":238,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:55:10,074] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":238}
[2019-08-13 14:55:10,074] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":238}
[2019-08-13 14:55:10,075] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":238}
[2019-08-13 14:55:10,075] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":238}
[2019-08-13 14:55:21,135] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:55:21,135] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:55:21,135] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":239,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":1}}}
[2019-08-13 14:55:21,135] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":239,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":1}}}
[2019-08-13 14:55:21,136] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 1).
[2019-08-13 14:55:21,136] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 1).
[2019-08-13 14:55:21,136] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:55:21,136] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:55:21,137] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:55:21,137] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:55:21,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:55:21,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:55:21,706] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":239}}
[2019-08-13 14:55:21,706] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":239}}
[2019-08-13 14:55:21,707] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(239)
[2019-08-13 14:55:21,707] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(239)
[2019-08-13 14:56:54,460] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:54,460] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:54,460] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":240,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":21}}}
[2019-08-13 14:56:54,460] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":240,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":21}}}
[2019-08-13 14:56:54,462] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 21).
[2019-08-13 14:56:54,462] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 21).
[2019-08-13 14:56:54,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:54,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:54,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:54,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:54,511] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:54,511] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:54,512] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":240}}
[2019-08-13 14:56:54,512] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":240}}
[2019-08-13 14:56:54,513] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(240)
[2019-08-13 14:56:54,513] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(240)
[2019-08-13 14:56:54,763] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:54,763] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:54,763] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":241,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":23}}}
[2019-08-13 14:56:54,763] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":241,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":23}}}
[2019-08-13 14:56:54,764] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 23).
[2019-08-13 14:56:54,764] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 23).
[2019-08-13 14:56:54,764] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:54,764] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:54,764] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:54,764] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:54,949] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:54,949] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:54,950] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":241}}
[2019-08-13 14:56:54,950] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":241}}
[2019-08-13 14:56:54,951] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(241)
[2019-08-13 14:56:54,951] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(241)
[2019-08-13 14:56:55,600] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:55,600] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:55,601] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":242,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":31}}}
[2019-08-13 14:56:55,601] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":242,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":31}}}
[2019-08-13 14:56:55,601] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 31).
[2019-08-13 14:56:55,601] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 31).
[2019-08-13 14:56:55,602] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:55,602] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:55,602] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:55,602] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:55,649] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:55,649] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:55,650] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":242}}
[2019-08-13 14:56:55,650] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":242}}
[2019-08-13 14:56:55,651] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(242)
[2019-08-13 14:56:55,651] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(242)
[2019-08-13 14:56:58,775] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:58,775] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:56:58,775] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":243,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":27}}}
[2019-08-13 14:56:58,775] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":243,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":27}}}
[2019-08-13 14:56:58,776] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 27).
[2019-08-13 14:56:58,776] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 27).
[2019-08-13 14:56:58,777] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:58,777] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:56:58,777] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:58,777] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:56:58,825] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:58,825] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:56:58,825] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":243}}
[2019-08-13 14:56:58,825] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":243}}
[2019-08-13 14:56:58,826] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(243)
[2019-08-13 14:56:58,826] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(243)
[2019-08-13 14:57:03,228] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:03,228] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:03,228] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":244,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":51}}}
[2019-08-13 14:57:03,228] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":244,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":51}}}
[2019-08-13 14:57:03,229] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 51).
[2019-08-13 14:57:03,229] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 51).
[2019-08-13 14:57:03,230] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:03,230] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:03,230] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:03,230] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:03,380] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:03,380] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:03,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":244}}
[2019-08-13 14:57:03,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":244}}
[2019-08-13 14:57:03,382] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(244)
[2019-08-13 14:57:03,382] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(244)
[2019-08-13 14:57:06,674] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:06,674] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:06,674] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":245,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":42}}}
[2019-08-13 14:57:06,674] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":245,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":42}}}
[2019-08-13 14:57:06,675] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 42).
[2019-08-13 14:57:06,675] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 42).
[2019-08-13 14:57:06,675] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:06,675] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:06,676] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:06,676] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:07,010] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:07,010] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:07,010] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":245}}
[2019-08-13 14:57:07,010] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":245}}
[2019-08-13 14:57:07,012] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(245)
[2019-08-13 14:57:07,012] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(245)
[2019-08-13 14:57:07,706] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:07,706] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:07,707] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":246,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":45}}}
[2019-08-13 14:57:07,707] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":246,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":45}}}
[2019-08-13 14:57:07,707] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:07,707] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:07,708] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 45).
[2019-08-13 14:57:07,708] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":246}}
[2019-08-13 14:57:07,708] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 45).
[2019-08-13 14:57:07,708] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":246}}
[2019-08-13 14:57:07,708] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:07,708] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:07,708] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:07,708] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:07,709] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(246)
[2019-08-13 14:57:07,709] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(246)
[2019-08-13 14:57:12,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:12,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:12,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":247,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":30}}}
[2019-08-13 14:57:12,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":247,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":30}}}
[2019-08-13 14:57:12,181] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 30).
[2019-08-13 14:57:12,181] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 30).
[2019-08-13 14:57:12,181] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:12,181] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:12,181] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:12,181] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:12,183] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:12,183] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:12,184] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":247}}
[2019-08-13 14:57:12,184] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":247}}
[2019-08-13 14:57:12,185] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(247)
[2019-08-13 14:57:12,185] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(247)
[2019-08-13 14:57:15,324] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2920
[2019-08-13 14:57:15,324] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2920
[2019-08-13 14:57:15,325] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":9},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"p\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:15,325] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":9},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"p\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:15,327] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:15,327] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:15,548] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2922
[2019-08-13 14:57:15,548] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2922
[2019-08-13 14:57:15,548] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":10},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"pa\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:15,548] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":10},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"pa\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:15,551] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:15,551] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:15,763] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2923
[2019-08-13 14:57:15,763] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2923
[2019-08-13 14:57:15,764] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":11},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"pat\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:15,764] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":11},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"pat\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:15,765] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:15,765] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:16,538] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2927
[2019-08-13 14:57:16,538] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2927
[2019-08-13 14:57:16,539] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":15},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patient\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:16,539] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":15},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patient\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:16,540] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:16,540] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:16,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:16,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:16,660] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":248,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:16,660] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":248,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:16,661] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":248}
[2019-08-13 14:57:16,661] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":248}
[2019-08-13 14:57:16,661] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":248}
[2019-08-13 14:57:16,661] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":248}
[2019-08-13 14:57:19,263] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:19,263] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:19,263] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":249,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":32}}}
[2019-08-13 14:57:19,263] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":249,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":32}}}
[2019-08-13 14:57:19,263] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 32).
[2019-08-13 14:57:19,263] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 32).
[2019-08-13 14:57:19,264] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:19,264] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:19,264] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:19,264] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:19,304] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:19,304] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:19,304] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":249}}
[2019-08-13 14:57:19,304] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":249}}
[2019-08-13 14:57:19,305] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(249)
[2019-08-13 14:57:19,305] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(249)
[2019-08-13 14:57:21,700] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:21,700] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:21,701] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":250,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":49}}}
[2019-08-13 14:57:21,701] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":250,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":49}}}
[2019-08-13 14:57:21,702] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 49).
[2019-08-13 14:57:21,702] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 49).
[2019-08-13 14:57:21,702] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:21,702] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:21,702] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:21,702] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:21,851] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:21,851] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:21,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":250}}
[2019-08-13 14:57:21,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":250}}
[2019-08-13 14:57:21,853] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(250)
[2019-08-13 14:57:21,853] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(250)
[2019-08-13 14:57:22,003] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:22,003] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:22,003] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":251,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":51}}}
[2019-08-13 14:57:22,003] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":251,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":51}}}
[2019-08-13 14:57:22,004] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 51).
[2019-08-13 14:57:22,004] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 51).
[2019-08-13 14:57:22,005] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:22,005] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:22,005] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:22,005] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:22,052] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:22,052] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:22,053] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":251}}
[2019-08-13 14:57:22,053] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":251}}
[2019-08-13 14:57:22,054] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(251)
[2019-08-13 14:57:22,054] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(251)
[2019-08-13 14:57:22,204] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:22,204] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:22,205] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":252,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":52}}}
[2019-08-13 14:57:22,205] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":252,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":52}}}
[2019-08-13 14:57:22,206] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 52).
[2019-08-13 14:57:22,206] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 52).
[2019-08-13 14:57:22,206] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:22,206] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:22,206] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:22,206] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:22,253] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:22,253] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:22,253] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":252}}
[2019-08-13 14:57:22,253] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":252}}
[2019-08-13 14:57:22,254] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(252)
[2019-08-13 14:57:22,254] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(252)
[2019-08-13 14:57:23,342] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:23,342] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:23,342] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":253,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":36}}}
[2019-08-13 14:57:23,342] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":253,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":36}}}
[2019-08-13 14:57:23,343] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 36).
[2019-08-13 14:57:23,343] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 36).
[2019-08-13 14:57:23,343] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:23,343] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:23,343] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:23,343] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:23,546] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:23,546] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:23,546] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":253}}
[2019-08-13 14:57:23,546] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":253}}
[2019-08-13 14:57:23,547] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(253)
[2019-08-13 14:57:23,547] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(253)
[2019-08-13 14:57:25,173] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2928
[2019-08-13 14:57:25,173] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2928
[2019-08-13 14:57:25,173] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":16},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:25,173] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":16},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM network_signals) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:25,176] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:25,176] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:25,290] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:25,290] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:25,290] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":254,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:25,290] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":254,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:25,291] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":254}
[2019-08-13 14:57:25,291] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":254}
[2019-08-13 14:57:25,291] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":254}
[2019-08-13 14:57:25,291] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":254}
[2019-08-13 14:57:25,451] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:25,451] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:25,451] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":255,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":32}}}
[2019-08-13 14:57:25,451] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":255,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":32}}}
[2019-08-13 14:57:25,452] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 32).
[2019-08-13 14:57:25,452] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 32).
[2019-08-13 14:57:25,452] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:25,452] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:25,453] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:25,453] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:25,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:25,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:25,502] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":255}}
[2019-08-13 14:57:25,502] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":255}}
[2019-08-13 14:57:25,503] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(255)
[2019-08-13 14:57:25,503] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(255)
[2019-08-13 14:57:33,815] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 14:57:33,815] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 14:57:33,816] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":17},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:33,816] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":17},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(data.signals) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:33,817] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:33,817] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:33,934] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:33,934] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:33,934] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":256,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:33,934] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":256,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:33,936] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":256}
[2019-08-13 14:57:33,936] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":256}
[2019-08-13 14:57:33,936] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":256}
[2019-08-13 14:57:33,936] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":256}
[2019-08-13 14:57:34,943] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:57:34,943] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:57:34,943] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":257,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":68,"character":8}}}
[2019-08-13 14:57:34,943] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":257,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":68,"character":8}}}
[2019-08-13 14:57:34,944] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (68, 8).
[2019-08-13 14:57:34,944] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (68, 8).
[2019-08-13 14:57:34,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:34,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:34,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:34,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:35,010] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:35,010] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:35,010] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":257}}
[2019-08-13 14:57:35,010] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":257}}
[2019-08-13 14:57:35,011] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(257)
[2019-08-13 14:57:35,011] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(257)
[2019-08-13 14:57:35,246] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:35,246] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:35,246] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":258,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":13}}}
[2019-08-13 14:57:35,246] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":258,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":13}}}
[2019-08-13 14:57:35,247] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 13).
[2019-08-13 14:57:35,247] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 13).
[2019-08-13 14:57:35,248] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:35,248] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:35,248] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:35,248] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:35,294] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:35,294] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:35,294] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":258}}
[2019-08-13 14:57:35,294] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":258}}
[2019-08-13 14:57:35,296] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(258)
[2019-08-13 14:57:35,296] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(258)
[2019-08-13 14:57:41,298] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:41,298] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:41,299] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":259,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":26}}}
[2019-08-13 14:57:41,299] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":259,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":26}}}
[2019-08-13 14:57:41,299] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 26).
[2019-08-13 14:57:41,299] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 26).
[2019-08-13 14:57:41,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:41,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:41,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:41,300] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:41,587] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:41,587] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:41,587] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":259}}
[2019-08-13 14:57:41,587] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":259}}
[2019-08-13 14:57:41,589] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(259)
[2019-08-13 14:57:41,589] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(259)
[2019-08-13 14:57:41,738] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:41,738] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:41,738] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":260,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":24}}}
[2019-08-13 14:57:41,738] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":260,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":24}}}
[2019-08-13 14:57:41,739] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 24).
[2019-08-13 14:57:41,739] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 24).
[2019-08-13 14:57:41,740] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:41,740] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:41,740] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:41,740] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:41,885] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:41,885] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:41,886] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":260}}
[2019-08-13 14:57:41,886] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":260}}
[2019-08-13 14:57:41,887] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(260)
[2019-08-13 14:57:41,887] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(260)
[2019-08-13 14:57:43,539] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:43,539] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:43,539] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":261,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":45}}}
[2019-08-13 14:57:43,539] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":261,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":45}}}
[2019-08-13 14:57:43,540] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 45).
[2019-08-13 14:57:43,540] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 45).
[2019-08-13 14:57:43,540] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:43,540] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:43,540] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:43,540] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:43,592] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:43,592] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:43,592] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":261}}
[2019-08-13 14:57:43,592] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":261}}
[2019-08-13 14:57:43,593] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(261)
[2019-08-13 14:57:43,593] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(261)
[2019-08-13 14:57:43,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:43,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:43,742] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":262,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":44}}}
[2019-08-13 14:57:43,742] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":262,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":44}}}
[2019-08-13 14:57:43,743] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 44).
[2019-08-13 14:57:43,743] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 44).
[2019-08-13 14:57:43,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:43,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:43,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:43,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:44,059] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:44,059] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:44,059] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":262}}
[2019-08-13 14:57:44,059] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":262}}
[2019-08-13 14:57:44,060] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(262)
[2019-08-13 14:57:44,060] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(262)
[2019-08-13 14:57:44,210] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:44,210] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:44,211] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":263,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":37}}}
[2019-08-13 14:57:44,211] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":263,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":37}}}
[2019-08-13 14:57:44,211] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 37).
[2019-08-13 14:57:44,211] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 37).
[2019-08-13 14:57:44,212] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:44,212] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:44,212] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:44,212] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:44,259] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:44,259] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:44,259] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":263}}
[2019-08-13 14:57:44,259] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":263}}
[2019-08-13 14:57:44,260] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(263)
[2019-08-13 14:57:44,260] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(263)
[2019-08-13 14:57:44,413] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:44,413] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:44,414] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":264,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":36}}}
[2019-08-13 14:57:44,414] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":264,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":36}}}
[2019-08-13 14:57:44,414] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 36).
[2019-08-13 14:57:44,414] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 36).
[2019-08-13 14:57:44,415] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:44,415] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:44,415] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:44,415] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:44,573] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:44,573] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:44,573] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":264}}
[2019-08-13 14:57:44,573] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":264}}
[2019-08-13 14:57:44,574] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(264)
[2019-08-13 14:57:44,574] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(264)
[2019-08-13 14:57:46,494] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:57:46,494] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 63
[2019-08-13 14:57:46,494] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":37}}
[2019-08-13 14:57:46,494] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":37}}
[2019-08-13 14:57:46,495] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(37)
[2019-08-13 14:57:46,495] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(37)
[2019-08-13 14:57:46,495] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:57:46,495] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:57:46,495] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":265,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":41}}}
[2019-08-13 14:57:46,495] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":265,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":41}}}
[2019-08-13 14:57:46,495] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 41).
[2019-08-13 14:57:46,495] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 41).
[2019-08-13 14:57:46,495] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:57:46,495] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:57:46,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:46,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:46,694] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":265}}
[2019-08-13 14:57:46,694] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":265}}
[2019-08-13 14:57:46,694] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(265)
[2019-08-13 14:57:46,694] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(265)
[2019-08-13 14:57:46,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:57:46,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:57:46,695] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":266,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":38}}}
[2019-08-13 14:57:46,695] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":266,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":38}}}
[2019-08-13 14:57:46,695] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (67, 38).
[2019-08-13 14:57:46,695] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (67, 38).
[2019-08-13 14:57:46,695] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:57:46,695] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:57:46,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:46,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:46,794] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":266}}
[2019-08-13 14:57:46,794] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":266}}
[2019-08-13 14:57:46,795] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(266)
[2019-08-13 14:57:46,795] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(266)
[2019-08-13 14:57:46,795] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:57:46,795] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 14:57:46,795] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":267,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":32}}}
[2019-08-13 14:57:46,795] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":267,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":32}}}
[2019-08-13 14:57:46,795] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (67, 32).
[2019-08-13 14:57:46,795] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (67, 32).
[2019-08-13 14:57:46,795] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:57:46,795] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 14:57:47,767] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:47,767] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:47,767] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":268,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":23}}}
[2019-08-13 14:57:47,767] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":268,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":23}}}
[2019-08-13 14:57:47,767] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 23).
[2019-08-13 14:57:47,767] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 23).
[2019-08-13 14:57:47,767] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:47,767] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:47,767] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:47,767] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:47,816] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:47,816] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:47,816] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":268}}
[2019-08-13 14:57:47,816] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":268}}
[2019-08-13 14:57:47,817] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(268)
[2019-08-13 14:57:47,817] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(268)
[2019-08-13 14:57:48,067] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:48,067] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:48,067] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":269,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":22}}}
[2019-08-13 14:57:48,067] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":269,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":22}}}
[2019-08-13 14:57:48,067] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 22).
[2019-08-13 14:57:48,067] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 22).
[2019-08-13 14:57:48,068] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:48,068] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:48,068] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:48,068] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:48,086] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:48,086] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:48,086] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":269}}
[2019-08-13 14:57:48,086] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":269}}
[2019-08-13 14:57:48,087] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(269)
[2019-08-13 14:57:48,087] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(269)
[2019-08-13 14:57:48,641] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:48,641] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:48,641] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":270,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":24}}}
[2019-08-13 14:57:48,641] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":270,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":24}}}
[2019-08-13 14:57:48,641] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 24).
[2019-08-13 14:57:48,641] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 24).
[2019-08-13 14:57:48,642] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:48,642] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:48,642] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:48,642] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:48,690] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:48,690] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:48,690] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":270}}
[2019-08-13 14:57:48,690] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":270}}
[2019-08-13 14:57:48,690] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(270)
[2019-08-13 14:57:48,690] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(270)
[2019-08-13 14:57:49,340] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:49,340] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:49,340] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":271,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":34}}}
[2019-08-13 14:57:49,340] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":271,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":34}}}
[2019-08-13 14:57:49,340] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 34).
[2019-08-13 14:57:49,340] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 34).
[2019-08-13 14:57:49,340] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:49,340] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:49,340] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:49,340] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:49,420] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:49,420] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:49,420] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":271}}
[2019-08-13 14:57:49,420] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":271}}
[2019-08-13 14:57:49,421] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(271)
[2019-08-13 14:57:49,421] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(271)
[2019-08-13 14:57:49,671] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:49,671] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:49,671] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":272,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":33}}}
[2019-08-13 14:57:49,671] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":272,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":33}}}
[2019-08-13 14:57:49,671] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 33).
[2019-08-13 14:57:49,671] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 33).
[2019-08-13 14:57:49,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:49,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:49,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:49,671] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:49,946] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:49,946] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:49,946] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":272}}
[2019-08-13 14:57:49,946] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":272}}
[2019-08-13 14:57:49,947] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(272)
[2019-08-13 14:57:49,947] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(272)
[2019-08-13 14:57:50,304] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:50,304] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:50,304] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":273,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":34}}}
[2019-08-13 14:57:50,304] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":273,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":34}}}
[2019-08-13 14:57:50,305] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 34).
[2019-08-13 14:57:50,305] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 34).
[2019-08-13 14:57:50,305] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:50,305] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:50,305] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:50,305] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:50,354] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:50,354] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:50,354] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":273}}
[2019-08-13 14:57:50,354] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":273}}
[2019-08-13 14:57:50,354] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(273)
[2019-08-13 14:57:50,354] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(273)
[2019-08-13 14:57:51,031] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2929
[2019-08-13 14:57:51,031] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2929
[2019-08-13 14:57:51,031] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":18},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:51,031] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":18},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 14:57:51,032] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:51,032] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 14:57:51,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:51,180] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 14:57:51,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":274,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:51,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":274,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 14:57:51,180] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":274}
[2019-08-13 14:57:51,180] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":274}
[2019-08-13 14:57:51,180] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":274}
[2019-08-13 14:57:51,180] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":274}
[2019-08-13 14:57:54,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:57:54,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 14:57:54,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":275,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":69,"character":1}}}
[2019-08-13 14:57:54,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":275,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":69,"character":1}}}
[2019-08-13 14:57:54,629] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (69, 1).
[2019-08-13 14:57:54,629] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (69, 1).
[2019-08-13 14:57:54,629] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:54,629] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:54,629] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:54,629] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:54,675] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:54,675] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:54,675] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":275}}
[2019-08-13 14:57:54,675] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":275}}
[2019-08-13 14:57:54,676] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(275)
[2019-08-13 14:57:54,676] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(275)
[2019-08-13 14:57:55,226] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:55,226] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:55,227] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":276,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":70,"character":15}}}
[2019-08-13 14:57:55,227] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":276,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":70,"character":15}}}
[2019-08-13 14:57:55,227] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (70, 15).
[2019-08-13 14:57:55,227] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (70, 15).
[2019-08-13 14:57:55,227] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:55,227] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:55,227] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:55,227] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:56,159] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:56,159] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:56,159] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":276}}
[2019-08-13 14:57:56,159] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":276}}
[2019-08-13 14:57:56,160] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(276)
[2019-08-13 14:57:56,160] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(276)
[2019-08-13 14:57:56,411] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:56,411] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:56,411] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":277,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":70,"character":14}}}
[2019-08-13 14:57:56,411] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":277,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":70,"character":14}}}
[2019-08-13 14:57:56,411] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (70, 14).
[2019-08-13 14:57:56,411] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (70, 14).
[2019-08-13 14:57:56,411] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:56,411] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:56,411] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:56,411] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:57,298] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:57,298] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:57,299] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":277}}
[2019-08-13 14:57:57,299] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":277}}
[2019-08-13 14:57:57,300] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(277)
[2019-08-13 14:57:57,300] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(277)
[2019-08-13 14:57:57,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:57,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:57,749] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":278,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":71,"character":12}}}
[2019-08-13 14:57:57,749] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":278,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":71,"character":12}}}
[2019-08-13 14:57:57,750] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (71, 12).
[2019-08-13 14:57:57,750] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (71, 12).
[2019-08-13 14:57:57,750] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:57,750] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:57,750] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:57,750] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:57,857] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:57,857] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:57,857] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":278}}
[2019-08-13 14:57:57,857] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":278}}
[2019-08-13 14:57:57,858] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(278)
[2019-08-13 14:57:57,858] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(278)
[2019-08-13 14:57:58,008] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:58,008] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:58,008] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":279,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":70,"character":12}}}
[2019-08-13 14:57:58,008] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":279,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":70,"character":12}}}
[2019-08-13 14:57:58,009] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (70, 12).
[2019-08-13 14:57:58,009] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (70, 12).
[2019-08-13 14:57:58,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:58,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:58,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:58,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:58,186] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:58,186] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:58,186] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":279}}
[2019-08-13 14:57:58,186] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":279}}
[2019-08-13 14:57:58,187] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(279)
[2019-08-13 14:57:58,187] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(279)
[2019-08-13 14:57:58,337] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:58,337] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 14:57:58,338] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":280,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":69,"character":13}}}
[2019-08-13 14:57:58,338] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":280,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":69,"character":13}}}
[2019-08-13 14:57:58,338] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (69, 13).
[2019-08-13 14:57:58,338] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (69, 13).
[2019-08-13 14:57:58,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:58,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 14:57:58,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:58,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 14:57:58,488] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:58,488] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 14:57:58,488] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":280}}
[2019-08-13 14:57:58,488] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":280}}
[2019-08-13 14:57:58,489] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(280)
[2019-08-13 14:57:58,489] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(280)
[2019-08-13 15:02:41,724] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:02:41,724] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:02:41,724] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":281,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":26}}}
[2019-08-13 15:02:41,724] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":281,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":26}}}
[2019-08-13 15:02:41,725] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 26).
[2019-08-13 15:02:41,725] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 26).
[2019-08-13 15:02:41,727] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:02:41,727] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:02:41,728] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:02:41,728] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:02:41,973] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:02:41,973] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:02:41,973] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":281}}
[2019-08-13 15:02:41,973] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":281}}
[2019-08-13 15:02:41,974] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(281)
[2019-08-13 15:02:41,974] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(281)
[2019-08-13 15:02:42,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:02:42,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:02:42,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":282,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":25}}}
[2019-08-13 15:02:42,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":282,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":25}}}
[2019-08-13 15:02:42,124] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 25).
[2019-08-13 15:02:42,124] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 25).
[2019-08-13 15:02:42,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:02:42,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:02:42,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:02:42,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:02:42,378] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:02:42,378] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:02:42,378] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":282}}
[2019-08-13 15:02:42,378] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":282}}
[2019-08-13 15:02:42,379] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(282)
[2019-08-13 15:02:42,379] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(282)
[2019-08-13 15:03:04,470] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:04,470] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:04,471] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":283,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":29}}}
[2019-08-13 15:03:04,471] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":283,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":29}}}
[2019-08-13 15:03:04,472] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 29).
[2019-08-13 15:03:04,472] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 29).
[2019-08-13 15:03:04,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:04,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:04,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:04,472] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:04,519] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:04,519] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:04,519] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":283}}
[2019-08-13 15:03:04,519] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":283}}
[2019-08-13 15:03:04,520] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(283)
[2019-08-13 15:03:04,520] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(283)
[2019-08-13 15:03:17,952] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:17,952] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:17,952] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":284,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:03:17,952] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":284,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:03:17,953] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 15:03:17,953] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 15:03:17,953] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:17,953] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:17,953] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:17,953] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:18,056] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:18,056] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:18,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":284}}
[2019-08-13 15:03:18,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":284}}
[2019-08-13 15:03:18,058] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(284)
[2019-08-13 15:03:18,058] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(284)
[2019-08-13 15:03:18,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:18,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:18,208] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":285,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:03:18,208] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":285,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:03:18,209] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 15:03:18,209] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 15:03:18,209] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:18,209] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:18,209] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:18,209] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:18,357] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:18,357] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:18,357] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":285}}
[2019-08-13 15:03:18,357] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":285}}
[2019-08-13 15:03:18,358] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(285)
[2019-08-13 15:03:18,358] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(285)
[2019-08-13 15:03:18,508] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:18,508] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:18,508] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":286,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:03:18,508] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":286,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:03:18,509] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 15:03:18,509] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 15:03:18,509] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:18,509] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:18,509] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:18,509] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:20,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:20,016] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:20,017] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":286}}
[2019-08-13 15:03:20,017] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":286}}
[2019-08-13 15:03:20,018] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(286)
[2019-08-13 15:03:20,018] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(286)
[2019-08-13 15:03:32,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:32,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:32,687] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":287,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":47}}}
[2019-08-13 15:03:32,687] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":287,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":47}}}
[2019-08-13 15:03:32,688] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 47).
[2019-08-13 15:03:32,688] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 47).
[2019-08-13 15:03:32,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:32,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:32,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:32,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:32,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:32,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:32,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":287}}
[2019-08-13 15:03:32,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":287}}
[2019-08-13 15:03:32,738] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(287)
[2019-08-13 15:03:32,738] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(287)
[2019-08-13 15:03:34,695] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:34,695] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:03:34,695] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":288,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":71}}}
[2019-08-13 15:03:34,695] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":288,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":71}}}
[2019-08-13 15:03:34,696] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 71).
[2019-08-13 15:03:34,696] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 71).
[2019-08-13 15:03:34,696] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:34,696] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:03:34,696] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:34,696] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:03:35,176] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:35,176] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:03:35,176] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":288}}
[2019-08-13 15:03:35,176] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":288}}
[2019-08-13 15:03:35,177] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(288)
[2019-08-13 15:03:35,177] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(288)
[2019-08-13 15:05:11,220] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2929
[2019-08-13 15:05:11,220] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2929
[2019-08-13 15:05:11,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":18},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:11,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":18},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.networkType AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:11,223] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:11,223] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:11,223] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 15:05:11,223] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 15:05:11,224] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":18}}}
[2019-08-13 15:05:11,224] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":18}}}
[2019-08-13 15:05:11,225] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala)
[2019-08-13 15:05:11,225] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala)
[2019-08-13 15:05:13,210] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:13,210] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:13,210] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":289,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":28}}}
[2019-08-13 15:05:13,210] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":289,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":28}}}
[2019-08-13 15:05:13,211] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 28).
[2019-08-13 15:05:13,211] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 28).
[2019-08-13 15:05:13,213] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:13,213] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:13,213] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:13,213] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:13,358] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:13,358] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:13,359] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":289}}
[2019-08-13 15:05:13,359] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":289}}
[2019-08-13 15:05:13,360] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(289)
[2019-08-13 15:05:13,360] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(289)
[2019-08-13 15:05:22,909] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:22,909] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:22,909] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":290,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":16}}}
[2019-08-13 15:05:22,909] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":290,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":16}}}
[2019-08-13 15:05:22,910] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 16).
[2019-08-13 15:05:22,910] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 16).
[2019-08-13 15:05:22,910] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:22,910] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:22,910] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:22,910] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:22,990] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:22,990] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:22,990] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":290}}
[2019-08-13 15:05:22,990] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":290}}
[2019-08-13 15:05:22,991] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(290)
[2019-08-13 15:05:22,991] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(290)
[2019-08-13 15:05:23,141] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:23,141] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:23,141] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":291,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":17}}}
[2019-08-13 15:05:23,141] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":291,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":17}}}
[2019-08-13 15:05:23,143] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 17).
[2019-08-13 15:05:23,143] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 17).
[2019-08-13 15:05:23,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:23,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:23,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:23,143] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:25,719] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:25,719] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:25,719] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":291}}
[2019-08-13 15:05:25,719] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":291}}
[2019-08-13 15:05:25,720] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(291)
[2019-08-13 15:05:25,720] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(291)
[2019-08-13 15:05:25,970] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:25,970] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:25,971] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":292,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":22}}}
[2019-08-13 15:05:25,971] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":292,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":22}}}
[2019-08-13 15:05:25,972] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 22).
[2019-08-13 15:05:25,972] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 22).
[2019-08-13 15:05:25,972] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:25,972] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:25,972] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:25,972] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:26,456] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:26,456] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:26,457] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":292}}
[2019-08-13 15:05:26,457] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":292}}
[2019-08-13 15:05:26,458] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(292)
[2019-08-13 15:05:26,458] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(292)
[2019-08-13 15:05:37,009] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:37,009] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:37,009] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":293,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":34}}}
[2019-08-13 15:05:37,009] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":293,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":34}}}
[2019-08-13 15:05:37,010] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 34).
[2019-08-13 15:05:37,010] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 34).
[2019-08-13 15:05:37,010] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:37,010] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:37,010] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:37,010] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:37,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:37,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:37,058] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":293}}
[2019-08-13 15:05:37,058] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":293}}
[2019-08-13 15:05:37,059] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(293)
[2019-08-13 15:05:37,059] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(293)
[2019-08-13 15:05:37,308] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:37,308] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:37,309] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":294,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":33}}}
[2019-08-13 15:05:37,309] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":294,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":33}}}
[2019-08-13 15:05:37,309] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 33).
[2019-08-13 15:05:37,309] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 33).
[2019-08-13 15:05:37,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:37,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:37,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:37,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:37,612] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:37,612] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:37,613] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":294}}
[2019-08-13 15:05:37,613] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":294}}
[2019-08-13 15:05:37,613] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(294)
[2019-08-13 15:05:37,613] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(294)
[2019-08-13 15:05:38,264] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:38,264] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:38,265] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":295,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":41}}}
[2019-08-13 15:05:38,265] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":295,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":41}}}
[2019-08-13 15:05:38,265] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 41).
[2019-08-13 15:05:38,265] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 41).
[2019-08-13 15:05:38,266] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:38,266] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:38,266] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:38,266] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:38,358] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:38,358] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:38,359] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":295}}
[2019-08-13 15:05:38,359] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":295}}
[2019-08-13 15:05:38,360] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(295)
[2019-08-13 15:05:38,360] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(295)
[2019-08-13 15:05:41,828] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:41,828] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:41,829] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":296,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":27}}}
[2019-08-13 15:05:41,829] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":296,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":27}}}
[2019-08-13 15:05:41,829] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 27).
[2019-08-13 15:05:41,829] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 27).
[2019-08-13 15:05:41,830] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:41,830] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:41,830] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:41,830] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:41,877] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:41,877] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:41,878] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":296}}
[2019-08-13 15:05:41,878] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":296}}
[2019-08-13 15:05:41,878] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(296)
[2019-08-13 15:05:41,878] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(296)
[2019-08-13 15:05:43,726] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:43,726] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:43,727] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":297,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":10}}}
[2019-08-13 15:05:43,727] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":297,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":10}}}
[2019-08-13 15:05:43,727] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 10).
[2019-08-13 15:05:43,727] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 10).
[2019-08-13 15:05:43,728] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:43,728] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:43,728] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:43,728] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:43,775] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:43,775] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:43,775] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":297}}
[2019-08-13 15:05:43,775] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":297}}
[2019-08-13 15:05:43,776] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(297)
[2019-08-13 15:05:43,776] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(297)
[2019-08-13 15:05:44,126] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:44,126] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:44,127] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":298,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":15}}}
[2019-08-13 15:05:44,127] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":298,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":15}}}
[2019-08-13 15:05:44,127] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 15).
[2019-08-13 15:05:44,127] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 15).
[2019-08-13 15:05:44,128] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:44,128] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:44,128] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:44,128] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:44,230] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:44,230] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:44,230] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":298}}
[2019-08-13 15:05:44,230] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":298}}
[2019-08-13 15:05:44,231] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(298)
[2019-08-13 15:05:44,231] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(298)
[2019-08-13 15:05:44,381] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:44,381] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:44,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":299,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":16}}}
[2019-08-13 15:05:44,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":299,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":16}}}
[2019-08-13 15:05:44,382] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 16).
[2019-08-13 15:05:44,382] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 16).
[2019-08-13 15:05:44,383] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:44,383] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:44,383] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:44,383] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:44,400] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:44,400] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:44,400] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":299}}
[2019-08-13 15:05:44,400] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":299}}
[2019-08-13 15:05:44,401] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(299)
[2019-08-13 15:05:44,401] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(299)
[2019-08-13 15:05:45,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:45,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:45,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":300,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":34}}}
[2019-08-13 15:05:45,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":300,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":34}}}
[2019-08-13 15:05:45,473] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 34).
[2019-08-13 15:05:45,473] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 34).
[2019-08-13 15:05:45,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:45,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:45,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:45,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:45,519] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:45,519] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:45,520] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":300}}
[2019-08-13 15:05:45,520] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":300}}
[2019-08-13 15:05:45,521] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(300)
[2019-08-13 15:05:45,521] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(300)
[2019-08-13 15:05:45,887] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:45,887] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:45,888] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":267}}
[2019-08-13 15:05:45,888] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":267}}
[2019-08-13 15:05:45,889] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(267)
[2019-08-13 15:05:45,889] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(267)
[2019-08-13 15:05:45,889] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:45,889] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:45,889] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":301,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":34}}}
[2019-08-13 15:05:45,889] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":301,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":34}}}
[2019-08-13 15:05:45,890] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (65, 34).
[2019-08-13 15:05:45,890] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (65, 34).
[2019-08-13 15:05:45,890] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:45,890] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:45,921] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:45,921] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:45,921] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":301}}
[2019-08-13 15:05:45,921] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":301}}
[2019-08-13 15:05:45,923] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(301)
[2019-08-13 15:05:45,923] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(301)
[2019-08-13 15:05:45,923] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:45,923] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:45,923] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":302,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":34}}}
[2019-08-13 15:05:45,923] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":302,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":34}}}
[2019-08-13 15:05:45,924] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 34).
[2019-08-13 15:05:45,924] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 34).
[2019-08-13 15:05:45,924] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:45,924] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:46,072] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:46,072] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:46,072] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":303,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":33}}}
[2019-08-13 15:05:46,072] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":303,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":33}}}
[2019-08-13 15:05:46,073] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 33).
[2019-08-13 15:05:46,073] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 33).
[2019-08-13 15:05:46,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:46,073] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:46,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:46,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:46,121] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,121] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,121] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":303}}
[2019-08-13 15:05:46,121] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":303}}
[2019-08-13 15:05:46,122] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(303)
[2019-08-13 15:05:46,122] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(303)
[2019-08-13 15:05:46,471] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:46,471] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:46,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":304,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":31}}}
[2019-08-13 15:05:46,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":304,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":31}}}
[2019-08-13 15:05:46,472] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 31).
[2019-08-13 15:05:46,472] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 31).
[2019-08-13 15:05:46,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:46,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:46,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:46,473] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:46,520] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,520] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,520] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":302}}
[2019-08-13 15:05:46,520] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":302}}
[2019-08-13 15:05:46,521] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(302)
[2019-08-13 15:05:46,521] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(302)
[2019-08-13 15:05:46,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:46,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:46,522] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":305,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":33}}}
[2019-08-13 15:05:46,522] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":305,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":33}}}
[2019-08-13 15:05:46,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,523] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 33).
[2019-08-13 15:05:46,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,523] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 33).
[2019-08-13 15:05:46,523] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":304}}
[2019-08-13 15:05:46,523] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":304}}
[2019-08-13 15:05:46,523] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:46,523] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:46,524] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(304)
[2019-08-13 15:05:46,524] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(304)
[2019-08-13 15:05:46,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:46,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":305}}
[2019-08-13 15:05:46,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":305}}
[2019-08-13 15:05:46,659] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(305)
[2019-08-13 15:05:46,659] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(305)
[2019-08-13 15:05:46,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2925
[2019-08-13 15:05:46,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2925
[2019-08-13 15:05:46,660] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":19},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:46,660] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":19},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS networkType,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:46,660] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:46,660] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:46,661] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:46,661] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:46,661] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":306,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:05:46,661] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":306,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:05:46,661] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 34).
[2019-08-13 15:05:46,661] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 34).
[2019-08-13 15:05:46,661] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:46,661] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:46,954] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:46,954] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:46,954] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":307,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:46,954] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":307,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:46,954] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":307}
[2019-08-13 15:05:46,954] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":307}
[2019-08-13 15:05:46,955] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":307}
[2019-08-13 15:05:46,955] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":307}
[2019-08-13 15:05:47,577] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:47,577] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:47,577] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":308,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":14}}}
[2019-08-13 15:05:47,577] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":308,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":14}}}
[2019-08-13 15:05:47,578] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 14).
[2019-08-13 15:05:47,578] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 14).
[2019-08-13 15:05:47,578] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:47,578] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:47,578] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:47,578] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:47,627] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:47,627] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:47,627] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":308}}
[2019-08-13 15:05:47,627] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":308}}
[2019-08-13 15:05:47,628] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(308)
[2019-08-13 15:05:47,628] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(308)
[2019-08-13 15:05:48,278] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:48,278] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:48,278] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":309,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":22}}}
[2019-08-13 15:05:48,278] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":309,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":22}}}
[2019-08-13 15:05:48,279] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 22).
[2019-08-13 15:05:48,279] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 22).
[2019-08-13 15:05:48,280] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:48,280] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:48,280] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:48,280] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:48,963] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:48,963] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:48,963] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":309}}
[2019-08-13 15:05:48,963] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":309}}
[2019-08-13 15:05:48,965] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(309)
[2019-08-13 15:05:48,965] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(309)
[2019-08-13 15:05:49,782] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:49,782] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:49,782] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":306}}
[2019-08-13 15:05:49,782] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":306}}
[2019-08-13 15:05:49,783] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(306)
[2019-08-13 15:05:49,783] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(306)
[2019-08-13 15:05:49,783] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:49,783] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:49,783] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":310,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":27}}}
[2019-08-13 15:05:49,783] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":310,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":27}}}
[2019-08-13 15:05:49,783] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 27).
[2019-08-13 15:05:49,783] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 27).
[2019-08-13 15:05:49,784] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:49,784] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:49,879] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:49,879] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:49,879] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":310}}
[2019-08-13 15:05:49,879] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":310}}
[2019-08-13 15:05:49,880] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(310)
[2019-08-13 15:05:49,880] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(310)
[2019-08-13 15:05:49,880] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 15:05:49,880] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 15:05:49,881] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:49,881] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":20},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:49,883] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:49,883] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:49,883] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:49,883] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:49,883] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":311,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":26}}}
[2019-08-13 15:05:49,883] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":311,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":26}}}
[2019-08-13 15:05:49,884] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 26).
[2019-08-13 15:05:49,884] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 26).
[2019-08-13 15:05:49,884] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:49,884] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:50,143] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:50,143] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:50,143] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":312,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:50,143] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":312,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:50,144] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":312}
[2019-08-13 15:05:50,144] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":312}
[2019-08-13 15:05:50,144] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":312}
[2019-08-13 15:05:50,144] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":312}
[2019-08-13 15:05:50,433] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:50,433] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:50,433] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":313,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":18}}}
[2019-08-13 15:05:50,433] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":313,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":18}}}
[2019-08-13 15:05:50,434] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 18).
[2019-08-13 15:05:50,434] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 18).
[2019-08-13 15:05:50,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:50,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:50,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:50,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:50,479] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:50,479] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:50,479] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":313}}
[2019-08-13 15:05:50,479] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":313}}
[2019-08-13 15:05:50,480] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(313)
[2019-08-13 15:05:50,480] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(313)
[2019-08-13 15:05:50,630] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:50,630] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:50,630] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":314,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":18}}}
[2019-08-13 15:05:50,630] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":314,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":18}}}
[2019-08-13 15:05:50,631] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 18).
[2019-08-13 15:05:50,631] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 18).
[2019-08-13 15:05:50,632] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:50,632] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:50,632] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:50,632] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:50,918] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:50,918] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:50,918] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":314}}
[2019-08-13 15:05:50,918] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":314}}
[2019-08-13 15:05:50,919] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(314)
[2019-08-13 15:05:50,919] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(314)
[2019-08-13 15:05:51,069] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:51,069] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:51,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":315,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":18}}}
[2019-08-13 15:05:51,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":315,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":18}}}
[2019-08-13 15:05:51,070] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 18).
[2019-08-13 15:05:51,070] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 18).
[2019-08-13 15:05:51,070] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:51,070] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:51,070] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:51,070] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:51,632] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:51,632] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:51,632] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":315}}
[2019-08-13 15:05:51,632] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":315}}
[2019-08-13 15:05:51,633] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(315)
[2019-08-13 15:05:51,633] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(315)
[2019-08-13 15:05:51,981] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:51,981] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:51,981] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":316,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":24}}}
[2019-08-13 15:05:51,981] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":316,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":24}}}
[2019-08-13 15:05:51,982] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 24).
[2019-08-13 15:05:51,982] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 24).
[2019-08-13 15:05:51,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:51,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:51,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:51,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:52,277] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:52,277] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:52,277] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":316}}
[2019-08-13 15:05:52,277] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":316}}
[2019-08-13 15:05:52,278] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(316)
[2019-08-13 15:05:52,278] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(316)
[2019-08-13 15:05:52,528] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:52,528] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:52,528] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":317,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:05:52,528] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":317,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:05:52,529] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 15:05:52,529] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 23).
[2019-08-13 15:05:52,529] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:52,529] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:52,529] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:52,529] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:52,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:52,749] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:52,749] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":317}}
[2019-08-13 15:05:52,749] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":317}}
[2019-08-13 15:05:52,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(317)
[2019-08-13 15:05:52,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(317)
[2019-08-13 15:05:53,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:53,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:53,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":311}}
[2019-08-13 15:05:53,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":311}}
[2019-08-13 15:05:53,058] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(311)
[2019-08-13 15:05:53,058] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(311)
[2019-08-13 15:05:53,058] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:53,058] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:53,058] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":318,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:05:53,058] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":318,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":23}}}
[2019-08-13 15:05:53,059] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 23).
[2019-08-13 15:05:53,059] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 23).
[2019-08-13 15:05:53,059] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:53,059] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:53,255] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:53,255] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:53,255] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":318}}
[2019-08-13 15:05:53,255] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":318}}
[2019-08-13 15:05:53,256] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(318)
[2019-08-13 15:05:53,256] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(318)
[2019-08-13 15:05:53,256] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 15:05:53,256] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 15:05:53,256] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":21},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.creator) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:53,256] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":21},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.creator) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:53,257] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:53,257] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:53,258] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:53,258] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:53,258] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":319,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:53,258] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":319,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:53,258] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 24).
[2019-08-13 15:05:53,258] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 24).
[2019-08-13 15:05:53,258] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:53,258] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:53,518] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:53,518] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:53,518] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":320,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:53,518] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":320,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:53,519] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":320}
[2019-08-13 15:05:53,519] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":320}
[2019-08-13 15:05:53,520] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":320}
[2019-08-13 15:05:53,520] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":320}
[2019-08-13 15:05:53,606] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:53,606] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:53,606] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":321,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:53,606] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":321,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:53,607] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:53,607] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:53,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:53,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:53,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:53,607] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:53,852] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:53,852] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:53,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":321}}
[2019-08-13 15:05:53,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":321}}
[2019-08-13 15:05:53,853] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(321)
[2019-08-13 15:05:53,853] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(321)
[2019-08-13 15:05:54,263] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:54,263] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:54,264] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":319}}
[2019-08-13 15:05:54,264] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":319}}
[2019-08-13 15:05:54,265] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(319)
[2019-08-13 15:05:54,265] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(319)
[2019-08-13 15:05:54,265] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:54,265] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:54,265] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":322,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:54,265] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":322,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:54,265] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 24).
[2019-08-13 15:05:54,265] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 24).
[2019-08-13 15:05:54,266] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:54,266] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:54,316] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:54,316] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:54,317] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":323,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:54,317] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":323,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:54,318] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:54,318] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:54,318] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:54,318] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:54,318] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:54,318] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:54,467] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:54,467] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:54,468] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":323}}
[2019-08-13 15:05:54,468] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":323}}
[2019-08-13 15:05:54,469] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(323)
[2019-08-13 15:05:54,469] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(323)
[2019-08-13 15:05:54,619] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:54,619] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:54,619] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":324,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:54,619] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":324,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:54,620] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:54,620] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:54,620] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:54,620] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:54,620] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:54,620] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:54,856] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:54,856] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:54,856] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":324}}
[2019-08-13 15:05:54,856] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":324}}
[2019-08-13 15:05:54,857] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(324)
[2019-08-13 15:05:54,857] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(324)
[2019-08-13 15:05:55,007] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:55,007] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:55,007] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":325,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:55,007] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":325,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:55,008] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:55,008] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 24).
[2019-08-13 15:05:55,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:55,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:55,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:55,009] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:55,961] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:55,961] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:55,961] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":322}}
[2019-08-13 15:05:55,961] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":322}}
[2019-08-13 15:05:55,962] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(322)
[2019-08-13 15:05:55,962] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(322)
[2019-08-13 15:05:55,962] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:55,962] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:05:55,963] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":326,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:55,963] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":326,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":24}}}
[2019-08-13 15:05:55,963] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 24).
[2019-08-13 15:05:55,963] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 24).
[2019-08-13 15:05:55,963] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:55,963] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:05:56,108] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:56,108] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:05:56,109] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":325}}
[2019-08-13 15:05:56,109] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":325}}
[2019-08-13 15:05:56,110] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(325)
[2019-08-13 15:05:56,110] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(325)
[2019-08-13 15:05:56,310] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 15:05:56,310] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2921
[2019-08-13 15:05:56,310] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":22},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:56,310] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":22},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      AVG(x.signal.txSpeed) AS avgTxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:05:56,312] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:56,312] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:05:56,454] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:56,454] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:05:56,454] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":327,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:56,454] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":327,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:05:56,456] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":327}
[2019-08-13 15:05:56,456] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":327}
[2019-08-13 15:05:56,456] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":327}
[2019-08-13 15:05:56,456] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":327}
[2019-08-13 15:05:57,049] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:57,049] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:05:57,050] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":328,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":26}}}
[2019-08-13 15:05:57,050] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":328,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":26}}}
[2019-08-13 15:05:57,050] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 26).
[2019-08-13 15:05:57,050] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 26).
[2019-08-13 15:05:57,051] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:57,051] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:05:57,051] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:05:57,051] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:00,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:00,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:00,171] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":328}}
[2019-08-13 15:06:00,171] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":328}}
[2019-08-13 15:06:00,172] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(328)
[2019-08-13 15:06:00,172] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(328)
[2019-08-13 15:06:00,620] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:00,620] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:00,620] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":329,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":3}}}
[2019-08-13 15:06:00,620] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":329,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":3}}}
[2019-08-13 15:06:00,622] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 3).
[2019-08-13 15:06:00,622] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 3).
[2019-08-13 15:06:00,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:00,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:00,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:00,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:00,669] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:00,669] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:00,670] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":329}}
[2019-08-13 15:06:00,670] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":329}}
[2019-08-13 15:06:00,670] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(329)
[2019-08-13 15:06:00,670] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(329)
[2019-08-13 15:06:00,820] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:00,820] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:00,820] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":330,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":4}}}
[2019-08-13 15:06:00,820] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":330,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":4}}}
[2019-08-13 15:06:00,821] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 4).
[2019-08-13 15:06:00,821] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 4).
[2019-08-13 15:06:00,822] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:00,822] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:00,822] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:00,822] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:00,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:00,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:00,921] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":330}}
[2019-08-13 15:06:00,921] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":330}}
[2019-08-13 15:06:00,922] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(330)
[2019-08-13 15:06:00,922] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(330)
[2019-08-13 15:06:03,131] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2884
[2019-08-13 15:06:03,131] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2884
[2019-08-13 15:06:03,132] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":23},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n     \n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:03,132] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":23},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n     \n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:03,134] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:03,134] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:03,288] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:03,288] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:03,289] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":331,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:03,289] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":331,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:03,290] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":331}
[2019-08-13 15:06:03,290] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":331}
[2019-08-13 15:06:03,290] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":331}
[2019-08-13 15:06:03,290] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":331}
[2019-08-13 15:06:03,543] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2883
[2019-08-13 15:06:03,543] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2883
[2019-08-13 15:06:03,543] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":24},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n    \n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:03,543] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":24},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n    \n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:03,545] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:03,545] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:03,682] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:03,682] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:03,682] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":332,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:03,682] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":332,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:03,683] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":332}
[2019-08-13 15:06:03,683] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":332}
[2019-08-13 15:06:03,683] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":332}
[2019-08-13 15:06:03,683] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":332}
[2019-08-13 15:06:03,985] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2881
[2019-08-13 15:06:03,985] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2881
[2019-08-13 15:06:03,986] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":25},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n  \n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:03,986] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":25},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n  \n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:03,987] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:03,987] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:04,134] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:04,134] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:04,134] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":333,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:04,134] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":333,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:04,136] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":333}
[2019-08-13 15:06:04,136] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":333}
[2019-08-13 15:06:04,136] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":333}
[2019-08-13 15:06:04,136] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":333}
[2019-08-13 15:06:04,386] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2879
[2019-08-13 15:06:04,386] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2879
[2019-08-13 15:06:04,386] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":26},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:04,386] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":26},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:04,388] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:04,388] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:04,535] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:04,535] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:04,536] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":334,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:04,536] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":334,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:04,538] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":334}
[2019-08-13 15:06:04,538] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":334}
[2019-08-13 15:06:04,538] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":334}
[2019-08-13 15:06:04,538] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":334}
[2019-08-13 15:06:04,820] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2877
[2019-08-13 15:06:04,820] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2877
[2019-08-13 15:06:04,820] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":27},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:04,820] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":27},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MIN(x.signal.txSpeed) AS minTxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:04,822] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:04,822] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:04,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:04,968] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:04,968] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":335,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:04,968] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":335,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:04,969] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":335}
[2019-08-13 15:06:04,969] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":335}
[2019-08-13 15:06:04,969] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":335}
[2019-08-13 15:06:04,969] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":335}
[2019-08-13 15:06:07,187] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:07,187] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:07,187] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":336,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":3}}}
[2019-08-13 15:06:07,187] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":336,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":3}}}
[2019-08-13 15:06:07,188] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 3).
[2019-08-13 15:06:07,188] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 3).
[2019-08-13 15:06:07,188] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:07,188] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:07,188] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:07,188] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:07,336] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:07,336] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:07,336] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":336}}
[2019-08-13 15:06:07,336] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":336}}
[2019-08-13 15:06:07,337] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(336)
[2019-08-13 15:06:07,337] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(336)
[2019-08-13 15:06:07,487] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:07,487] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:07,487] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":337,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":11}}}
[2019-08-13 15:06:07,487] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":337,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":11}}}
[2019-08-13 15:06:07,487] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 11).
[2019-08-13 15:06:07,487] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 11).
[2019-08-13 15:06:07,488] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:07,488] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:07,488] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:07,488] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:07,536] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:07,536] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:07,536] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":337}}
[2019-08-13 15:06:07,536] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":337}}
[2019-08-13 15:06:07,537] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(337)
[2019-08-13 15:06:07,537] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(337)
[2019-08-13 15:06:07,886] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:07,886] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:07,886] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":338,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":6}}}
[2019-08-13 15:06:07,886] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":338,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":6}}}
[2019-08-13 15:06:07,887] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 6).
[2019-08-13 15:06:07,887] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 6).
[2019-08-13 15:06:07,887] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:07,887] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:07,888] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:07,888] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:07,937] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:07,937] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:07,937] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":338}}
[2019-08-13 15:06:07,937] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":338}}
[2019-08-13 15:06:07,938] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(338)
[2019-08-13 15:06:07,938] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(338)
[2019-08-13 15:06:08,188] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:08,188] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:08,188] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":339,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":5}}}
[2019-08-13 15:06:08,188] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":339,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":5}}}
[2019-08-13 15:06:08,189] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 5).
[2019-08-13 15:06:08,189] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 5).
[2019-08-13 15:06:08,189] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:08,189] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:08,189] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:08,189] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:08,379] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:08,379] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:08,380] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":339}}
[2019-08-13 15:06:08,380] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":339}}
[2019-08-13 15:06:08,381] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(339)
[2019-08-13 15:06:08,381] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(339)
[2019-08-13 15:06:10,709] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2841
[2019-08-13 15:06:10,709] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2841
[2019-08-13 15:06:10,709] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":28},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      \n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:10,709] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":28},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      \n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:10,711] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:10,711] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:11,025] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2839
[2019-08-13 15:06:11,025] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2839
[2019-08-13 15:06:11,025] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":29},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n    \n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:11,025] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":29},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n    \n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:11,028] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:11,028] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:11,381] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2837
[2019-08-13 15:06:11,381] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2837
[2019-08-13 15:06:11,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":30},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n  \n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:11,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":30},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n  \n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:11,383] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:11,383] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:11,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:11,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:11,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":340,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:11,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":340,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:11,528] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":340}
[2019-08-13 15:06:11,528] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":340}
[2019-08-13 15:06:11,528] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":340}
[2019-08-13 15:06:11,528] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":340}
[2019-08-13 15:06:11,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2835
[2019-08-13 15:06:11,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2835
[2019-08-13 15:06:11,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":31},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:11,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":31},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:11,772] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:11,772] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:11,894] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:11,894] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:11,894] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":341,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:11,894] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":341,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:11,895] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":341}
[2019-08-13 15:06:11,895] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":341}
[2019-08-13 15:06:11,895] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":341}
[2019-08-13 15:06:11,895] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":341}
[2019-08-13 15:06:12,166] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2833
[2019-08-13 15:06:12,166] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2833
[2019-08-13 15:06:12,167] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":32},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:12,167] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":32},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.rxSpeed) AS maxRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:12,169] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:12,169] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:12,312] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:12,312] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:12,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":342,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:12,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":342,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:12,314] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":342}
[2019-08-13 15:06:12,314] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":342}
[2019-08-13 15:06:12,314] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":342}
[2019-08-13 15:06:12,314] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":342}
[2019-08-13 15:06:14,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:14,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:14,621] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":343,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":5}}}
[2019-08-13 15:06:14,621] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":343,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":5}}}
[2019-08-13 15:06:14,622] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 5).
[2019-08-13 15:06:14,622] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 5).
[2019-08-13 15:06:14,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:14,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:14,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:14,622] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:14,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:14,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:14,694] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":343}}
[2019-08-13 15:06:14,694] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":343}}
[2019-08-13 15:06:14,695] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(343)
[2019-08-13 15:06:14,695] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(343)
[2019-08-13 15:06:15,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:15,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:15,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":344,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":63}}}
[2019-08-13 15:06:15,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":344,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":63}}}
[2019-08-13 15:06:15,809] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 63).
[2019-08-13 15:06:15,809] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 63).
[2019-08-13 15:06:15,810] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:15,810] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:15,810] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:15,810] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:17,083] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:17,083] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:17,084] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":344}}
[2019-08-13 15:06:17,084] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":344}}
[2019-08-13 15:06:17,085] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(344)
[2019-08-13 15:06:17,085] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(344)
[2019-08-13 15:06:18,048] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:18,048] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:18,048] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":345,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":4}}}
[2019-08-13 15:06:18,048] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":345,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":4}}}
[2019-08-13 15:06:18,049] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 4).
[2019-08-13 15:06:18,049] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 4).
[2019-08-13 15:06:18,049] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:18,049] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:18,050] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:18,050] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:18,098] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:18,098] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:18,098] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":345}}
[2019-08-13 15:06:18,098] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":345}}
[2019-08-13 15:06:18,099] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(345)
[2019-08-13 15:06:18,099] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(345)
[2019-08-13 15:06:18,249] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:18,249] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:18,249] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":346,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":5}}}
[2019-08-13 15:06:18,249] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":346,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":5}}}
[2019-08-13 15:06:18,250] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 5).
[2019-08-13 15:06:18,250] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 5).
[2019-08-13 15:06:18,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:18,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:18,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:18,250] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:18,400] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:18,400] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:18,400] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":346}}
[2019-08-13 15:06:18,400] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":346}}
[2019-08-13 15:06:18,401] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(346)
[2019-08-13 15:06:18,401] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(346)
[2019-08-13 15:06:18,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:18,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:18,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":347,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":5}}}
[2019-08-13 15:06:18,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":347,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":5}}}
[2019-08-13 15:06:18,808] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 5).
[2019-08-13 15:06:18,808] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 5).
[2019-08-13 15:06:18,809] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:18,809] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:18,809] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:18,809] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:18,861] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:18,861] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:18,861] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":347}}
[2019-08-13 15:06:18,861] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":347}}
[2019-08-13 15:06:18,862] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(347)
[2019-08-13 15:06:18,862] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(347)
[2019-08-13 15:06:19,209] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:19,209] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:19,209] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":348,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":4}}}
[2019-08-13 15:06:19,209] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":348,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":4}}}
[2019-08-13 15:06:19,210] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 4).
[2019-08-13 15:06:19,210] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 4).
[2019-08-13 15:06:19,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:19,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:19,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:19,210] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:19,258] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:19,258] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:19,259] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":348}}
[2019-08-13 15:06:19,259] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":348}}
[2019-08-13 15:06:19,259] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(348)
[2019-08-13 15:06:19,259] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(348)
[2019-08-13 15:06:21,137] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:21,137] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:21,137] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":349,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":45}}}
[2019-08-13 15:06:21,137] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":349,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":65,"character":45}}}
[2019-08-13 15:06:21,138] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 45).
[2019-08-13 15:06:21,138] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (65, 45).
[2019-08-13 15:06:21,138] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:21,138] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:21,138] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:21,138] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:21,772] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:21,772] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:21,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":349}}
[2019-08-13 15:06:21,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":349}}
[2019-08-13 15:06:21,773] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(349)
[2019-08-13 15:06:21,773] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(349)
[2019-08-13 15:06:22,953] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:22,953] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:22,953] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":350,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":42}}}
[2019-08-13 15:06:22,953] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":350,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":42}}}
[2019-08-13 15:06:22,954] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 42).
[2019-08-13 15:06:22,954] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 42).
[2019-08-13 15:06:22,954] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:22,954] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:22,954] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:22,954] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:23,261] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:23,261] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:23,261] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":350}}
[2019-08-13 15:06:23,261] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":350}}
[2019-08-13 15:06:23,261] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(350)
[2019-08-13 15:06:23,261] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(350)
[2019-08-13 15:06:24,996] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2796
[2019-08-13 15:06:24,996] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2796
[2019-08-13 15:06:24,996] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":33},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n     \n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:24,996] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":33},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n     \n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:24,997] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:24,997] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:25,316] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2795
[2019-08-13 15:06:25,316] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2795
[2019-08-13 15:06:25,316] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":34},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n    \n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:25,316] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":34},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n    \n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:25,317] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:25,317] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:25,636] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2793
[2019-08-13 15:06:25,636] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2793
[2019-08-13 15:06:25,636] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":35},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n  \n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:25,636] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":35},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n  \n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:25,636] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:25,636] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:25,787] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:25,787] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:25,788] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":351,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:25,788] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":351,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:25,789] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":351}
[2019-08-13 15:06:25,789] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":351}
[2019-08-13 15:06:25,790] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":351}
[2019-08-13 15:06:25,790] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":351}
[2019-08-13 15:06:26,045] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2791
[2019-08-13 15:06:26,045] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2791
[2019-08-13 15:06:26,045] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":36},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:26,045] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":36},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:26,047] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:26,047] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:26,195] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:26,195] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:26,195] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":352,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:26,195] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":352,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:26,196] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":352}
[2019-08-13 15:06:26,196] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":352}
[2019-08-13 15:06:26,196] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":352}
[2019-08-13 15:06:26,196] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":352}
[2019-08-13 15:06:26,562] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2789
[2019-08-13 15:06:26,562] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2789
[2019-08-13 15:06:26,562] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":37},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:26,562] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":37},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      networkType\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:26,564] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:26,564] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:26,710] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:26,710] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:26,710] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":353,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:26,710] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":353,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:26,711] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":353}
[2019-08-13 15:06:26,711] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":353}
[2019-08-13 15:06:26,711] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":353}
[2019-08-13 15:06:26,711] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":353}
[2019-08-13 15:06:30,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:30,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:30,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":354,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":68,"character":5}}}
[2019-08-13 15:06:30,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":354,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":68,"character":5}}}
[2019-08-13 15:06:30,073] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (68, 5).
[2019-08-13 15:06:30,073] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (68, 5).
[2019-08-13 15:06:30,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:30,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:30,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:30,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:30,223] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:30,223] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:30,223] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":354}}
[2019-08-13 15:06:30,223] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":354}}
[2019-08-13 15:06:30,224] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(354)
[2019-08-13 15:06:30,224] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(354)
[2019-08-13 15:06:30,674] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:30,674] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:06:30,674] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":355,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":8}}}
[2019-08-13 15:06:30,674] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":355,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":8}}}
[2019-08-13 15:06:30,674] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 8).
[2019-08-13 15:06:30,674] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 8).
[2019-08-13 15:06:30,675] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:30,675] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:30,675] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:30,675] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:30,722] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:30,722] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:30,722] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":355}}
[2019-08-13 15:06:30,722] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":355}}
[2019-08-13 15:06:30,723] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(355)
[2019-08-13 15:06:30,723] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(355)
[2019-08-13 15:06:35,663] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:35,663] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:35,664] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":356,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":18}}}
[2019-08-13 15:06:35,664] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":356,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":18}}}
[2019-08-13 15:06:35,664] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 18).
[2019-08-13 15:06:35,664] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 18).
[2019-08-13 15:06:35,665] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:35,665] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:35,665] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:35,665] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:35,713] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:35,713] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:35,713] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":356}}
[2019-08-13 15:06:35,713] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":356}}
[2019-08-13 15:06:35,714] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(356)
[2019-08-13 15:06:35,714] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(356)
[2019-08-13 15:06:36,290] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:36,290] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:36,290] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":357,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":31}}}
[2019-08-13 15:06:36,290] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":357,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":31}}}
[2019-08-13 15:06:36,291] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 31).
[2019-08-13 15:06:36,291] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 31).
[2019-08-13 15:06:36,291] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:36,291] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:36,291] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:36,291] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:36,434] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:36,434] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:36,434] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":357}}
[2019-08-13 15:06:36,434] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":357}}
[2019-08-13 15:06:36,435] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(357)
[2019-08-13 15:06:36,435] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(357)
[2019-08-13 15:06:41,764] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:06:41,764] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:06:41,765] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":38},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:41,765] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":38},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      networkType\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:41,766] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:41,766] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:41,869] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:41,869] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:41,870] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":358,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:41,870] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":358,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:41,871] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":358}
[2019-08-13 15:06:41,871] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":358}
[2019-08-13 15:06:41,871] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":358}
[2019-08-13 15:06:41,871] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":358}
[2019-08-13 15:06:43,955] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2781
[2019-08-13 15:06:43,955] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2781
[2019-08-13 15:06:43,955] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":39},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:43,955] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":39},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.time/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:06:43,957] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:43,957] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:06:44,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:44,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:06:44,074] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":359,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:44,074] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":359,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:06:44,075] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":359}
[2019-08-13 15:06:44,075] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":359}
[2019-08-13 15:06:44,075] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":359}
[2019-08-13 15:06:44,075] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":359}
[2019-08-13 15:06:44,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:44,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:44,280] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":360,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":78,"character":28}}}
[2019-08-13 15:06:44,280] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":360,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":78,"character":28}}}
[2019-08-13 15:06:44,281] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (78, 28).
[2019-08-13 15:06:44,281] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (78, 28).
[2019-08-13 15:06:44,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:44,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:44,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:44,281] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:44,324] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:44,324] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:44,324] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":360}}
[2019-08-13 15:06:44,324] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":360}}
[2019-08-13 15:06:44,325] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(360)
[2019-08-13 15:06:44,325] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(360)
[2019-08-13 15:06:44,477] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:44,477] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:06:44,477] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":361,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":78,"character":27}}}
[2019-08-13 15:06:44,477] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":361,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":78,"character":27}}}
[2019-08-13 15:06:44,478] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (78, 27).
[2019-08-13 15:06:44,478] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (78, 27).
[2019-08-13 15:06:44,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:44,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:44,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:06:44,479] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:06:44,529] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:44,529] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:06:44,529] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":361}}
[2019-08-13 15:06:44,529] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":361}}
[2019-08-13 15:06:44,530] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(361)
[2019-08-13 15:06:44,530] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(361)
[2019-08-13 15:07:23,617] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:23,617] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:23,617] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":362,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":66,"character":15}}}
[2019-08-13 15:07:23,617] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":362,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":66,"character":15}}}
[2019-08-13 15:07:23,618] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (66, 15).
[2019-08-13 15:07:23,618] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (66, 15).
[2019-08-13 15:07:23,619] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:23,619] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:23,619] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:23,619] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:23,666] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:23,666] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:23,666] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":362}}
[2019-08-13 15:07:23,666] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":362}}
[2019-08-13 15:07:23,667] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(362)
[2019-08-13 15:07:23,667] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(362)
[2019-08-13 15:07:31,584] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:31,584] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:31,585] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":363,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:07:31,585] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":363,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:07:31,586] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 34).
[2019-08-13 15:07:31,586] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 34).
[2019-08-13 15:07:31,586] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:31,586] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:31,586] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:31,586] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:31,952] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:31,952] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:31,952] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":363}}
[2019-08-13 15:07:31,952] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":363}}
[2019-08-13 15:07:31,953] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(363)
[2019-08-13 15:07:31,953] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(363)
[2019-08-13 15:07:38,976] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:38,976] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:38,976] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":364,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":40}}}
[2019-08-13 15:07:38,976] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":364,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":40}}}
[2019-08-13 15:07:38,977] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 40).
[2019-08-13 15:07:38,977] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 40).
[2019-08-13 15:07:38,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:38,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:38,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:38,977] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:39,025] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:39,025] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:39,026] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":364}}
[2019-08-13 15:07:39,026] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":364}}
[2019-08-13 15:07:39,026] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(364)
[2019-08-13 15:07:39,026] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(364)
[2019-08-13 15:07:39,477] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:39,477] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:39,477] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":365,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":34}}}
[2019-08-13 15:07:39,477] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":365,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":34}}}
[2019-08-13 15:07:39,477] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 34).
[2019-08-13 15:07:39,477] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 34).
[2019-08-13 15:07:39,478] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:39,478] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:39,478] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:39,478] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:39,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:39,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:39,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":365}}
[2019-08-13 15:07:39,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":365}}
[2019-08-13 15:07:39,504] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(365)
[2019-08-13 15:07:39,504] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(365)
[2019-08-13 15:07:39,653] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:39,653] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:39,653] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":366,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":33}}}
[2019-08-13 15:07:39,653] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":366,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":33}}}
[2019-08-13 15:07:39,654] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 33).
[2019-08-13 15:07:39,654] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 33).
[2019-08-13 15:07:39,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:39,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:39,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:39,654] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:41,780] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:41,780] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:41,780] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":366}}
[2019-08-13 15:07:41,780] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":366}}
[2019-08-13 15:07:41,781] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(366)
[2019-08-13 15:07:41,781] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(366)
[2019-08-13 15:07:41,931] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:41,931] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:41,931] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":367,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":38}}}
[2019-08-13 15:07:41,931] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":367,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":38}}}
[2019-08-13 15:07:41,931] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 38).
[2019-08-13 15:07:41,931] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 38).
[2019-08-13 15:07:41,932] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:41,932] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:41,932] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:41,932] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:42,549] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:42,549] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:42,550] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":367}}
[2019-08-13 15:07:42,550] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":367}}
[2019-08-13 15:07:42,550] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(367)
[2019-08-13 15:07:42,550] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(367)
[2019-08-13 15:07:44,921] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2789
[2019-08-13 15:07:44,921] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2789
[2019-08-13 15:07:44,922] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":40},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:07:44,922] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":40},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.signal.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:07:44,923] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:07:44,923] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:07:45,068] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:07:45,068] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:07:45,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":368,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:07:45,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":368,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:07:45,070] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":368}
[2019-08-13 15:07:45,070] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":368}
[2019-08-13 15:07:45,070] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":368}
[2019-08-13 15:07:45,070] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":368}
[2019-08-13 15:07:57,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:57,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:57,541] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":369,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":11}}}
[2019-08-13 15:07:57,541] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":369,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":11}}}
[2019-08-13 15:07:57,542] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 11).
[2019-08-13 15:07:57,542] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 11).
[2019-08-13 15:07:57,543] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:57,543] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:57,543] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:57,543] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:57,592] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:57,592] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:57,592] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":369}}
[2019-08-13 15:07:57,592] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":369}}
[2019-08-13 15:07:57,593] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(369)
[2019-08-13 15:07:57,593] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(369)
[2019-08-13 15:07:57,842] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:57,842] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:57,842] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":370,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":10}}}
[2019-08-13 15:07:57,842] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":370,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":10}}}
[2019-08-13 15:07:57,843] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 10).
[2019-08-13 15:07:57,843] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 10).
[2019-08-13 15:07:57,843] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:57,843] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:57,843] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:57,843] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:57,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:57,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:57,919] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":370}}
[2019-08-13 15:07:57,919] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":370}}
[2019-08-13 15:07:57,920] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(370)
[2019-08-13 15:07:57,920] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(370)
[2019-08-13 15:07:58,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:58,073] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:07:58,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":371,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":10}}}
[2019-08-13 15:07:58,073] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":371,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":10}}}
[2019-08-13 15:07:58,074] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 10).
[2019-08-13 15:07:58,074] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 10).
[2019-08-13 15:07:58,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:58,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:07:58,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:58,074] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:07:58,275] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:58,275] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:07:58,275] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":371}}
[2019-08-13 15:07:58,275] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":371}}
[2019-08-13 15:07:58,276] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(371)
[2019-08-13 15:07:58,276] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(371)
[2019-08-13 15:08:11,462] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:11,462] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:11,463] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":326}}
[2019-08-13 15:08:11,463] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":326}}
[2019-08-13 15:08:11,463] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(326)
[2019-08-13 15:08:11,463] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(326)
[2019-08-13 15:08:11,464] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:11,464] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:11,464] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":372,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":13}}}
[2019-08-13 15:08:11,464] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":372,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":13}}}
[2019-08-13 15:08:11,464] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 13).
[2019-08-13 15:08:11,464] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (60, 13).
[2019-08-13 15:08:11,465] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:11,465] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:11,613] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:11,613] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:11,613] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":373,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":13}}}
[2019-08-13 15:08:11,613] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":373,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":13}}}
[2019-08-13 15:08:11,614] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 13).
[2019-08-13 15:08:11,614] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 13).
[2019-08-13 15:08:11,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:11,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:11,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:11,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:11,900] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:11,900] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:11,901] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":373}}
[2019-08-13 15:08:11,901] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":373}}
[2019-08-13 15:08:11,902] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(373)
[2019-08-13 15:08:11,902] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(373)
[2019-08-13 15:08:12,216] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,216] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":372}}
[2019-08-13 15:08:12,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":372}}
[2019-08-13 15:08:12,217] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(372)
[2019-08-13 15:08:12,217] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(372)
[2019-08-13 15:08:12,217] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2788
[2019-08-13 15:08:12,217] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2788
[2019-08-13 15:08:12,217] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":41},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:12,217] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":41},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.signal.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:12,219] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:12,219] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:12,220] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:12,220] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:12,220] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":374,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":14}}}
[2019-08-13 15:08:12,220] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":374,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":14}}}
[2019-08-13 15:08:12,221] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 14).
[2019-08-13 15:08:12,221] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 14).
[2019-08-13 15:08:12,221] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:12,221] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:12,367] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:12,367] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:12,367] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":375,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":13}}}
[2019-08-13 15:08:12,367] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":375,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":13}}}
[2019-08-13 15:08:12,368] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 13).
[2019-08-13 15:08:12,368] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 13).
[2019-08-13 15:08:12,368] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:12,368] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:12,368] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:12,368] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:12,416] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,416] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,416] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":375}}
[2019-08-13 15:08:12,416] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":375}}
[2019-08-13 15:08:12,417] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(375)
[2019-08-13 15:08:12,417] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(375)
[2019-08-13 15:08:12,421] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:12,421] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:12,421] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":376,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:12,421] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":376,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:12,423] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":376}
[2019-08-13 15:08:12,423] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":376}
[2019-08-13 15:08:12,423] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":376}
[2019-08-13 15:08:12,423] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":376}
[2019-08-13 15:08:12,877] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,877] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,877] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":374}}
[2019-08-13 15:08:12,877] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":374}}
[2019-08-13 15:08:12,878] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(374)
[2019-08-13 15:08:12,878] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(374)
[2019-08-13 15:08:12,878] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:12,878] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:12,878] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":377,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":13}}}
[2019-08-13 15:08:12,878] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":377,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":13}}}
[2019-08-13 15:08:12,879] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 13).
[2019-08-13 15:08:12,879] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 13).
[2019-08-13 15:08:12,879] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:12,879] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:12,977] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,977] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:12,977] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":377}}
[2019-08-13 15:08:12,977] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":377}}
[2019-08-13 15:08:12,978] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(377)
[2019-08-13 15:08:12,978] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(377)
[2019-08-13 15:08:12,978] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:12,978] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:12,979] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":378,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":20}}}
[2019-08-13 15:08:12,979] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":378,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":20}}}
[2019-08-13 15:08:12,979] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 20).
[2019-08-13 15:08:12,979] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 20).
[2019-08-13 15:08:12,979] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:12,979] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:13,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2787
[2019-08-13 15:08:13,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2787
[2019-08-13 15:08:13,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":42},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:13,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":42},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.signal.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:13,218] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:13,218] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:13,430] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:13,430] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:13,430] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":379,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:13,430] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":379,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:13,431] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":379}
[2019-08-13 15:08:13,431] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":379}
[2019-08-13 15:08:13,431] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":379}
[2019-08-13 15:08:13,431] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":379}
[2019-08-13 15:08:13,582] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:13,582] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:13,583] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":380,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":34}}}
[2019-08-13 15:08:13,583] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":380,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":34}}}
[2019-08-13 15:08:13,584] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 34).
[2019-08-13 15:08:13,584] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 34).
[2019-08-13 15:08:13,584] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:13,584] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:13,584] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:13,584] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:13,638] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:13,638] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:13,638] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":380}}
[2019-08-13 15:08:13,638] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":380}}
[2019-08-13 15:08:13,639] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(380)
[2019-08-13 15:08:13,639] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(380)
[2019-08-13 15:08:13,789] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:13,789] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:13,789] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":381,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":33}}}
[2019-08-13 15:08:13,789] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":381,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":33}}}
[2019-08-13 15:08:13,790] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 33).
[2019-08-13 15:08:13,790] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 33).
[2019-08-13 15:08:13,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:13,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:13,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:13,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:13,883] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:13,883] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:13,883] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":381}}
[2019-08-13 15:08:13,883] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":381}}
[2019-08-13 15:08:13,884] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(381)
[2019-08-13 15:08:13,884] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(381)
[2019-08-13 15:08:14,464] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:14,464] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:14,464] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":378}}
[2019-08-13 15:08:14,464] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":378}}
[2019-08-13 15:08:14,465] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(378)
[2019-08-13 15:08:14,465] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(378)
[2019-08-13 15:08:14,465] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:14,465] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:14,465] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":382,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":34}}}
[2019-08-13 15:08:14,465] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":382,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":34}}}
[2019-08-13 15:08:14,466] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (58, 34).
[2019-08-13 15:08:14,466] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (58, 34).
[2019-08-13 15:08:14,466] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:14,466] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:14,512] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:14,512] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:14,512] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":383,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":33}}}
[2019-08-13 15:08:14,512] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":383,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":33}}}
[2019-08-13 15:08:14,513] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 33).
[2019-08-13 15:08:14,513] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 33).
[2019-08-13 15:08:14,513] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:14,513] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:14,513] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:14,513] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:14,562] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:14,562] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:14,562] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":383}}
[2019-08-13 15:08:14,562] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":383}}
[2019-08-13 15:08:14,563] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(383)
[2019-08-13 15:08:14,563] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(383)
[2019-08-13 15:08:14,849] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2786
[2019-08-13 15:08:14,849] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2786
[2019-08-13 15:08:14,850] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":43},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:14,850] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":43},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"signal\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:14,852] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:14,852] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:14,854] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:14,854] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:14,854] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":384,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":33}}}
[2019-08-13 15:08:14,854] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":384,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":33}}}
[2019-08-13 15:08:14,855] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 33).
[2019-08-13 15:08:14,855] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 33).
[2019-08-13 15:08:14,855] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:14,855] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:14,855] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:14,855] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:14,996] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:14,996] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:14,996] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":385,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:14,996] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":385,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:14,997] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":385}
[2019-08-13 15:08:14,997] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":385}
[2019-08-13 15:08:14,997] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":385}
[2019-08-13 15:08:14,997] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":385}
[2019-08-13 15:08:15,103] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:15,103] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:15,104] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":384}}
[2019-08-13 15:08:15,104] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":384}}
[2019-08-13 15:08:15,104] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(384)
[2019-08-13 15:08:15,104] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(384)
[2019-08-13 15:08:16,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:16,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:16,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":382}}
[2019-08-13 15:08:16,503] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":382}}
[2019-08-13 15:08:16,504] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(382)
[2019-08-13 15:08:16,504] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(382)
[2019-08-13 15:08:16,504] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:16,504] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:16,504] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":386,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":21}}}
[2019-08-13 15:08:16,504] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":386,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":21}}}
[2019-08-13 15:08:16,504] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (51, 21).
[2019-08-13 15:08:16,504] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (51, 21).
[2019-08-13 15:08:16,505] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:16,505] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:16,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:08:16,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:08:16,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":44},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:16,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":44},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.signal.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:16,773] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:16,773] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:16,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:16,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:16,917] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":387,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:16,917] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":387,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:16,918] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":387}
[2019-08-13 15:08:16,918] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":387}
[2019-08-13 15:08:16,918] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":387}
[2019-08-13 15:08:16,918] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":387}
[2019-08-13 15:08:19,783] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:19,783] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:19,784] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":388,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":12}}}
[2019-08-13 15:08:19,784] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":388,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":12}}}
[2019-08-13 15:08:19,784] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 12).
[2019-08-13 15:08:19,784] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 12).
[2019-08-13 15:08:19,785] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:19,785] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:19,785] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:19,785] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:19,934] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:19,934] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:19,935] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":388}}
[2019-08-13 15:08:19,935] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":388}}
[2019-08-13 15:08:19,935] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(388)
[2019-08-13 15:08:19,935] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(388)
[2019-08-13 15:08:20,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:20,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:20,687] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":389,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":15}}}
[2019-08-13 15:08:20,687] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":389,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":15}}}
[2019-08-13 15:08:20,688] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 15).
[2019-08-13 15:08:20,688] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 15).
[2019-08-13 15:08:20,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:20,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:20,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:20,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:21,295] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:21,295] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:21,295] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":389}}
[2019-08-13 15:08:21,295] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":389}}
[2019-08-13 15:08:21,296] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(389)
[2019-08-13 15:08:21,296] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(389)
[2019-08-13 15:08:22,252] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:22,252] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:22,252] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":386}}
[2019-08-13 15:08:22,252] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":386}}
[2019-08-13 15:08:22,252] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(386)
[2019-08-13 15:08:22,252] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(386)
[2019-08-13 15:08:22,252] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2784
[2019-08-13 15:08:22,252] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2784
[2019-08-13 15:08:22,252] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":45},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:22,252] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":45},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.signal.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:22,253] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:22,253] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:22,253] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:22,253] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:22,253] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":390,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":15}}}
[2019-08-13 15:08:22,253] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":390,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":15}}}
[2019-08-13 15:08:22,254] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 15).
[2019-08-13 15:08:22,254] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 15).
[2019-08-13 15:08:22,254] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:22,254] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:22,312] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:22,312] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:22,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":390}}
[2019-08-13 15:08:22,312] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":390}}
[2019-08-13 15:08:22,313] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(390)
[2019-08-13 15:08:22,313] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(390)
[2019-08-13 15:08:22,313] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:22,313] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:22,313] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":391,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":15}}}
[2019-08-13 15:08:22,313] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":391,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":15}}}
[2019-08-13 15:08:22,314] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 15).
[2019-08-13 15:08:22,314] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 15).
[2019-08-13 15:08:22,315] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:22,315] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:22,465] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:22,465] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:22,465] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":392,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":14}}}
[2019-08-13 15:08:22,465] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":392,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":14}}}
[2019-08-13 15:08:22,466] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 14).
[2019-08-13 15:08:22,466] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 14).
[2019-08-13 15:08:22,466] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:22,466] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:22,466] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:22,466] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:22,557] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:22,557] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:22,557] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":393,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:22,557] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":393,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:22,558] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":393}
[2019-08-13 15:08:22,558] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":393}
[2019-08-13 15:08:22,558] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":393}
[2019-08-13 15:08:22,558] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":393}
[2019-08-13 15:08:22,640] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:22,640] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:22,640] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":392}}
[2019-08-13 15:08:22,640] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":392}}
[2019-08-13 15:08:22,641] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(392)
[2019-08-13 15:08:22,641] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(392)
[2019-08-13 15:08:23,206] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:23,206] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:23,206] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":391}}
[2019-08-13 15:08:23,206] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":391}}
[2019-08-13 15:08:23,207] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(391)
[2019-08-13 15:08:23,207] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(391)
[2019-08-13 15:08:23,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2783
[2019-08-13 15:08:23,207] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2783
[2019-08-13 15:08:23,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":46},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:23,207] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":46},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS signal FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:23,208] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:23,208] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:23,208] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:23,208] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:23,208] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":394,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":15}}}
[2019-08-13 15:08:23,208] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":394,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":15}}}
[2019-08-13 15:08:23,208] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 15).
[2019-08-13 15:08:23,208] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 15).
[2019-08-13 15:08:23,209] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:23,209] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:23,509] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:23,509] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:23,509] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":395,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:23,509] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":395,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:23,510] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":395}
[2019-08-13 15:08:23,510] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":395}
[2019-08-13 15:08:23,510] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":395}
[2019-08-13 15:08:23,510] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":395}
[2019-08-13 15:08:23,819] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:23,819] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:23,819] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":396,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":51}}}
[2019-08-13 15:08:23,819] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":396,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":51}}}
[2019-08-13 15:08:23,820] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 51).
[2019-08-13 15:08:23,820] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 51).
[2019-08-13 15:08:23,820] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:23,820] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:23,820] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:23,820] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:23,891] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:23,891] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:23,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":396}}
[2019-08-13 15:08:23,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":396}}
[2019-08-13 15:08:23,893] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(396)
[2019-08-13 15:08:23,893] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(396)
[2019-08-13 15:08:24,281] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:24,281] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:24,281] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":394}}
[2019-08-13 15:08:24,281] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":394}}
[2019-08-13 15:08:24,282] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(394)
[2019-08-13 15:08:24,282] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(394)
[2019-08-13 15:08:24,282] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:24,282] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:08:24,282] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":397,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":51}}}
[2019-08-13 15:08:24,282] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":397,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":51}}}
[2019-08-13 15:08:24,283] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 51).
[2019-08-13 15:08:24,283] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 51).
[2019-08-13 15:08:24,283] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:24,283] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:08:24,623] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2782
[2019-08-13 15:08:24,623] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2782
[2019-08-13 15:08:24,623] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":47},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:24,623] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":47},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.rxSpeed) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:08:24,625] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:24,625] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:08:24,734] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:24,734] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:08:24,734] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":398,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:24,734] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":398,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:08:24,736] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":398}
[2019-08-13 15:08:24,736] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":398}
[2019-08-13 15:08:24,736] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":398}
[2019-08-13 15:08:24,736] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":398}
[2019-08-13 15:08:35,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:08:35,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:08:35,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":399,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":66,"character":5}}}
[2019-08-13 15:08:35,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":399,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":66,"character":5}}}
[2019-08-13 15:08:35,737] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (66, 5).
[2019-08-13 15:08:35,737] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (66, 5).
[2019-08-13 15:08:35,738] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:35,738] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:35,738] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:35,738] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:35,786] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:35,786] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:35,787] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":399}}
[2019-08-13 15:08:35,787] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":399}}
[2019-08-13 15:08:35,787] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(399)
[2019-08-13 15:08:35,787] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(399)
[2019-08-13 15:08:38,011] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:38,011] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:38,012] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":400,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":61}}}
[2019-08-13 15:08:38,012] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":400,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":61}}}
[2019-08-13 15:08:38,012] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 61).
[2019-08-13 15:08:38,012] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 61).
[2019-08-13 15:08:38,013] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:38,013] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:38,013] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:38,013] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:38,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:38,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:38,060] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":400}}
[2019-08-13 15:08:38,060] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":400}}
[2019-08-13 15:08:38,061] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(400)
[2019-08-13 15:08:38,061] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(400)
[2019-08-13 15:08:44,424] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:44,424] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:44,424] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":401,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":35,"character":46}}}
[2019-08-13 15:08:44,424] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":401,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":35,"character":46}}}
[2019-08-13 15:08:44,425] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (35, 46).
[2019-08-13 15:08:44,425] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (35, 46).
[2019-08-13 15:08:44,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:44,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:44,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:44,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:44,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:44,917] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:44,917] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":401}}
[2019-08-13 15:08:44,917] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":401}}
[2019-08-13 15:08:44,918] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(401)
[2019-08-13 15:08:44,918] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(401)
[2019-08-13 15:08:45,068] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:45,068] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:08:45,068] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":402,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":36,"character":45}}}
[2019-08-13 15:08:45,068] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":402,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":36,"character":45}}}
[2019-08-13 15:08:45,069] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (36, 45).
[2019-08-13 15:08:45,069] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (36, 45).
[2019-08-13 15:08:45,069] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:45,069] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:08:45,070] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:45,070] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:08:47,797] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:47,797] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:08:47,798] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":402}}
[2019-08-13 15:08:47,798] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":402}}
[2019-08-13 15:08:47,798] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(402)
[2019-08-13 15:08:47,798] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(402)
[2019-08-13 15:09:40,860] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:09:40,860] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:09:40,861] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":403,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":2}}}
[2019-08-13 15:09:40,861] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":403,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":2}}}
[2019-08-13 15:09:40,862] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 2).
[2019-08-13 15:09:40,862] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 2).
[2019-08-13 15:09:40,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:09:40,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:09:40,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:09:40,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:09:41,076] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:09:41,076] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:09:41,077] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":403}}
[2019-08-13 15:09:41,077] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":403}}
[2019-08-13 15:09:41,077] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(403)
[2019-08-13 15:09:41,077] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(403)
[2019-08-13 15:11:07,009] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,009] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,009] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":404,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":0}}}
[2019-08-13 15:11:07,009] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":404,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":0}}}
[2019-08-13 15:11:07,010] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 0).
[2019-08-13 15:11:07,010] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 0).
[2019-08-13 15:11:07,011] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:07,011] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:07,011] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,011] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:07,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:07,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":404}}
[2019-08-13 15:11:07,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":404}}
[2019-08-13 15:11:07,058] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(404)
[2019-08-13 15:11:07,058] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(404)
[2019-08-13 15:11:07,308] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,308] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,309] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":405,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":4}}}
[2019-08-13 15:11:07,309] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":405,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":4}}}
[2019-08-13 15:11:07,309] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 4).
[2019-08-13 15:11:07,309] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 4).
[2019-08-13 15:11:07,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:07,310] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:07,359] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:07,359] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:07,359] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":405}}
[2019-08-13 15:11:07,359] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":405}}
[2019-08-13 15:11:07,360] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(405)
[2019-08-13 15:11:07,360] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(405)
[2019-08-13 15:11:07,610] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,610] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":406,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":2}}}
[2019-08-13 15:11:07,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":406,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":2}}}
[2019-08-13 15:11:07,611] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 2).
[2019-08-13 15:11:07,611] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 2).
[2019-08-13 15:11:07,612] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,612] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,612] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:07,612] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:07,660] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:07,660] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:07,660] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":406}}
[2019-08-13 15:11:07,660] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":406}}
[2019-08-13 15:11:07,661] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(406)
[2019-08-13 15:11:07,661] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(406)
[2019-08-13 15:11:07,811] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,811] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:07,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":407,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":2}}}
[2019-08-13 15:11:07,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":407,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":2}}}
[2019-08-13 15:11:07,812] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 2).
[2019-08-13 15:11:07,812] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 2).
[2019-08-13 15:11:07,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:07,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:07,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:08,713] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:08,713] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:08,713] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":407}}
[2019-08-13 15:11:08,713] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":407}}
[2019-08-13 15:11:08,714] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(407)
[2019-08-13 15:11:08,714] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(407)
[2019-08-13 15:11:08,864] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:08,864] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:08,864] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":408,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":2}}}
[2019-08-13 15:11:08,864] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":408,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":2}}}
[2019-08-13 15:11:08,865] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 2).
[2019-08-13 15:11:08,865] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 2).
[2019-08-13 15:11:08,865] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:08,865] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:08,865] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:08,865] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:08,914] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:08,914] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:08,914] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":408}}
[2019-08-13 15:11:08,914] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":408}}
[2019-08-13 15:11:08,915] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(408)
[2019-08-13 15:11:08,915] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(408)
[2019-08-13 15:11:11,335] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:11,335] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:11,335] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":409,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":1}}}
[2019-08-13 15:11:11,335] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":409,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":1}}}
[2019-08-13 15:11:11,336] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 1).
[2019-08-13 15:11:11,336] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 1).
[2019-08-13 15:11:11,336] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:11,336] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:11,336] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:11,336] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:11,821] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:11,821] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:11,822] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":409}}
[2019-08-13 15:11:11,822] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":409}}
[2019-08-13 15:11:11,822] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(409)
[2019-08-13 15:11:11,822] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(409)
[2019-08-13 15:11:14,981] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:14,981] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:11:14,981] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":410,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":5}}}
[2019-08-13 15:11:14,981] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":410,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":5}}}
[2019-08-13 15:11:14,982] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 5).
[2019-08-13 15:11:14,982] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 5).
[2019-08-13 15:11:14,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:14,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:14,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:14,982] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:15,217] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:15,217] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:15,217] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":410}}
[2019-08-13 15:11:15,217] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":410}}
[2019-08-13 15:11:15,217] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(410)
[2019-08-13 15:11:15,217] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(410)
[2019-08-13 15:11:49,948] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:11:49,948] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:11:49,948] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":411,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":51}}}
[2019-08-13 15:11:49,948] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":411,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":51}}}
[2019-08-13 15:11:49,949] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 51).
[2019-08-13 15:11:49,949] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 51).
[2019-08-13 15:11:49,949] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:49,949] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:49,950] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:49,950] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:50,099] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:50,099] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:50,099] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":411}}
[2019-08-13 15:11:50,099] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":411}}
[2019-08-13 15:11:50,100] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(411)
[2019-08-13 15:11:50,100] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(411)
[2019-08-13 15:11:59,103] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:11:59,103] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:11:59,103] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":412,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":31}}}
[2019-08-13 15:11:59,103] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":412,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":31}}}
[2019-08-13 15:11:59,104] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 31).
[2019-08-13 15:11:59,104] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 31).
[2019-08-13 15:11:59,104] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:59,104] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:59,104] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:11:59,104] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:11:59,181] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:59,181] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:11:59,181] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":412}}
[2019-08-13 15:11:59,181] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":412}}
[2019-08-13 15:11:59,181] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(412)
[2019-08-13 15:11:59,181] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(412)
[2019-08-13 15:12:00,852] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:12:00,852] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:12:00,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":413,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":32}}}
[2019-08-13 15:12:00,852] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":413,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":32}}}
[2019-08-13 15:12:00,853] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 32).
[2019-08-13 15:12:00,853] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 32).
[2019-08-13 15:12:00,853] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:12:00,853] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:12:00,854] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:12:00,854] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:12:00,902] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:12:00,902] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:12:00,902] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":413}}
[2019-08-13 15:12:00,902] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":413}}
[2019-08-13 15:12:00,903] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(413)
[2019-08-13 15:12:00,903] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(413)
[2019-08-13 15:12:01,053] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:12:01,053] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:12:01,053] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":414,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":31}}}
[2019-08-13 15:12:01,053] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":414,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":31}}}
[2019-08-13 15:12:01,053] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 31).
[2019-08-13 15:12:01,053] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 31).
[2019-08-13 15:12:01,054] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:12:01,054] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:12:01,054] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:12:01,054] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:12:01,085] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:12:01,085] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:12:01,086] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":414}}
[2019-08-13 15:12:01,086] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":414}}
[2019-08-13 15:12:01,086] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(414)
[2019-08-13 15:12:01,086] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(414)
[2019-08-13 15:12:02,580] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:12:02,580] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:12:02,580] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":415,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":36,"character":38}}}
[2019-08-13 15:12:02,580] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":415,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":36,"character":38}}}
[2019-08-13 15:12:02,581] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (36, 38).
[2019-08-13 15:12:02,581] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (36, 38).
[2019-08-13 15:12:02,581] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:12:02,581] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:12:02,581] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:12:02,581] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:12:02,626] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:12:02,626] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:12:02,627] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":415}}
[2019-08-13 15:12:02,627] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":415}}
[2019-08-13 15:12:02,627] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(415)
[2019-08-13 15:12:02,627] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(415)
[2019-08-13 15:13:22,069] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:22,069] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:22,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":416,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":18}}}
[2019-08-13 15:13:22,069] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":416,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":18}}}
[2019-08-13 15:13:22,070] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 18).
[2019-08-13 15:13:22,070] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 18).
[2019-08-13 15:13:22,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:22,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:22,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:22,071] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:22,211] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:22,211] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:22,212] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":416}}
[2019-08-13 15:13:22,212] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":416}}
[2019-08-13 15:13:22,213] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(416)
[2019-08-13 15:13:22,213] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(416)
[2019-08-13 15:13:22,463] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:22,463] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:22,463] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":417,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":20}}}
[2019-08-13 15:13:22,463] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":417,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":20}}}
[2019-08-13 15:13:22,463] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 20).
[2019-08-13 15:13:22,463] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 20).
[2019-08-13 15:13:22,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:22,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:22,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:22,464] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:23,524] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:23,524] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:23,524] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":417}}
[2019-08-13 15:13:23,524] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":417}}
[2019-08-13 15:13:23,525] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(417)
[2019-08-13 15:13:23,525] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(417)
[2019-08-13 15:13:23,788] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:23,788] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:23,788] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":418,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":15}}}
[2019-08-13 15:13:23,788] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":418,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":15}}}
[2019-08-13 15:13:23,789] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 15).
[2019-08-13 15:13:23,789] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 15).
[2019-08-13 15:13:23,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:23,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:23,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:23,790] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:23,843] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:23,843] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:23,843] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":418}}
[2019-08-13 15:13:23,843] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":418}}
[2019-08-13 15:13:23,843] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(418)
[2019-08-13 15:13:23,843] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(418)
[2019-08-13 15:13:24,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:24,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:13:24,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":419,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":15}}}
[2019-08-13 15:13:24,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":419,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":15}}}
[2019-08-13 15:13:24,124] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 15).
[2019-08-13 15:13:24,124] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 15).
[2019-08-13 15:13:24,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:24,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:24,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:13:24,125] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:13:24,166] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:24,166] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:13:24,166] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":419}}
[2019-08-13 15:13:24,166] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":419}}
[2019-08-13 15:13:24,167] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(419)
[2019-08-13 15:13:24,167] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(419)
[2019-08-13 15:14:15,048] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:15,048] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:15,049] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":420,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":22}}}
[2019-08-13 15:14:15,049] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":420,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":22}}}
[2019-08-13 15:14:15,049] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 22).
[2019-08-13 15:14:15,049] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 22).
[2019-08-13 15:14:15,050] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:15,050] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:15,050] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:15,050] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:15,099] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:15,099] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:15,099] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":420}}
[2019-08-13 15:14:15,099] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":420}}
[2019-08-13 15:14:15,100] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(420)
[2019-08-13 15:14:15,100] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(420)
[2019-08-13 15:14:15,249] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:15,249] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:15,249] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":421,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":21}}}
[2019-08-13 15:14:15,249] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":421,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":21}}}
[2019-08-13 15:14:15,249] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 21).
[2019-08-13 15:14:15,249] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 21).
[2019-08-13 15:14:15,249] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:15,249] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:15,249] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:15,249] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:15,273] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:15,273] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:15,273] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":421}}
[2019-08-13 15:14:15,273] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":421}}
[2019-08-13 15:14:15,273] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(421)
[2019-08-13 15:14:15,273] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(421)
[2019-08-13 15:14:18,094] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:14:18,094] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:14:18,094] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":48},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:18,094] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":48},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgRxSpeed,\n      MIN(x.after.rxSpeed) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:18,096] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:18,096] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:18,236] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:18,236] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:18,236] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":422,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:18,236] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":422,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:18,238] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":422}
[2019-08-13 15:14:18,238] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":422}
[2019-08-13 15:14:18,238] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":422}
[2019-08-13 15:14:18,238] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":422}
[2019-08-13 15:14:18,677] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:18,677] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:18,677] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":423,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":22}}}
[2019-08-13 15:14:18,677] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":423,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":22}}}
[2019-08-13 15:14:18,678] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 22).
[2019-08-13 15:14:18,678] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 22).
[2019-08-13 15:14:18,678] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:18,679] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:18,678] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:18,679] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:18,726] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:18,726] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:18,726] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":423}}
[2019-08-13 15:14:18,726] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":423}}
[2019-08-13 15:14:18,726] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(423)
[2019-08-13 15:14:18,726] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(423)
[2019-08-13 15:14:18,876] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:18,876] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:18,877] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":424,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":22}}}
[2019-08-13 15:14:18,877] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":424,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":22}}}
[2019-08-13 15:14:18,877] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 22).
[2019-08-13 15:14:18,877] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 22).
[2019-08-13 15:14:18,878] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:18,878] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:18,878] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:18,878] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:19,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:19,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:19,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":424}}
[2019-08-13 15:14:19,124] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":424}}
[2019-08-13 15:14:19,124] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(424)
[2019-08-13 15:14:19,124] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(424)
[2019-08-13 15:14:20,924] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2788
[2019-08-13 15:14:20,924] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2788
[2019-08-13 15:14:20,925] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":49},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgRxSpeed,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:20,925] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":49},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgRxSpeed,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.txSpeed) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:20,926] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:20,926] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:21,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:21,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:21,061] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":425,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:21,061] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":425,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:21,062] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":425}
[2019-08-13 15:14:21,062] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":425}
[2019-08-13 15:14:21,062] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":425}
[2019-08-13 15:14:21,062] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":425}
[2019-08-13 15:14:26,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2791
[2019-08-13 15:14:26,694] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2791
[2019-08-13 15:14:26,694] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":50},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgRxSpeed,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:26,694] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":50},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgRxSpeed,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:26,695] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:26,695] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:26,824] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:26,824] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:26,825] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":426,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:26,825] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":426,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:26,826] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":426}
[2019-08-13 15:14:26,826] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":426}
[2019-08-13 15:14:26,826] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":426}
[2019-08-13 15:14:26,826] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":426}
[2019-08-13 15:14:27,660] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:27,660] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:27,661] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":427,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:27,661] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":427,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:27,661] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:27,661] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:27,662] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:27,662] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:27,662] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:27,662] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:27,709] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:27,709] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:27,709] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":427}}
[2019-08-13 15:14:27,709] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":427}}
[2019-08-13 15:14:27,710] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(427)
[2019-08-13 15:14:27,710] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(427)
[2019-08-13 15:14:27,959] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:27,959] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:27,959] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":428,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":36}}}
[2019-08-13 15:14:27,959] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":428,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":36}}}
[2019-08-13 15:14:27,960] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 36).
[2019-08-13 15:14:27,960] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 36).
[2019-08-13 15:14:27,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:27,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:27,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:27,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:28,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:28,485] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:28,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":428}}
[2019-08-13 15:14:28,485] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":428}}
[2019-08-13 15:14:28,486] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(428)
[2019-08-13 15:14:28,486] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(428)
[2019-08-13 15:14:37,553] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:14:37,553] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:14:37,553] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":51},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgT,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:37,553] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":51},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgT,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:37,555] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:37,555] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:37,769] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2786
[2019-08-13 15:14:37,769] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2786
[2019-08-13 15:14:37,770] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":52},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTe,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:37,770] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":52},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTe,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:37,771] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:37,771] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:37,896] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:37,896] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:37,896] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":429,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:37,896] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":429,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:37,899] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":429}
[2019-08-13 15:14:37,899] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":429}
[2019-08-13 15:14:37,899] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":429}
[2019-08-13 15:14:37,899] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":429}
[2019-08-13 15:14:38,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2787
[2019-08-13 15:14:38,162] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2787
[2019-08-13 15:14:38,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":53},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTem,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:38,163] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":53},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTem,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:38,164] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:38,164] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:38,515] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2788
[2019-08-13 15:14:38,515] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2788
[2019-08-13 15:14:38,515] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":54},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTemp,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:38,515] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":54},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTemp,\n      MIN(x.after.patient_id) AS minRxSpeed,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:38,517] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:38,517] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:38,640] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:38,640] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:38,640] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":430,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:38,640] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":430,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:38,641] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":430}
[2019-08-13 15:14:38,641] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":430}
[2019-08-13 15:14:38,641] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":430}
[2019-08-13 15:14:38,641] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":430}
[2019-08-13 15:14:39,914] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:39,914] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:39,914] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":431,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":35}}}
[2019-08-13 15:14:39,914] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":431,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":35}}}
[2019-08-13 15:14:39,915] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 35).
[2019-08-13 15:14:39,915] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 35).
[2019-08-13 15:14:39,915] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:39,915] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:39,915] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:39,915] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:40,236] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:40,236] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:40,236] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":431}}
[2019-08-13 15:14:40,236] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":431}}
[2019-08-13 15:14:40,237] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(431)
[2019-08-13 15:14:40,237] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(431)
[2019-08-13 15:14:40,809] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:40,809] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:40,809] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":397}}
[2019-08-13 15:14:40,809] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":397}}
[2019-08-13 15:14:40,809] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(397)
[2019-08-13 15:14:40,809] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(397)
[2019-08-13 15:14:40,810] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:40,810] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:40,810] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":432,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:40,810] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":432,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:40,810] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:40,810] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:40,811] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:40,811] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:40,867] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:40,867] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:40,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":432}}
[2019-08-13 15:14:40,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":432}}
[2019-08-13 15:14:40,868] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(432)
[2019-08-13 15:14:40,868] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(432)
[2019-08-13 15:14:40,869] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:40,869] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:40,869] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":433,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":39}}}
[2019-08-13 15:14:40,869] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":433,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":39}}}
[2019-08-13 15:14:40,869] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 39).
[2019-08-13 15:14:40,869] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 39).
[2019-08-13 15:14:40,869] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:40,869] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,118] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:41,118] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:41,118] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":434,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":39}}}
[2019-08-13 15:14:41,118] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":434,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":39}}}
[2019-08-13 15:14:41,119] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 39).
[2019-08-13 15:14:41,119] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 39).
[2019-08-13 15:14:41,119] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:41,119] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:41,119] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:41,119] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:41,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,171] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":434}}
[2019-08-13 15:14:41,171] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":434}}
[2019-08-13 15:14:41,172] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(434)
[2019-08-13 15:14:41,172] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(434)
[2019-08-13 15:14:41,270] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,270] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,270] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":433}}
[2019-08-13 15:14:41,270] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":433}}
[2019-08-13 15:14:41,270] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(433)
[2019-08-13 15:14:41,270] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(433)
[2019-08-13 15:14:41,271] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,271] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,271] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":435,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:41,271] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":435,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:41,271] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:41,271] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:41,271] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,271] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,471] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,471] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,471] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":435}}
[2019-08-13 15:14:41,471] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":435}}
[2019-08-13 15:14:41,471] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(435)
[2019-08-13 15:14:41,471] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(435)
[2019-08-13 15:14:41,474] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,474] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,474] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":436,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:41,474] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":436,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:41,475] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:41,475] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:41,475] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,475] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,521] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:41,521] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:41,521] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":437,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":37}}}
[2019-08-13 15:14:41,521] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":437,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":37}}}
[2019-08-13 15:14:41,522] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 37).
[2019-08-13 15:14:41,522] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 37).
[2019-08-13 15:14:41,522] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:41,522] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:41,522] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:41,522] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:41,662] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,662] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,662] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":436}}
[2019-08-13 15:14:41,662] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":436}}
[2019-08-13 15:14:41,663] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(436)
[2019-08-13 15:14:41,663] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(436)
[2019-08-13 15:14:41,663] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,663] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,663] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":438,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:41,663] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":438,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":38}}}
[2019-08-13 15:14:41,664] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:41,664] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 38).
[2019-08-13 15:14:41,664] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,664] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,887] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,887] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,888] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":437}}
[2019-08-13 15:14:41,888] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":437}}
[2019-08-13 15:14:41,888] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(437)
[2019-08-13 15:14:41,888] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(437)
[2019-08-13 15:14:41,966] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,966] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:41,966] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":438}}
[2019-08-13 15:14:41,966] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":438}}
[2019-08-13 15:14:41,967] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(438)
[2019-08-13 15:14:41,967] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(438)
[2019-08-13 15:14:41,967] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,967] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:41,967] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":439,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":37}}}
[2019-08-13 15:14:41,967] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":439,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":37}}}
[2019-08-13 15:14:41,968] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 37).
[2019-08-13 15:14:41,968] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 37).
[2019-08-13 15:14:41,968] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:41,968] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:42,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:42,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:42,215] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":440,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":36}}}
[2019-08-13 15:14:42,215] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":440,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":36}}}
[2019-08-13 15:14:42,215] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 36).
[2019-08-13 15:14:42,215] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 36).
[2019-08-13 15:14:42,216] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:42,216] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:42,216] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:42,216] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:42,379] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:42,379] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:42,379] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":440}}
[2019-08-13 15:14:42,379] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":440}}
[2019-08-13 15:14:42,380] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(440)
[2019-08-13 15:14:42,380] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(440)
[2019-08-13 15:14:42,973] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:42,973] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:42,973] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":441,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":42}}}
[2019-08-13 15:14:42,973] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":441,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":42}}}
[2019-08-13 15:14:42,974] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 42).
[2019-08-13 15:14:42,974] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 42).
[2019-08-13 15:14:42,974] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:42,974] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:42,974] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:42,974] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:43,340] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:43,340] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:43,340] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":441}}
[2019-08-13 15:14:43,340] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":441}}
[2019-08-13 15:14:43,341] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(441)
[2019-08-13 15:14:43,341] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(441)
[2019-08-13 15:14:43,491] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:43,491] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:43,491] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":442,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":43}}}
[2019-08-13 15:14:43,491] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":442,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":43}}}
[2019-08-13 15:14:43,492] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 43).
[2019-08-13 15:14:43,492] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 43).
[2019-08-13 15:14:43,492] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:43,492] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:43,492] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:43,492] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:43,768] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:43,768] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:43,768] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":442}}
[2019-08-13 15:14:43,768] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":442}}
[2019-08-13 15:14:43,768] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(442)
[2019-08-13 15:14:43,768] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(442)
[2019-08-13 15:14:44,261] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:44,261] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:44,261] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":443,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":41}}}
[2019-08-13 15:14:44,261] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":443,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":41}}}
[2019-08-13 15:14:44,262] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 41).
[2019-08-13 15:14:44,262] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 41).
[2019-08-13 15:14:44,262] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:44,262] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:44,262] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:44,262] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:44,311] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:44,311] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:44,311] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":443}}
[2019-08-13 15:14:44,311] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":443}}
[2019-08-13 15:14:44,312] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(443)
[2019-08-13 15:14:44,312] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(443)
[2019-08-13 15:14:44,610] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:44,610] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:44,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":439}}
[2019-08-13 15:14:44,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":439}}
[2019-08-13 15:14:44,611] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(439)
[2019-08-13 15:14:44,611] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(439)
[2019-08-13 15:14:44,611] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:44,611] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:44,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":444,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":40}}}
[2019-08-13 15:14:44,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":444,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":40}}}
[2019-08-13 15:14:44,612] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 40).
[2019-08-13 15:14:44,612] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 40).
[2019-08-13 15:14:44,612] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:44,612] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:45,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:14:45,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2785
[2019-08-13 15:14:45,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":55},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTemp,\n      MIN(x.after.patient_id) AS minTemp,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:45,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":55},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgTemp,\n      MIN(x.after.patient_id) AS minTemp,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:45,377] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:45,377] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:45,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:45,522] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:45,522] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":445,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:45,522] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":445,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:45,523] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":445}
[2019-08-13 15:14:45,523] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":445}
[2019-08-13 15:14:45,523] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":445}
[2019-08-13 15:14:45,523] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":445}
[2019-08-13 15:14:46,059] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:46,059] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:46,059] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":446,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":35}}}
[2019-08-13 15:14:46,059] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":446,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":35}}}
[2019-08-13 15:14:46,059] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 35).
[2019-08-13 15:14:46,059] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 35).
[2019-08-13 15:14:46,060] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:46,060] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:46,060] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:46,060] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:46,109] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:46,109] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:46,109] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":446}}
[2019-08-13 15:14:46,109] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":446}}
[2019-08-13 15:14:46,109] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(446)
[2019-08-13 15:14:46,109] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(446)
[2019-08-13 15:14:46,862] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:46,862] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:46,862] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":447,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":40}}}
[2019-08-13 15:14:46,862] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":447,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":40}}}
[2019-08-13 15:14:46,863] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 40).
[2019-08-13 15:14:46,863] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 40).
[2019-08-13 15:14:46,863] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:46,863] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:46,863] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:46,863] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:47,130] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,130] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,131] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":447}}
[2019-08-13 15:14:47,131] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":447}}
[2019-08-13 15:14:47,131] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(447)
[2019-08-13 15:14:47,131] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(447)
[2019-08-13 15:14:47,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:47,280] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:47,281] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":448,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:47,281] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":448,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:47,282] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:47,282] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:47,282] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:47,282] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:47,282] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:47,282] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:47,330] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,330] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,330] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":448}}
[2019-08-13 15:14:47,330] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":448}}
[2019-08-13 15:14:47,331] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(448)
[2019-08-13 15:14:47,331] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(448)
[2019-08-13 15:14:47,480] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:47,480] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:47,481] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":449,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":37}}}
[2019-08-13 15:14:47,481] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":449,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":37}}}
[2019-08-13 15:14:47,481] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 37).
[2019-08-13 15:14:47,481] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 37).
[2019-08-13 15:14:47,482] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:47,482] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:47,482] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:47,482] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:47,630] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,630] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,630] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":449}}
[2019-08-13 15:14:47,630] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":449}}
[2019-08-13 15:14:47,631] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(449)
[2019-08-13 15:14:47,631] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(449)
[2019-08-13 15:14:47,780] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:47,780] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:47,781] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":450,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":36}}}
[2019-08-13 15:14:47,781] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":450,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":36}}}
[2019-08-13 15:14:47,781] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 36).
[2019-08-13 15:14:47,781] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 36).
[2019-08-13 15:14:47,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:47,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:47,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:47,782] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:47,830] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,830] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:47,831] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":450}}
[2019-08-13 15:14:47,831] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":450}}
[2019-08-13 15:14:47,831] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(450)
[2019-08-13 15:14:47,831] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(450)
[2019-08-13 15:14:48,388] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:48,388] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:48,388] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":451,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:48,388] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":451,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:48,389] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:48,389] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:48,389] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:48,389] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:48,389] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:48,389] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:48,438] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:48,438] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:48,439] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":451}}
[2019-08-13 15:14:48,439] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":451}}
[2019-08-13 15:14:48,439] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(451)
[2019-08-13 15:14:48,439] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(451)
[2019-08-13 15:14:48,589] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:48,589] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:48,589] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":452,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":39}}}
[2019-08-13 15:14:48,589] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":452,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":39}}}
[2019-08-13 15:14:48,590] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 39).
[2019-08-13 15:14:48,590] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 39).
[2019-08-13 15:14:48,590] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:48,590] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:48,590] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:48,590] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:48,890] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:48,890] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:48,890] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":452}}
[2019-08-13 15:14:48,890] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":452}}
[2019-08-13 15:14:48,891] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(452)
[2019-08-13 15:14:48,891] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(452)
[2019-08-13 15:14:49,040] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:49,040] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:49,041] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":453,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":40}}}
[2019-08-13 15:14:49,041] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":453,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":40}}}
[2019-08-13 15:14:49,041] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 40).
[2019-08-13 15:14:49,041] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 40).
[2019-08-13 15:14:49,042] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:49,042] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:49,042] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:49,042] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:49,088] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:49,088] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:49,088] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":453}}
[2019-08-13 15:14:49,088] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":453}}
[2019-08-13 15:14:49,089] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(453)
[2019-08-13 15:14:49,089] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(453)
[2019-08-13 15:14:52,602] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2784
[2019-08-13 15:14:52,602] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2784
[2019-08-13 15:14:52,602] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":58},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgAge,\n      MIN(x.after.patient_id) AS minTemp,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:52,602] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":58},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgAge,\n      MIN(x.after.patient_id) AS minTemp,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:14:52,603] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:52,603] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:14:52,727] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:52,727] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:14:52,728] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":454,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:52,728] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":454,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:14:52,729] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":454}
[2019-08-13 15:14:52,729] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":454}
[2019-08-13 15:14:52,729] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":454}
[2019-08-13 15:14:52,729] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":454}
[2019-08-13 15:14:53,954] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:53,954] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:53,954] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":455,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:53,954] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":455,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":38}}}
[2019-08-13 15:14:53,955] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:53,955] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 38).
[2019-08-13 15:14:53,955] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:53,955] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:53,955] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:53,955] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:54,007] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:54,007] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:54,008] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":455}}
[2019-08-13 15:14:54,008] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":455}}
[2019-08-13 15:14:54,008] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(455)
[2019-08-13 15:14:54,008] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(455)
[2019-08-13 15:14:55,160] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:55,160] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:55,160] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":456,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":39}}}
[2019-08-13 15:14:55,160] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":456,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":39}}}
[2019-08-13 15:14:55,160] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 39).
[2019-08-13 15:14:55,160] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 39).
[2019-08-13 15:14:55,160] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:55,160] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:55,160] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:55,160] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:55,518] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:55,518] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:55,518] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":456}}
[2019-08-13 15:14:55,518] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":456}}
[2019-08-13 15:14:55,518] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(456)
[2019-08-13 15:14:55,518] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(456)
[2019-08-13 15:14:55,907] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:55,907] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:55,907] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":444}}
[2019-08-13 15:14:55,907] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":444}}
[2019-08-13 15:14:55,908] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(444)
[2019-08-13 15:14:55,908] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(444)
[2019-08-13 15:14:55,908] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:55,908] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:55,908] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":457,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":38}}}
[2019-08-13 15:14:55,908] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":457,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":38}}}
[2019-08-13 15:14:55,908] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 38).
[2019-08-13 15:14:55,908] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 38).
[2019-08-13 15:14:55,908] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:55,908] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:56,292] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:56,292] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:56,292] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":458,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:14:56,292] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":458,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:14:56,292] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 36).
[2019-08-13 15:14:56,292] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 36).
[2019-08-13 15:14:56,292] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:56,292] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:56,292] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:56,292] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:56,349] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:56,349] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:56,349] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":458}}
[2019-08-13 15:14:56,349] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":458}}
[2019-08-13 15:14:56,349] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(458)
[2019-08-13 15:14:56,349] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(458)
[2019-08-13 15:14:56,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:56,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:56,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":459,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":35}}}
[2019-08-13 15:14:56,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":459,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":35}}}
[2019-08-13 15:14:56,598] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 35).
[2019-08-13 15:14:56,598] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 35).
[2019-08-13 15:14:56,599] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:56,599] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:56,599] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:56,599] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:56,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:56,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:56,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":457}}
[2019-08-13 15:14:56,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":457}}
[2019-08-13 15:14:56,628] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(457)
[2019-08-13 15:14:56,628] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(457)
[2019-08-13 15:14:56,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:56,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:56,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":460,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:14:56,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":460,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:14:56,629] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 36).
[2019-08-13 15:14:56,629] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 36).
[2019-08-13 15:14:56,629] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:56,629] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:57,275] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:57,275] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:57,275] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":459}}
[2019-08-13 15:14:57,275] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":459}}
[2019-08-13 15:14:57,276] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(459)
[2019-08-13 15:14:57,276] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(459)
[2019-08-13 15:14:57,343] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:57,343] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:57,343] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":460}}
[2019-08-13 15:14:57,343] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":460}}
[2019-08-13 15:14:57,344] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(460)
[2019-08-13 15:14:57,344] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(460)
[2019-08-13 15:14:57,344] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:57,344] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:57,344] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":461,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:14:57,344] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":461,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:14:57,344] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 36).
[2019-08-13 15:14:57,344] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 36).
[2019-08-13 15:14:57,344] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:57,344] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:57,594] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:57,594] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:57,594] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":462,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":40}}}
[2019-08-13 15:14:57,594] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":462,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":40}}}
[2019-08-13 15:14:57,595] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 40).
[2019-08-13 15:14:57,595] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 40).
[2019-08-13 15:14:57,595] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:57,595] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:57,595] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:57,595] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:57,644] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:57,644] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:57,644] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":462}}
[2019-08-13 15:14:57,644] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":462}}
[2019-08-13 15:14:57,644] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(462)
[2019-08-13 15:14:57,644] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(462)
[2019-08-13 15:14:57,894] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:57,894] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:57,894] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":463,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":36}}}
[2019-08-13 15:14:57,894] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":463,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":36}}}
[2019-08-13 15:14:57,894] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 36).
[2019-08-13 15:14:57,894] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 36).
[2019-08-13 15:14:57,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:57,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:57,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:57,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:58,047] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:58,047] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:58,047] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":463}}
[2019-08-13 15:14:58,047] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":463}}
[2019-08-13 15:14:58,048] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(463)
[2019-08-13 15:14:58,048] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(463)
[2019-08-13 15:14:58,787] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:58,787] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:58,787] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":464,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":41}}}
[2019-08-13 15:14:58,787] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":464,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":41}}}
[2019-08-13 15:14:58,787] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 41).
[2019-08-13 15:14:58,787] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 41).
[2019-08-13 15:14:58,787] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:58,787] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:58,788] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:58,788] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:58,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:58,919] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:58,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":464}}
[2019-08-13 15:14:58,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":464}}
[2019-08-13 15:14:58,920] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(464)
[2019-08-13 15:14:58,920] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(464)
[2019-08-13 15:14:59,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:59,171] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:59,172] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":465,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":40}}}
[2019-08-13 15:14:59,172] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":465,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":40}}}
[2019-08-13 15:14:59,172] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 40).
[2019-08-13 15:14:59,172] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 40).
[2019-08-13 15:14:59,173] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:59,173] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:59,173] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:59,173] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:59,239] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:59,239] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:59,239] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":465}}
[2019-08-13 15:14:59,239] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":465}}
[2019-08-13 15:14:59,240] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(465)
[2019-08-13 15:14:59,240] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(465)
[2019-08-13 15:14:59,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:59,598] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:59,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":461}}
[2019-08-13 15:14:59,598] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":461}}
[2019-08-13 15:14:59,599] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(461)
[2019-08-13 15:14:59,599] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(461)
[2019-08-13 15:14:59,599] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:59,599] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:59,599] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":466,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":39}}}
[2019-08-13 15:14:59,599] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":466,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":39}}}
[2019-08-13 15:14:59,600] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 39).
[2019-08-13 15:14:59,600] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (62, 39).
[2019-08-13 15:14:59,600] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:59,600] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:59,811] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:59,811] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:14:59,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":466}}
[2019-08-13 15:14:59,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":466}}
[2019-08-13 15:14:59,812] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(466)
[2019-08-13 15:14:59,812] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(466)
[2019-08-13 15:14:59,812] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:59,812] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:14:59,812] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":467,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":36}}}
[2019-08-13 15:14:59,812] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":467,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":36}}}
[2019-08-13 15:14:59,812] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 36).
[2019-08-13 15:14:59,812] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 36).
[2019-08-13 15:14:59,813] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:59,813] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:14:59,961] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:59,961] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:14:59,962] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":468,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":35}}}
[2019-08-13 15:14:59,962] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":468,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":35}}}
[2019-08-13 15:14:59,962] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 35).
[2019-08-13 15:14:59,962] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 35).
[2019-08-13 15:14:59,963] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:59,963] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:14:59,963] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:14:59,963] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:00,302] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:00,302] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:00,304] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":467}}
[2019-08-13 15:15:00,304] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":467}}
[2019-08-13 15:15:00,305] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(467)
[2019-08-13 15:15:00,305] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(467)
[2019-08-13 15:15:00,305] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:15:00,305] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:15:00,306] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":469,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":36}}}
[2019-08-13 15:15:00,306] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":469,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":36}}}
[2019-08-13 15:15:00,306] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 36).
[2019-08-13 15:15:00,306] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (64, 36).
[2019-08-13 15:15:00,307] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:15:00,307] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:15:00,762] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:00,762] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:00,763] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":468}}
[2019-08-13 15:15:00,763] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":468}}
[2019-08-13 15:15:00,764] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(468)
[2019-08-13 15:15:00,764] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(468)
[2019-08-13 15:15:01,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2783
[2019-08-13 15:15:01,503] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2783
[2019-08-13 15:15:01,504] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":59},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgAge,\n      MIN(x.after.patient_id) AS minAge,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:15:01,504] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":59},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgAge,\n      MIN(x.after.patient_id) AS minAge,\n      MAX(x.after.patient_id) AS maxTxSpeed\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:15:01,505] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:15:01,505] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:15:01,639] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:15:01,639] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:15:01,639] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":470,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:15:01,639] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":470,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:15:01,640] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":470}
[2019-08-13 15:15:01,640] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":470}
[2019-08-13 15:15:01,640] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":470}
[2019-08-13 15:15:01,640] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":470}
[2019-08-13 15:15:02,467] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:02,467] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:02,467] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":471,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:15:02,467] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":471,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":36}}}
[2019-08-13 15:15:02,468] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 36).
[2019-08-13 15:15:02,468] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 36).
[2019-08-13 15:15:02,468] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:02,468] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:02,468] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:02,468] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:02,970] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:02,970] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:02,971] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":471}}
[2019-08-13 15:15:02,971] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":471}}
[2019-08-13 15:15:02,971] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(471)
[2019-08-13 15:15:02,971] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(471)
[2019-08-13 15:15:03,997] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:03,997] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:03,997] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":472,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":43}}}
[2019-08-13 15:15:03,997] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":472,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":43}}}
[2019-08-13 15:15:03,998] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 43).
[2019-08-13 15:15:03,998] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 43).
[2019-08-13 15:15:03,998] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:03,998] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:03,998] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:03,998] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:04,453] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:04,453] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:04,453] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":472}}
[2019-08-13 15:15:04,453] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":472}}
[2019-08-13 15:15:04,454] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(472)
[2019-08-13 15:15:04,454] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(472)
[2019-08-13 15:15:05,714] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2779
[2019-08-13 15:15:05,714] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2779
[2019-08-13 15:15:05,715] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":60},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgAge,\n      MIN(x.after.patient_id) AS minAge,\n      MAX(x.after.patient_id) AS maxAge\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:15:05,715] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":60},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(x.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      x.after.creator AS creator,\n      AVG(x.after.patient_id) AS avgAge,\n      MIN(x.after.patient_id) AS minAge,\n      MAX(x.after.patient_id) AS maxAge\n    FROM\n      (SELECT EXPLODE(parsed_value.payload) AS after FROM patients) x\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:15:05,716] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:15:05,716] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:15:05,833] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:15:05,833] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:15:05,834] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":473,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:15:05,834] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":473,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:15:05,835] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":473}
[2019-08-13 15:15:05,835] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":473}
[2019-08-13 15:15:05,835] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":473}
[2019-08-13 15:15:05,835] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":473}
[2019-08-13 15:15:07,614] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:07,614] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:07,615] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":474,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":62}}}
[2019-08-13 15:15:07,615] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":474,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":62}}}
[2019-08-13 15:15:07,615] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 62).
[2019-08-13 15:15:07,615] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 62).
[2019-08-13 15:15:07,616] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:07,616] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:07,616] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:07,616] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:07,662] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:07,662] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:07,663] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":474}}
[2019-08-13 15:15:07,663] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":474}}
[2019-08-13 15:15:07,663] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(474)
[2019-08-13 15:15:07,663] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(474)
[2019-08-13 15:15:15,150] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:15,150] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:15,151] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":475,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:15:15,151] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":475,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:15:15,151] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 34).
[2019-08-13 15:15:15,151] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 34).
[2019-08-13 15:15:15,151] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:15,151] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:15,151] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:15,151] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:15,530] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:15,530] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:15,530] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":475}}
[2019-08-13 15:15:15,530] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":475}}
[2019-08-13 15:15:15,530] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(475)
[2019-08-13 15:15:15,530] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(475)
[2019-08-13 15:15:15,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:15,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:15,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":469}}
[2019-08-13 15:15:15,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":469}}
[2019-08-13 15:15:15,927] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(469)
[2019-08-13 15:15:15,927] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(469)
[2019-08-13 15:15:15,927] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:15:15,927] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:15:15,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":476,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:15:15,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":476,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:15:15,928] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 34).
[2019-08-13 15:15:15,928] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (61, 34).
[2019-08-13 15:15:15,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:15:15,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:15:16,000] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:16,000] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:16,000] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":477,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:15:16,000] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":477,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":34}}}
[2019-08-13 15:15:16,001] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 34).
[2019-08-13 15:15:16,001] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 34).
[2019-08-13 15:15:16,001] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:16,001] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:16,001] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:16,001] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:16,050] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:16,050] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:16,050] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":477}}
[2019-08-13 15:15:16,050] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":477}}
[2019-08-13 15:15:16,051] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(477)
[2019-08-13 15:15:16,051] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(477)
[2019-08-13 15:15:20,314] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:20,314] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:15:20,315] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":478,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":33}}}
[2019-08-13 15:15:20,315] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":478,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":62,"character":33}}}
[2019-08-13 15:15:20,315] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 33).
[2019-08-13 15:15:20,315] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (62, 33).
[2019-08-13 15:15:20,315] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:20,315] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:20,315] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:20,315] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:20,494] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:20,494] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:20,494] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":478}}
[2019-08-13 15:15:20,494] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":478}}
[2019-08-13 15:15:20,495] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(478)
[2019-08-13 15:15:20,495] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(478)
[2019-08-13 15:15:43,724] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:15:43,724] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:15:43,724] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":479,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":72,"character":6}}}
[2019-08-13 15:15:43,724] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":479,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":72,"character":6}}}
[2019-08-13 15:15:43,725] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (72, 6).
[2019-08-13 15:15:43,725] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (72, 6).
[2019-08-13 15:15:43,725] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:43,725] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:43,725] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:43,725] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:43,877] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:43,877] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:43,877] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":479}}
[2019-08-13 15:15:43,877] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":479}}
[2019-08-13 15:15:43,878] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(479)
[2019-08-13 15:15:43,878] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(479)
[2019-08-13 15:15:44,028] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:15:44,028] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:15:44,028] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":480,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":72,"character":5}}}
[2019-08-13 15:15:44,028] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":480,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":72,"character":5}}}
[2019-08-13 15:15:44,029] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (72, 5).
[2019-08-13 15:15:44,029] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (72, 5).
[2019-08-13 15:15:44,029] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:44,029] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:15:44,029] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:44,029] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:15:44,189] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:44,189] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:15:44,189] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":480}}
[2019-08-13 15:15:44,189] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":480}}
[2019-08-13 15:15:44,189] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(480)
[2019-08-13 15:15:44,189] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(480)
[2019-08-13 15:16:04,590] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:04,590] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:04,590] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":481,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":75,"character":8}}}
[2019-08-13 15:16:04,590] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":481,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":75,"character":8}}}
[2019-08-13 15:16:04,591] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (75, 8).
[2019-08-13 15:16:04,591] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (75, 8).
[2019-08-13 15:16:04,591] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:04,591] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:04,591] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:04,591] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:04,640] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:04,640] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:04,640] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":481}}
[2019-08-13 15:16:04,640] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":481}}
[2019-08-13 15:16:04,641] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(481)
[2019-08-13 15:16:04,641] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(481)
[2019-08-13 15:16:09,220] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:09,220] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:09,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":482,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":76,"character":5}}}
[2019-08-13 15:16:09,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":482,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":76,"character":5}}}
[2019-08-13 15:16:09,221] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (76, 5).
[2019-08-13 15:16:09,221] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (76, 5).
[2019-08-13 15:16:09,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:09,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:09,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:09,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:09,268] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:09,268] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:09,269] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":482}}
[2019-08-13 15:16:09,269] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":482}}
[2019-08-13 15:16:09,269] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(482)
[2019-08-13 15:16:09,269] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(482)
[2019-08-13 15:16:09,725] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:09,725] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:09,725] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":483,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":74,"character":1}}}
[2019-08-13 15:16:09,725] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":483,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":74,"character":1}}}
[2019-08-13 15:16:09,726] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (74, 1).
[2019-08-13 15:16:09,726] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (74, 1).
[2019-08-13 15:16:09,726] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:09,726] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:09,726] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:09,726] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:11,155] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:11,155] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:11,155] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":483}}
[2019-08-13 15:16:11,155] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":483}}
[2019-08-13 15:16:11,156] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(483)
[2019-08-13 15:16:11,156] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(483)
[2019-08-13 15:16:11,407] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:11,407] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:11,407] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":484,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":74,"character":2}}}
[2019-08-13 15:16:11,407] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":484,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":74,"character":2}}}
[2019-08-13 15:16:11,408] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (74, 2).
[2019-08-13 15:16:11,408] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (74, 2).
[2019-08-13 15:16:11,408] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:11,408] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:11,408] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:11,408] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:11,611] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:11,611] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:11,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":484}}
[2019-08-13 15:16:11,611] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":484}}
[2019-08-13 15:16:11,611] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(484)
[2019-08-13 15:16:11,611] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(484)
[2019-08-13 15:16:11,861] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:11,861] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:16:11,862] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":485,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":74,"character":1}}}
[2019-08-13 15:16:11,862] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":485,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":74,"character":1}}}
[2019-08-13 15:16:11,862] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (74, 1).
[2019-08-13 15:16:11,862] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (74, 1).
[2019-08-13 15:16:11,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:11,863] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:11,862] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:11,863] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:11,922] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:11,922] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:11,922] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":485}}
[2019-08-13 15:16:11,922] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":485}}
[2019-08-13 15:16:11,922] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(485)
[2019-08-13 15:16:11,922] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(485)
[2019-08-13 15:16:13,614] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:16:13,614] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:16:13,614] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":486,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":77,"character":22}}}
[2019-08-13 15:16:13,614] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":486,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":77,"character":22}}}
[2019-08-13 15:16:13,615] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (77, 22).
[2019-08-13 15:16:13,615] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (77, 22).
[2019-08-13 15:16:13,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:13,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:16:13,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:13,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:16:13,673] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:13,673] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:16:13,674] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":486}}
[2019-08-13 15:16:13,674] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":486}}
[2019-08-13 15:16:13,674] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(486)
[2019-08-13 15:16:13,674] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(486)
[2019-08-13 15:38:40,558] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:38:40,558] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:38:40,558] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":487,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":38}}}
[2019-08-13 15:38:40,558] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":487,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":64,"character":38}}}
[2019-08-13 15:38:40,559] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 38).
[2019-08-13 15:38:40,559] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (64, 38).
[2019-08-13 15:38:40,559] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:40,559] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:40,559] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:40,559] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:40,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:40,794] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:40,794] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":487}}
[2019-08-13 15:38:40,794] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":487}}
[2019-08-13 15:38:40,794] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(487)
[2019-08-13 15:38:40,794] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(487)
[2019-08-13 15:38:41,959] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:38:41,959] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:38:41,959] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":488,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":75,"character":32}}}
[2019-08-13 15:38:41,959] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":488,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":75,"character":32}}}
[2019-08-13 15:38:41,960] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (75, 32).
[2019-08-13 15:38:41,960] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (75, 32).
[2019-08-13 15:38:41,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:41,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:41,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:41,960] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:42,055] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:42,055] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:42,055] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":488}}
[2019-08-13 15:38:42,055] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":488}}
[2019-08-13 15:38:42,056] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(488)
[2019-08-13 15:38:42,056] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(488)
[2019-08-13 15:38:42,206] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:38:42,206] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:38:42,206] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":489,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":75,"character":31}}}
[2019-08-13 15:38:42,206] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":489,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":75,"character":31}}}
[2019-08-13 15:38:42,207] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (75, 31).
[2019-08-13 15:38:42,207] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (75, 31).
[2019-08-13 15:38:42,207] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:42,207] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:42,207] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:42,207] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:42,254] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:42,254] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:42,254] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":489}}
[2019-08-13 15:38:42,254] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":489}}
[2019-08-13 15:38:42,254] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(489)
[2019-08-13 15:38:42,254] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(489)
[2019-08-13 15:38:50,747] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:50,747] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:50,747] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":490,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":6}}}
[2019-08-13 15:38:50,747] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":490,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":6}}}
[2019-08-13 15:38:50,748] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 6).
[2019-08-13 15:38:50,748] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 6).
[2019-08-13 15:38:50,748] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:50,748] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:50,748] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:50,748] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:51,748] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:51,748] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:51,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":490}}
[2019-08-13 15:38:51,748] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":490}}
[2019-08-13 15:38:51,749] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(490)
[2019-08-13 15:38:51,749] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(490)
[2019-08-13 15:38:52,201] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:52,201] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:52,202] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":491,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":57,"character":4}}}
[2019-08-13 15:38:52,202] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":491,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":57,"character":4}}}
[2019-08-13 15:38:52,202] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (57, 4).
[2019-08-13 15:38:52,202] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (57, 4).
[2019-08-13 15:38:52,203] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:52,203] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:52,203] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:52,203] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:52,398] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:52,398] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:52,398] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":491}}
[2019-08-13 15:38:52,398] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":491}}
[2019-08-13 15:38:52,398] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(491)
[2019-08-13 15:38:52,398] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(491)
[2019-08-13 15:38:53,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:53,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:53,688] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":492,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":2}}}
[2019-08-13 15:38:53,688] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":492,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":58,"character":2}}}
[2019-08-13 15:38:53,688] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 2).
[2019-08-13 15:38:53,688] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (58, 2).
[2019-08-13 15:38:53,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:53,688] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:53,689] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:53,689] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:53,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:53,737] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:53,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":492}}
[2019-08-13 15:38:53,737] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":492}}
[2019-08-13 15:38:53,738] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(492)
[2019-08-13 15:38:53,738] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(492)
[2019-08-13 15:38:54,089] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:54,089] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 15:38:54,089] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":493,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":57,"character":3}}}
[2019-08-13 15:38:54,089] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":493,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":57,"character":3}}}
[2019-08-13 15:38:54,090] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (57, 3).
[2019-08-13 15:38:54,090] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (57, 3).
[2019-08-13 15:38:54,090] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:54,090] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:38:54,090] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:54,090] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:38:54,453] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:54,453] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:38:54,453] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":493}}
[2019-08-13 15:38:54,453] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":493}}
[2019-08-13 15:38:54,453] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(493)
[2019-08-13 15:38:54,453] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(493)
[2019-08-13 15:38:58,065] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2871
[2019-08-13 15:38:58,065] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2871
[2019-08-13 15:38:58,065] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":61},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n          WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n          parsed_value.payload.after.creator AS creator,\n          AVG(parsed_value.payload.after.patient_id) AS avgAge,\n          MIN(parsed_value.payload.after.patient_id) AS minAge,\n          MAX(parsed_value.payload.after.patient_id) AS maxAge\n        FROM\n          patients\n        GROUP BY\n          eventWindow,\n          creator\n        ORDER BY\n          eventWindow,\n          creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:38:58,065] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":61},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n          WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n          parsed_value.payload.after.creator AS creator,\n          AVG(parsed_value.payload.after.patient_id) AS avgAge,\n          MIN(parsed_value.payload.after.patient_id) AS minAge,\n          MAX(parsed_value.payload.after.patient_id) AS maxAge\n        FROM\n          patients\n        GROUP BY\n          eventWindow,\n          creator\n        ORDER BY\n          eventWindow,\n          creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:38:58,067] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:38:58,067] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:38:58,211] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:38:58,211] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:38:58,211] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":494,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:38:58,211] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":494,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:38:58,212] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":494}
[2019-08-13 15:38:58,212] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":494}
[2019-08-13 15:38:58,212] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":494}
[2019-08-13 15:38:58,212] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":494}
[2019-08-13 15:39:01,395] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2845
[2019-08-13 15:39:01,395] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2845
[2019-08-13 15:39:01,395] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":62},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n        WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n        parsed_value.payload.after.creator AS creator,\n        AVG(parsed_value.payload.after.patient_id) AS avgAge,\n        MIN(parsed_value.payload.after.patient_id) AS minAge,\n        MAX(parsed_value.payload.after.patient_id) AS maxAge\n      FROM\n        patients\n      GROUP BY\n        eventWindow,\n        creator\n      ORDER BY\n        eventWindow,\n        creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:39:01,395] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":62},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n        WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n        parsed_value.payload.after.creator AS creator,\n        AVG(parsed_value.payload.after.patient_id) AS avgAge,\n        MIN(parsed_value.payload.after.patient_id) AS minAge,\n        MAX(parsed_value.payload.after.patient_id) AS maxAge\n      FROM\n        patients\n      GROUP BY\n        eventWindow,\n        creator\n      ORDER BY\n        eventWindow,\n        creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:39:01,396] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:39:01,396] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:39:01,433] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:01,433] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:01,433] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":495,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":10}}}
[2019-08-13 15:39:01,433] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":495,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":60,"character":10}}}
[2019-08-13 15:39:01,434] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 10).
[2019-08-13 15:39:01,434] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (60, 10).
[2019-08-13 15:39:01,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:01,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:01,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:01,434] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:01,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:39:01,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:39:01,541] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":496,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:39:01,541] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":496,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:39:01,542] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":496}
[2019-08-13 15:39:01,542] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":496}
[2019-08-13 15:39:01,543] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":496}
[2019-08-13 15:39:01,543] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":496}
[2019-08-13 15:39:01,586] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:01,586] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:01,587] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":495}}
[2019-08-13 15:39:01,587] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":495}}
[2019-08-13 15:39:01,587] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(495)
[2019-08-13 15:39:01,587] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(495)
[2019-08-13 15:39:01,821] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2819
[2019-08-13 15:39:01,821] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2819
[2019-08-13 15:39:01,822] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":63},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:39:01,822] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":63},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:39:01,823] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:39:01,823] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:39:01,834] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:01,834] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:01,834] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":497,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":11}}}
[2019-08-13 15:39:01,834] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":497,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":11}}}
[2019-08-13 15:39:01,835] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 11).
[2019-08-13 15:39:01,835] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 11).
[2019-08-13 15:39:01,835] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:01,835] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:01,835] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:01,835] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:01,884] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:01,884] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:01,884] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":497}}
[2019-08-13 15:39:01,884] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":497}}
[2019-08-13 15:39:01,884] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(497)
[2019-08-13 15:39:01,884] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(497)
[2019-08-13 15:39:01,941] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:39:01,941] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:39:01,941] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":498,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:39:01,941] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":498,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:39:01,942] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":498}
[2019-08-13 15:39:01,942] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":498}
[2019-08-13 15:39:01,942] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":498}
[2019-08-13 15:39:01,942] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":498}
[2019-08-13 15:39:02,035] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:02,035] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:02,035] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":499,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":11}}}
[2019-08-13 15:39:02,035] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":499,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":11}}}
[2019-08-13 15:39:02,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 11).
[2019-08-13 15:39:02,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 11).
[2019-08-13 15:39:02,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:02,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:02,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:02,036] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:02,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:02,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:02,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":499}}
[2019-08-13 15:39:02,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":499}}
[2019-08-13 15:39:02,660] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(499)
[2019-08-13 15:39:02,660] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(499)
[2019-08-13 15:39:02,811] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:02,811] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:02,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":500,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":13}}}
[2019-08-13 15:39:02,811] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":500,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":61,"character":13}}}
[2019-08-13 15:39:02,812] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 13).
[2019-08-13 15:39:02,812] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (61, 13).
[2019-08-13 15:39:02,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:02,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:02,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:02,812] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:02,861] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:02,861] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:02,861] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":500}}
[2019-08-13 15:39:02,861] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":500}}
[2019-08-13 15:39:02,862] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(500)
[2019-08-13 15:39:02,862] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(500)
[2019-08-13 15:39:05,338] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:05,338] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:05,338] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":501,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:39:05,338] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":501,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:39:05,338] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 15:39:05,338] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 15:39:05,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:05,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:05,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:05,339] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:05,514] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:05,514] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:05,514] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":476}}
[2019-08-13 15:39:05,514] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":476}}
[2019-08-13 15:39:05,515] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(476)
[2019-08-13 15:39:05,515] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(476)
[2019-08-13 15:39:05,515] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:39:05,515] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:39:05,515] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":502,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":24}}}
[2019-08-13 15:39:05,515] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":502,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":24}}}
[2019-08-13 15:39:05,515] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 24).
[2019-08-13 15:39:05,515] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 24).
[2019-08-13 15:39:05,516] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:39:05,516] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:39:05,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:05,771] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:05,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":501}}
[2019-08-13 15:39:05,771] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":501}}
[2019-08-13 15:39:05,772] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(501)
[2019-08-13 15:39:05,772] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(501)
[2019-08-13 15:39:05,806] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2819
[2019-08-13 15:39:05,806] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2819
[2019-08-13 15:39:05,806] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":63},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:39:05,806] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":63},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:39:05,808] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:39:05,808] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:39:05,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 15:39:05,808] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 185
[2019-08-13 15:39:05,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":63}}}
[2019-08-13 15:39:05,808] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":63}}}
[2019-08-13 15:39:05,809] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala)
[2019-08-13 15:39:05,809] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala)
[2019-08-13 15:39:05,891] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:05,891] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:05,891] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":502}}
[2019-08-13 15:39:05,891] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":502}}
[2019-08-13 15:39:05,892] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(502)
[2019-08-13 15:39:05,892] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(502)
[2019-08-13 15:39:05,892] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:39:05,892] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 15:39:05,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":503,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:39:05,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":503,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:39:05,892] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 23).
[2019-08-13 15:39:05,892] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (59, 23).
[2019-08-13 15:39:05,893] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:39:05,893] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 15:39:06,041] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:06,041] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:39:06,041] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":504,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:39:06,041] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":504,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":59,"character":23}}}
[2019-08-13 15:39:06,042] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 15:39:06,042] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (59, 23).
[2019-08-13 15:39:06,042] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:06,042] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:39:06,043] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:06,043] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:39:06,091] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:06,091] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:39:06,091] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":504}}
[2019-08-13 15:39:06,091] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":504}}
[2019-08-13 15:39:06,092] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(504)
[2019-08-13 15:39:06,092] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(504)
[2019-08-13 15:58:32,118] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:58:32,118] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:58:32,118] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":505,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":35,"character":32}}}
[2019-08-13 15:58:32,118] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":505,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":35,"character":32}}}
[2019-08-13 15:58:32,118] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (35, 32).
[2019-08-13 15:58:32,118] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (35, 32).
[2019-08-13 15:58:32,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:58:32,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:58:32,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:58:32,120] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:58:33,533] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:58:33,533] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:58:33,533] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":505}}
[2019-08-13 15:58:33,533] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":505}}
[2019-08-13 15:58:33,533] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(505)
[2019-08-13 15:58:33,533] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(505)
[2019-08-13 15:58:33,839] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:58:33,839] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:58:33,839] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":506,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":32}}}
[2019-08-13 15:58:33,839] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":506,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":32}}}
[2019-08-13 15:58:33,839] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 32).
[2019-08-13 15:58:33,839] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 32).
[2019-08-13 15:58:33,840] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:58:33,840] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:58:33,840] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:58:33,840] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:58:35,815] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:58:35,815] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:58:35,815] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":506}}
[2019-08-13 15:58:35,815] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":506}}
[2019-08-13 15:58:35,815] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(506)
[2019-08-13 15:58:35,815] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(506)
[2019-08-13 15:59:18,782] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2827
[2019-08-13 15:59:18,782] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2827
[2019-08-13 15:59:18,783] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":66},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  \n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:18,783] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":66},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  \n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:18,784] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:18,784] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:18,903] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:18,903] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:18,903] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":507,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:18,903] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":507,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:18,904] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":507}
[2019-08-13 15:59:18,904] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":507}
[2019-08-13 15:59:18,904] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":507}
[2019-08-13 15:59:18,904] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":507}
[2019-08-13 15:59:19,202] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2959
[2019-08-13 15:59:19,202] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2959
[2019-08-13 15:59:19,202] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":67},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  castedDFS = spark.sql(\"select parsed_value.payload from sdfpatdientff\")\nprint(castedDFS.printSchema())\nprint(castedDFS.show(10))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:19,202] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":67},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  castedDFS = spark.sql(\"select parsed_value.payload from sdfpatdientff\")\nprint(castedDFS.printSchema())\nprint(castedDFS.show(10))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:19,204] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:19,204] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:19,348] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:19,348] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:19,349] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":508,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:19,349] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":508,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:19,350] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":508}
[2019-08-13 15:59:19,350] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":508}
[2019-08-13 15:59:19,350] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":508}
[2019-08-13 15:59:19,350] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":508}
[2019-08-13 15:59:21,353] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2827
[2019-08-13 15:59:21,353] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2827
[2019-08-13 15:59:21,353] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":68},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  \n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:21,353] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":68},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  \n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:21,354] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:21,354] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:21,500] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:21,500] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:21,500] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":509,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:21,500] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":509,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:21,502] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":509}
[2019-08-13 15:59:21,502] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":509}
[2019-08-13 15:59:21,502] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":509}
[2019-08-13 15:59:21,502] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":509}
[2019-08-13 15:59:21,873] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:21,873] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:21,874] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":510,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":34,"character":45}}}
[2019-08-13 15:59:21,874] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":510,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":34,"character":45}}}
[2019-08-13 15:59:21,874] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (34, 45).
[2019-08-13 15:59:21,874] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (34, 45).
[2019-08-13 15:59:21,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:21,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:21,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:21,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:22,075] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:22,075] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:22,076] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":510}}
[2019-08-13 15:59:22,076] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":510}}
[2019-08-13 15:59:22,076] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(510)
[2019-08-13 15:59:22,076] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(510)
[2019-08-13 15:59:24,149] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:24,149] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:24,150] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":511,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":17}}}
[2019-08-13 15:59:24,150] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":511,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":17}}}
[2019-08-13 15:59:24,151] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 17).
[2019-08-13 15:59:24,151] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 17).
[2019-08-13 15:59:24,152] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:24,152] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:24,152] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:24,152] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:24,199] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:24,199] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:24,199] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":511}}
[2019-08-13 15:59:24,199] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":511}}
[2019-08-13 15:59:24,199] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(511)
[2019-08-13 15:59:24,199] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(511)
[2019-08-13 15:59:25,854] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3370
[2019-08-13 15:59:25,854] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3370
[2019-08-13 15:59:25,854] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":69},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType([\n    StructField('patient_id', LongType(), True),\n    StructField('date_created', LongType(), True),\n    StructField('creator', LongType(), True)\n])\n\nschema= StructType([\n                StructField('schema', StringType()),\n                StructField('payload', \n                           StructType([\n                                StructField('before', StringType()),\n                                StructField('after', patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:25,854] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":69},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType([\n    StructField('patient_id', LongType(), True),\n    StructField('date_created', LongType(), True),\n    StructField('creator', LongType(), True)\n])\n\nschema= StructType([\n                StructField('schema', StringType()),\n                StructField('payload', \n                           StructType([\n                                StructField('before', StringType()),\n                                StructField('after', patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:25,856] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:25,856] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:25,956] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:25,956] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:25,956] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":512,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:25,956] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":512,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:25,958] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":512}
[2019-08-13 15:59:25,958] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":512}
[2019-08-13 15:59:25,958] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":512}
[2019-08-13 15:59:25,958] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":512}
[2019-08-13 15:59:27,138] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:27,138] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:27,138] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":513,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":31}}}
[2019-08-13 15:59:27,138] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":513,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":31}}}
[2019-08-13 15:59:27,139] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 31).
[2019-08-13 15:59:27,139] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 31).
[2019-08-13 15:59:27,139] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:27,139] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:27,139] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:27,139] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:27,347] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:27,347] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:27,347] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":513}}
[2019-08-13 15:59:27,347] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":513}}
[2019-08-13 15:59:27,347] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(513)
[2019-08-13 15:59:27,347] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(513)
[2019-08-13 15:59:27,699] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:27,699] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:27,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":514,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":33}}}
[2019-08-13 15:59:27,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":514,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":33}}}
[2019-08-13 15:59:27,700] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 33).
[2019-08-13 15:59:27,700] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 33).
[2019-08-13 15:59:27,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:27,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:27,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:27,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:27,848] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:27,848] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:27,849] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":514}}
[2019-08-13 15:59:27,849] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":514}}
[2019-08-13 15:59:27,849] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(514)
[2019-08-13 15:59:27,849] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(514)
[2019-08-13 15:59:28,927] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:28,927] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:28,928] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":515,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":20}}}
[2019-08-13 15:59:28,928] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":515,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":20}}}
[2019-08-13 15:59:28,928] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 20).
[2019-08-13 15:59:28,928] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 20).
[2019-08-13 15:59:28,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:28,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:28,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:28,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:30,374] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:30,374] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:30,374] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":515}}
[2019-08-13 15:59:30,374] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":515}}
[2019-08-13 15:59:30,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(515)
[2019-08-13 15:59:30,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(515)
[2019-08-13 15:59:30,826] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:30,826] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:30,826] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":516,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":22}}}
[2019-08-13 15:59:30,826] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":516,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":25,"character":22}}}
[2019-08-13 15:59:30,827] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 22).
[2019-08-13 15:59:30,827] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (25, 22).
[2019-08-13 15:59:30,827] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:30,827] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:30,827] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:30,827] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:30,947] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:30,947] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:30,947] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":516}}
[2019-08-13 15:59:30,947] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":516}}
[2019-08-13 15:59:30,948] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(516)
[2019-08-13 15:59:30,948] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(516)
[2019-08-13 15:59:31,799] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:31,799] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:31,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":517,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":33,"character":16}}}
[2019-08-13 15:59:31,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":517,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":33,"character":16}}}
[2019-08-13 15:59:31,799] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (33, 16).
[2019-08-13 15:59:31,799] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (33, 16).
[2019-08-13 15:59:31,800] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:31,800] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:31,800] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:31,800] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:31,847] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:31,847] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:31,848] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":517}}
[2019-08-13 15:59:31,848] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":517}}
[2019-08-13 15:59:31,848] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(517)
[2019-08-13 15:59:31,848] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(517)
[2019-08-13 15:59:31,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:31,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:31,998] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":518,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":33,"character":17}}}
[2019-08-13 15:59:31,998] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":518,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":33,"character":17}}}
[2019-08-13 15:59:31,999] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (33, 17).
[2019-08-13 15:59:31,999] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (33, 17).
[2019-08-13 15:59:31,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:31,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:31,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:31,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:32,443] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:32,443] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:32,444] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":518}}
[2019-08-13 15:59:32,444] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":518}}
[2019-08-13 15:59:32,444] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(518)
[2019-08-13 15:59:32,444] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(518)
[2019-08-13 15:59:33,196] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:33,196] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:33,197] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":519,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":26}}}
[2019-08-13 15:59:33,197] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":519,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":26}}}
[2019-08-13 15:59:33,197] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 26).
[2019-08-13 15:59:33,197] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 26).
[2019-08-13 15:59:33,198] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:33,198] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:33,198] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:33,198] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:33,247] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:33,247] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:33,247] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":519}}
[2019-08-13 15:59:33,247] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":519}}
[2019-08-13 15:59:33,248] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(519)
[2019-08-13 15:59:33,248] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(519)
[2019-08-13 15:59:34,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:34,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:34,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":520,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":15}}}
[2019-08-13 15:59:34,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":520,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":15}}}
[2019-08-13 15:59:34,473] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 15).
[2019-08-13 15:59:34,473] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 15).
[2019-08-13 15:59:34,474] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:34,474] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:34,474] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:34,474] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:34,878] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:34,878] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:34,878] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":520}}
[2019-08-13 15:59:34,878] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":520}}
[2019-08-13 15:59:34,879] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(520)
[2019-08-13 15:59:34,879] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(520)
[2019-08-13 15:59:35,029] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:35,029] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:35,029] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":521,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":16}}}
[2019-08-13 15:59:35,029] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":521,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":16}}}
[2019-08-13 15:59:35,030] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 16).
[2019-08-13 15:59:35,030] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 16).
[2019-08-13 15:59:35,030] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:35,030] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:35,030] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:35,030] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:35,232] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:35,232] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:35,233] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":521}}
[2019-08-13 15:59:35,233] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":521}}
[2019-08-13 15:59:35,233] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(521)
[2019-08-13 15:59:35,233] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(521)
[2019-08-13 15:59:36,035] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:36,035] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:36,036] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":522,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":19}}}
[2019-08-13 15:59:36,036] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":522,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":19}}}
[2019-08-13 15:59:36,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 19).
[2019-08-13 15:59:36,036] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 19).
[2019-08-13 15:59:36,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:36,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:36,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:36,037] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:36,922] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:36,922] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:36,922] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":522}}
[2019-08-13 15:59:36,922] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":522}}
[2019-08-13 15:59:36,922] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(522)
[2019-08-13 15:59:36,922] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(522)
[2019-08-13 15:59:54,272] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3384
[2019-08-13 15:59:54,272] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3384
[2019-08-13 15:59:54,272] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":70},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType([\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:54,272] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":70},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType([\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 15:59:54,274] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:54,274] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 15:59:54,389] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:54,389] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 15:59:54,389] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":523,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:54,389] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":523,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 15:59:54,390] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":523}
[2019-08-13 15:59:54,390] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":523}
[2019-08-13 15:59:54,390] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":523}
[2019-08-13 15:59:54,390] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":523}
[2019-08-13 15:59:55,658] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:55,658] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 15:59:55,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":524,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":44}}}
[2019-08-13 15:59:55,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":524,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":44}}}
[2019-08-13 15:59:55,659] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 44).
[2019-08-13 15:59:55,659] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 44).
[2019-08-13 15:59:55,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:55,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 15:59:55,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:55,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 15:59:55,716] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:55,716] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 15:59:55,716] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":524}}
[2019-08-13 15:59:55,716] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":524}}
[2019-08-13 15:59:55,717] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(524)
[2019-08-13 15:59:55,717] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(524)
[2019-08-13 16:00:01,466] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:01,466] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:01,466] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":525,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":35}}}
[2019-08-13 16:00:01,466] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":525,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":31,"character":35}}}
[2019-08-13 16:00:01,467] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 35).
[2019-08-13 16:00:01,467] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (31, 35).
[2019-08-13 16:00:01,467] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:01,467] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:01,467] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:01,467] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:01,516] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:01,516] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:01,516] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":525}}
[2019-08-13 16:00:01,516] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":525}}
[2019-08-13 16:00:01,517] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(525)
[2019-08-13 16:00:01,517] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(525)
[2019-08-13 16:00:01,667] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:01,667] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:01,667] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":526,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":35}}}
[2019-08-13 16:00:01,667] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":526,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":35}}}
[2019-08-13 16:00:01,668] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 35).
[2019-08-13 16:00:01,668] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 35).
[2019-08-13 16:00:01,668] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:01,668] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:01,668] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:01,668] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:01,818] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:01,818] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:01,818] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":526}}
[2019-08-13 16:00:01,818] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":526}}
[2019-08-13 16:00:01,819] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(526)
[2019-08-13 16:00:01,819] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(526)
[2019-08-13 16:00:05,475] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:05,475] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:05,475] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":527,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":18}}}
[2019-08-13 16:00:05,475] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":527,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":18}}}
[2019-08-13 16:00:05,476] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 18).
[2019-08-13 16:00:05,476] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 18).
[2019-08-13 16:00:05,476] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:05,476] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:05,476] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:05,476] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:05,723] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:05,723] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:05,724] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":527}}
[2019-08-13 16:00:05,724] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":527}}
[2019-08-13 16:00:05,724] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(527)
[2019-08-13 16:00:05,724] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(527)
[2019-08-13 16:00:12,520] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:00:12,520] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:00:12,521] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":71},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType[\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:12,521] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":71},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType[\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:12,521] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:12,521] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:12,668] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:12,668] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:12,668] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":528,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:12,668] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":528,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:12,669] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":528}
[2019-08-13 16:00:12,669] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":528}
[2019-08-13 16:00:12,669] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":528}
[2019-08-13 16:00:12,669] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":528}
[2019-08-13 16:00:14,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3392
[2019-08-13 16:00:14,060] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3392
[2019-08-13 16:00:14,061] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":72},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:14,061] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":72},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:14,063] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:14,063] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:14,209] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:14,209] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:14,209] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":529,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:14,209] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":529,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:14,210] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":529}
[2019-08-13 16:00:14,210] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":529}
[2019-08-13 16:00:14,210] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":529}
[2019-08-13 16:00:14,210] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":529}
[2019-08-13 16:00:15,508] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:15,508] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:15,509] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":73},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType()\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:15,509] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":73},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType()\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:15,510] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:15,510] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:15,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:15,628] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:15,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":530,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:15,628] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":530,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:15,630] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":530}
[2019-08-13 16:00:15,630] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":530}
[2019-08-13 16:00:15,630] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":530}
[2019-08-13 16:00:15,630] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":530}
[2019-08-13 16:00:16,302] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:00:16,302] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:00:16,302] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":74},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:16,302] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":74},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n])\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:16,304] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:16,304] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:16,448] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:16,448] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:16,448] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":531,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:16,448] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":531,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:16,449] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":531}
[2019-08-13 16:00:16,449] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":531}
[2019-08-13 16:00:16,449] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":531}
[2019-08-13 16:00:16,449] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":531}
[2019-08-13 16:00:17,614] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:17,614] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:17,614] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":532,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":0}}}
[2019-08-13 16:00:17,614] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":532,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":47,"character":0}}}
[2019-08-13 16:00:17,615] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 0).
[2019-08-13 16:00:17,615] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (47, 0).
[2019-08-13 16:00:17,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:17,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:17,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:17,615] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:17,963] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:17,963] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:17,963] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":532}}
[2019-08-13 16:00:17,963] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":532}}
[2019-08-13 16:00:17,964] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(532)
[2019-08-13 16:00:17,964] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(532)
[2019-08-13 16:00:18,650] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:18,650] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:18,651] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":533,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":9}}}
[2019-08-13 16:00:18,651] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":533,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":9}}}
[2019-08-13 16:00:18,651] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 9).
[2019-08-13 16:00:18,651] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 9).
[2019-08-13 16:00:18,651] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:18,651] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:18,651] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:18,651] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:19,179] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:19,179] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:19,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":533}}
[2019-08-13 16:00:19,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":533}}
[2019-08-13 16:00:19,180] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(533)
[2019-08-13 16:00:19,180] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(533)
[2019-08-13 16:00:19,381] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3392
[2019-08-13 16:00:19,381] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3392
[2019-08-13 16:00:19,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":75},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n)\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:19,381] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":75},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n)\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:19,383] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:19,383] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:19,528] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:19,528] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:19,529] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":534,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:19,529] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":534,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:19,530] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":534}
[2019-08-13 16:00:19,530] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":534}
[2019-08-13 16:00:19,530] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":534}
[2019-08-13 16:00:19,530] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":534}
[2019-08-13 16:00:19,772] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3395
[2019-08-13 16:00:19,772] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3395
[2019-08-13 16:00:19,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":76},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:19,772] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":76},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType(), True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:19,774] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:19,774] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:19,892] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:19,892] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:19,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":535,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:19,892] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":535,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:19,893] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":535}
[2019-08-13 16:00:19,893] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":535}
[2019-08-13 16:00:19,893] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":535}
[2019-08-13 16:00:19,893] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":535}
[2019-08-13 16:00:21,895] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:21,895] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:21,895] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":536,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":40}}}
[2019-08-13 16:00:21,895] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":536,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":40}}}
[2019-08-13 16:00:21,896] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 40).
[2019-08-13 16:00:21,896] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 40).
[2019-08-13 16:00:21,896] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:21,896] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:21,896] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:21,896] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:21,947] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:21,947] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:21,948] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":536}}
[2019-08-13 16:00:21,948] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":536}}
[2019-08-13 16:00:21,948] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(536)
[2019-08-13 16:00:21,948] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(536)
[2019-08-13 16:00:22,547] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:22,547] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:22,547] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":537,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":40}}}
[2019-08-13 16:00:22,547] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":537,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":40}}}
[2019-08-13 16:00:22,547] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 40).
[2019-08-13 16:00:22,547] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 40).
[2019-08-13 16:00:22,548] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:22,548] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:22,548] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:22,548] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:22,597] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:22,597] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:22,597] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":537}}
[2019-08-13 16:00:22,597] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":537}}
[2019-08-13 16:00:22,598] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(537)
[2019-08-13 16:00:22,598] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(537)
[2019-08-13 16:00:24,390] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:00:24,390] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:00:24,391] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":78},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:24,391] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":78},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType(), True),\n    StructField(\"creator\", LongType(), True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:24,392] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:24,392] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:24,538] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:24,538] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:24,538] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":538,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:24,538] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":538,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:24,539] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":538}
[2019-08-13 16:00:24,539] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":538}
[2019-08-13 16:00:24,539] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":538}
[2019-08-13 16:00:24,539] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":538}
[2019-08-13 16:00:24,874] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:24,874] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:24,874] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":539,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":43}}}
[2019-08-13 16:00:24,874] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":539,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":43}}}
[2019-08-13 16:00:24,875] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 43).
[2019-08-13 16:00:24,875] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 43).
[2019-08-13 16:00:24,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:24,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:24,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:24,875] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:25,226] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:25,226] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:25,227] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":539}}
[2019-08-13 16:00:25,227] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":539}}
[2019-08-13 16:00:25,227] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(539)
[2019-08-13 16:00:25,227] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(539)
[2019-08-13 16:00:25,377] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:25,377] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:25,378] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":540,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":45,"character":42}}}
[2019-08-13 16:00:25,378] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":540,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":45,"character":42}}}
[2019-08-13 16:00:25,378] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (45, 42).
[2019-08-13 16:00:25,378] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (45, 42).
[2019-08-13 16:00:25,378] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:25,378] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:25,378] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:25,378] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:25,641] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:25,641] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:25,641] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":540}}
[2019-08-13 16:00:25,641] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":540}}
[2019-08-13 16:00:25,642] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(540)
[2019-08-13 16:00:25,642] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(540)
[2019-08-13 16:00:26,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3391
[2019-08-13 16:00:26,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3391
[2019-08-13 16:00:26,692] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":80},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType(), True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:26,692] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":80},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType(), True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:26,693] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:26,693] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:26,840] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:26,840] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:26,840] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":541,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:26,840] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":541,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:26,841] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":541}
[2019-08-13 16:00:26,841] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":541}
[2019-08-13 16:00:26,841] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":541}
[2019-08-13 16:00:26,841] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":541}
[2019-08-13 16:00:27,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:27,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:27,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":542,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":36}}}
[2019-08-13 16:00:27,527] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":542,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":36}}}
[2019-08-13 16:00:27,527] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 36).
[2019-08-13 16:00:27,527] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 36).
[2019-08-13 16:00:27,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:27,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:27,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:27,528] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:27,856] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:27,856] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:27,856] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":542}}
[2019-08-13 16:00:27,856] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":542}}
[2019-08-13 16:00:27,857] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(542)
[2019-08-13 16:00:27,857] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(542)
[2019-08-13 16:00:28,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:28,146] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:28,146] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":543,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":37}}}
[2019-08-13 16:00:28,146] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":543,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":46,"character":37}}}
[2019-08-13 16:00:28,146] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 37).
[2019-08-13 16:00:28,146] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (46, 37).
[2019-08-13 16:00:28,147] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:28,147] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:28,147] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:28,147] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:28,194] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:28,194] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:28,194] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":543}}
[2019-08-13 16:00:28,194] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":543}}
[2019-08-13 16:00:28,195] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(543)
[2019-08-13 16:00:28,195] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(543)
[2019-08-13 16:00:28,795] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3389
[2019-08-13 16:00:28,795] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3389
[2019-08-13 16:00:28,796] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":82},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:28,796] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":82},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType()),\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:28,797] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:28,797] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:28,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:28,920] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:28,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":544,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:28,920] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":544,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:28,921] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":544}
[2019-08-13 16:00:28,921] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":544}
[2019-08-13 16:00:28,921] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":544}
[2019-08-13 16:00:28,921] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":544}
[2019-08-13 16:00:30,837] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:30,837] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:30,838] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":545,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":38}}}
[2019-08-13 16:00:30,838] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":545,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":38}}}
[2019-08-13 16:00:30,838] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 38).
[2019-08-13 16:00:30,838] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 38).
[2019-08-13 16:00:30,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:30,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:30,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:30,839] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:30,930] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:30,930] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:30,931] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":545}}
[2019-08-13 16:00:30,931] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":545}}
[2019-08-13 16:00:30,931] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(545)
[2019-08-13 16:00:30,931] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(545)
[2019-08-13 16:00:32,612] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:32,612] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:32,613] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":546,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":66}}}
[2019-08-13 16:00:32,613] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":546,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":66}}}
[2019-08-13 16:00:32,613] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 66).
[2019-08-13 16:00:32,613] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 66).
[2019-08-13 16:00:32,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:32,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:32,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:32,614] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:32,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:32,742] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:32,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":546}}
[2019-08-13 16:00:32,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":546}}
[2019-08-13 16:00:32,743] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(546)
[2019-08-13 16:00:32,743] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(546)
[2019-08-13 16:00:32,893] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:32,893] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:32,894] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":547,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":65}}}
[2019-08-13 16:00:32,894] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":547,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":65}}}
[2019-08-13 16:00:32,894] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 65).
[2019-08-13 16:00:32,894] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 65).
[2019-08-13 16:00:32,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:32,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:32,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:32,894] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:33,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:33,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:33,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":547}}
[2019-08-13 16:00:33,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":547}}
[2019-08-13 16:00:33,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(547)
[2019-08-13 16:00:33,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(547)
[2019-08-13 16:00:33,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:33,659] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:33,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":548,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":63}}}
[2019-08-13 16:00:33,659] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":548,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":63}}}
[2019-08-13 16:00:33,660] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 63).
[2019-08-13 16:00:33,660] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 63).
[2019-08-13 16:00:33,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:33,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:33,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:33,660] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:33,709] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:33,709] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:33,709] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":548}}
[2019-08-13 16:00:33,709] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":548}}
[2019-08-13 16:00:33,710] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(548)
[2019-08-13 16:00:33,710] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(548)
[2019-08-13 16:00:33,860] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:33,860] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:33,860] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":549,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":64}}}
[2019-08-13 16:00:33,860] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":549,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":64}}}
[2019-08-13 16:00:33,861] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 64).
[2019-08-13 16:00:33,861] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 64).
[2019-08-13 16:00:33,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:33,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:33,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:33,861] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:33,928] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:33,928] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:33,929] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":549}}
[2019-08-13 16:00:33,929] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":549}}
[2019-08-13 16:00:33,929] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(549)
[2019-08-13 16:00:33,929] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(549)
[2019-08-13 16:00:34,083] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:34,083] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:34,083] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":550,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":65}}}
[2019-08-13 16:00:34,083] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":550,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":65}}}
[2019-08-13 16:00:34,083] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 65).
[2019-08-13 16:00:34,083] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 65).
[2019-08-13 16:00:34,084] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:34,084] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:34,084] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:34,084] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:34,257] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:34,257] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:34,257] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":550}}
[2019-08-13 16:00:34,257] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":550}}
[2019-08-13 16:00:34,258] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(550)
[2019-08-13 16:00:34,258] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(550)
[2019-08-13 16:00:34,408] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:34,408] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:34,408] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":551,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":66}}}
[2019-08-13 16:00:34,408] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":551,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":66}}}
[2019-08-13 16:00:34,408] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 66).
[2019-08-13 16:00:34,408] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 66).
[2019-08-13 16:00:34,409] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:34,409] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:34,409] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:34,409] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:34,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:34,687] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:34,688] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":551}}
[2019-08-13 16:00:34,688] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":551}}
[2019-08-13 16:00:34,688] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(551)
[2019-08-13 16:00:34,688] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(551)
[2019-08-13 16:00:37,111] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3386
[2019-08-13 16:00:37,111] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3386
[2019-08-13 16:00:37,112] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":84},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:37,112] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":84},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType([\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:37,113] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:37,113] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:37,259] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:37,259] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:37,259] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":552,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:37,259] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":552,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:37,260] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":552}
[2019-08-13 16:00:37,260] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":552}
[2019-08-13 16:00:37,260] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":552}
[2019-08-13 16:00:37,260] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":552}
[2019-08-13 16:00:37,983] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:37,983] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:37,984] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":553,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":56}}}
[2019-08-13 16:00:37,984] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":553,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":56}}}
[2019-08-13 16:00:37,984] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 56).
[2019-08-13 16:00:37,984] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 56).
[2019-08-13 16:00:37,984] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:37,984] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:37,984] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:37,984] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:38,032] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:38,032] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:38,033] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":553}}
[2019-08-13 16:00:38,033] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":553}}
[2019-08-13 16:00:38,033] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(553)
[2019-08-13 16:00:38,033] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(553)
[2019-08-13 16:00:38,183] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:38,183] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:38,183] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":554,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":57}}}
[2019-08-13 16:00:38,183] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":554,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":57}}}
[2019-08-13 16:00:38,184] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 57).
[2019-08-13 16:00:38,184] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 57).
[2019-08-13 16:00:38,184] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:38,184] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:38,184] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:38,184] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:38,219] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:38,219] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:38,219] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":554}}
[2019-08-13 16:00:38,219] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":554}}
[2019-08-13 16:00:38,220] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(554)
[2019-08-13 16:00:38,220] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(554)
[2019-08-13 16:00:39,699] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:39,699] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:39,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":555,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":0}}}
[2019-08-13 16:00:39,699] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":555,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":0}}}
[2019-08-13 16:00:39,700] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 0).
[2019-08-13 16:00:39,700] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 0).
[2019-08-13 16:00:39,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:39,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:39,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:39,700] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:39,847] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:39,847] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:39,847] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":555}}
[2019-08-13 16:00:39,847] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":555}}
[2019-08-13 16:00:39,848] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(555)
[2019-08-13 16:00:39,848] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(555)
[2019-08-13 16:00:39,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:39,998] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:00:39,998] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":556,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":0}}}
[2019-08-13 16:00:39,998] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":556,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":0}}}
[2019-08-13 16:00:39,999] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 0).
[2019-08-13 16:00:39,999] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 0).
[2019-08-13 16:00:39,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:40,000] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:39,999] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:40,000] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:40,414] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:40,414] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:40,415] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":556}}
[2019-08-13 16:00:40,415] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":556}}
[2019-08-13 16:00:40,416] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(556)
[2019-08-13 16:00:40,416] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(556)
[2019-08-13 16:00:43,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3385
[2019-08-13 16:00:43,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3385
[2019-08-13 16:00:43,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":85},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:43,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":85},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:43,216] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:43,216] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:43,356] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:43,356] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:43,356] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":557,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:43,356] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":557,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:43,356] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":557}
[2019-08-13 16:00:43,356] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":557}
[2019-08-13 16:00:43,356] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":557}
[2019-08-13 16:00:43,356] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":557}
[2019-08-13 16:00:44,351] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:44,351] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:44,351] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":86},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:44,351] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":86},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:44,352] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:44,352] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:44,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:44,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:44,501] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":558,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:44,501] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":558,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:44,501] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":558}
[2019-08-13 16:00:44,501] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":558}
[2019-08-13 16:00:44,501] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":558}
[2019-08-13 16:00:44,501] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":558}
[2019-08-13 16:00:46,326] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3396
[2019-08-13 16:00:46,326] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3396
[2019-08-13 16:00:46,326] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":87},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType()\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:46,326] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":87},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType()\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:46,327] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:46,327] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:46,449] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:46,449] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:46,449] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":559,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:46,449] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":559,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:46,450] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":559}
[2019-08-13 16:00:46,450] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":559}
[2019-08-13 16:00:46,450] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":559}
[2019-08-13 16:00:46,450] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":559}
[2019-08-13 16:00:47,916] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3395
[2019-08-13 16:00:47,916] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3395
[2019-08-13 16:00:47,916] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":88},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:47,916] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":88},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:47,917] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:47,917] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:48,063] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:48,063] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:48,063] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":560,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:48,063] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":560,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:48,064] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":560}
[2019-08-13 16:00:48,064] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":560}
[2019-08-13 16:00:48,064] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":560}
[2019-08-13 16:00:48,064] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":560}
[2019-08-13 16:00:49,646] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:49,646] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:49,646] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":561,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":57,"character":12}}}
[2019-08-13 16:00:49,646] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":561,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":57,"character":12}}}
[2019-08-13 16:00:49,646] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (57, 12).
[2019-08-13 16:00:49,646] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (57, 12).
[2019-08-13 16:00:49,647] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:49,647] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:49,647] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:49,647] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:49,796] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:49,796] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:49,797] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":561}}
[2019-08-13 16:00:49,797] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":561}}
[2019-08-13 16:00:49,797] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(561)
[2019-08-13 16:00:49,797] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(561)
[2019-08-13 16:00:51,306] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:51,306] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:51,307] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":89},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:51,307] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":89},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:51,308] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:51,308] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:51,455] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:51,455] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:51,455] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":562,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:51,455] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":562,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:51,456] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":562}
[2019-08-13 16:00:51,456] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":562}
[2019-08-13 16:00:51,456] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":562}
[2019-08-13 16:00:51,456] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":562}
[2019-08-13 16:00:52,041] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3385
[2019-08-13 16:00:52,041] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3385
[2019-08-13 16:00:52,041] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":91},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n)())\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:52,041] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":91},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n)())\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:52,043] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:52,043] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:52,191] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:52,191] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:52,191] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":563,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:52,191] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":563,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:52,192] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":563}
[2019-08-13 16:00:52,192] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":563}
[2019-08-13 16:00:52,192] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":563}
[2019-08-13 16:00:52,192] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":563}
[2019-08-13 16:00:53,244] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:00:53,244] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:00:53,244] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":92},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:53,244] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":92},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:53,246] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:53,246] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:53,391] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:53,391] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:53,391] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":564,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:53,391] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":564,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:53,392] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":564}
[2019-08-13 16:00:53,392] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":564}
[2019-08-13 16:00:53,392] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":564}
[2019-08-13 16:00:53,392] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":564}
[2019-08-13 16:00:54,591] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3395
[2019-08-13 16:00:54,591] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3395
[2019-08-13 16:00:54,591] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":94},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:54,591] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":94},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            ])\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:54,592] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:54,592] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:54,711] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:54,711] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:54,711] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":565,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:54,711] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":565,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:54,712] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":565}
[2019-08-13 16:00:54,712] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":565}
[2019-08-13 16:00:54,712] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":565}
[2019-08-13 16:00:54,712] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":565}
[2019-08-13 16:00:55,466] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:55,466] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:00:55,467] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":95},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:55,467] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":95},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n            )\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:55,468] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:55,468] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:55,615] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:55,615] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:55,615] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":566,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:55,615] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":566,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:55,616] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":566}
[2019-08-13 16:00:55,616] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":566}
[2019-08-13 16:00:55,616] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":566}
[2019-08-13 16:00:55,616] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":566}
[2019-08-13 16:00:56,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:00:56,621] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:00:56,621] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":96},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:56,621] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":96},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ])\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:00:56,623] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:56,623] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:00:56,738] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:56,738] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:00:56,739] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":567,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:56,739] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":567,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:00:56,740] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":567}
[2019-08-13 16:00:56,740] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":567}
[2019-08-13 16:00:56,740] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":567}
[2019-08-13 16:00:56,740] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":567}
[2019-08-13 16:00:58,889] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:58,889] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:00:58,889] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":568,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":29}}}
[2019-08-13 16:00:58,889] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":568,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":55,"character":29}}}
[2019-08-13 16:00:58,890] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 29).
[2019-08-13 16:00:58,890] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (55, 29).
[2019-08-13 16:00:58,890] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:58,890] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:00:58,890] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:58,890] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:00:58,940] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:58,940] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:00:58,940] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":568}}
[2019-08-13 16:00:58,940] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":568}}
[2019-08-13 16:00:58,941] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(568)
[2019-08-13 16:00:58,941] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(568)
[2019-08-13 16:01:00,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3382
[2019-08-13 16:01:00,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3382
[2019-08-13 16:01:00,596] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":97},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           )\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:00,596] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":97},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           )\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:00,598] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:00,598] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:00,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:01:00,926] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:01:00,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":98},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:00,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":98},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType([\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:00,928] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:00,928] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:01,050] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:01,050] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:01,050] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":569,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:01,050] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":569,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:01,051] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":569}
[2019-08-13 16:01:01,051] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":569}
[2019-08-13 16:01:01,051] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":569}
[2019-08-13 16:01:01,051] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":569}
[2019-08-13 16:01:02,420] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:02,420] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:02,420] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":570,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":52,"character":38}}}
[2019-08-13 16:01:02,420] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":570,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":52,"character":38}}}
[2019-08-13 16:01:02,421] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (52, 38).
[2019-08-13 16:01:02,421] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (52, 38).
[2019-08-13 16:01:02,421] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:02,421] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:02,421] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:02,421] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:03,317] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:03,317] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:03,318] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":570}}
[2019-08-13 16:01:03,318] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":570}}
[2019-08-13 16:01:03,318] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(570)
[2019-08-13 16:01:03,318] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(570)
[2019-08-13 16:01:04,546] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3382
[2019-08-13 16:01:04,546] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3382
[2019-08-13 16:01:04,547] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":99},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:04,547] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":99},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:04,548] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:04,548] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:04,863] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3392
[2019-08-13 16:01:04,863] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3392
[2019-08-13 16:01:04,863] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":100},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(ArrayType\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:04,863] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":100},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(ArrayType\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:04,865] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:04,865] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:05,010] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:05,010] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:05,010] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":571,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:05,010] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":571,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:05,011] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":571}
[2019-08-13 16:01:05,011] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":571}
[2019-08-13 16:01:05,011] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":571}
[2019-08-13 16:01:05,011] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":571}
[2019-08-13 16:01:06,474] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:01:06,474] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3394
[2019-08-13 16:01:06,474] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":101},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(ArrayType()\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:06,474] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":101},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(ArrayType()\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:06,475] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:06,475] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:06,595] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:06,595] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:06,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":572,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:06,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":572,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:06,597] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":572}
[2019-08-13 16:01:06,597] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":572}
[2019-08-13 16:01:06,597] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":572}
[2019-08-13 16:01:06,597] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":572}
[2019-08-13 16:01:07,652] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:01:07,652] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3393
[2019-08-13 16:01:07,652] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":102},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:07,652] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":102},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType()),\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:07,653] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:07,653] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:07,799] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:07,799] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:07,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":573,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:07,799] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":573,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:07,800] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":573}
[2019-08-13 16:01:07,800] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":573}
[2019-08-13 16:01:07,800] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":573}
[2019-08-13 16:01:07,800] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":573}
[2019-08-13 16:01:09,720] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:09,720] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:09,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":574,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":51}}}
[2019-08-13 16:01:09,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":574,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":51}}}
[2019-08-13 16:01:09,721] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 51).
[2019-08-13 16:01:09,721] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 51).
[2019-08-13 16:01:09,721] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:09,721] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:09,721] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:09,721] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:09,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:09,770] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:09,770] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":574}}
[2019-08-13 16:01:09,770] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":574}}
[2019-08-13 16:01:09,771] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(574)
[2019-08-13 16:01:09,771] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(574)
[2019-08-13 16:01:10,020] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:10,020] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:10,020] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":575,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":49}}}
[2019-08-13 16:01:10,020] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":575,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":49}}}
[2019-08-13 16:01:10,021] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 49).
[2019-08-13 16:01:10,021] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 49).
[2019-08-13 16:01:10,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:10,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:10,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:10,021] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:10,172] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:10,172] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:10,172] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":575}}
[2019-08-13 16:01:10,172] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":575}}
[2019-08-13 16:01:10,173] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(575)
[2019-08-13 16:01:10,173] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(575)
[2019-08-13 16:01:16,051] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3390
[2019-08-13 16:01:16,051] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3390
[2019-08-13 16:01:16,052] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":104},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:16,052] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":104},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\n  patient= StructType(ArrayType(\n    StructField(\"patient_id\", LongType, True),\n    StructField(\"date_created\", LongType, True),\n    StructField(\"creator\", LongType, True)\n  ))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:16,053] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:16,053] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:16,191] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:16,191] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:16,191] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":576,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:16,191] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":576,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:16,192] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":576}
[2019-08-13 16:01:16,192] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":576}
[2019-08-13 16:01:16,192] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":576}
[2019-08-13 16:01:16,192] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":576}
[2019-08-13 16:01:20,426] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:20,426] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:20,427] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":577,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":35}}}
[2019-08-13 16:01:20,427] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":577,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":35}}}
[2019-08-13 16:01:20,427] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 35).
[2019-08-13 16:01:20,427] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 35).
[2019-08-13 16:01:20,427] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:20,427] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:20,427] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:20,427] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:20,496] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:20,496] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:20,496] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":577}}
[2019-08-13 16:01:20,496] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":577}}
[2019-08-13 16:01:20,497] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(577)
[2019-08-13 16:01:20,497] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(577)
[2019-08-13 16:01:20,950] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:20,950] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:20,950] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":578,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":39}}}
[2019-08-13 16:01:20,950] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":578,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":39}}}
[2019-08-13 16:01:20,950] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 39).
[2019-08-13 16:01:20,950] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 39).
[2019-08-13 16:01:20,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:20,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:20,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:20,951] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:20,985] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:20,985] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:20,985] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":578}}
[2019-08-13 16:01:20,985] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":578}}
[2019-08-13 16:01:20,986] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(578)
[2019-08-13 16:01:20,986] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(578)
[2019-08-13 16:01:21,135] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:21,135] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:21,136] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":579,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":39}}}
[2019-08-13 16:01:21,136] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":579,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":39}}}
[2019-08-13 16:01:21,136] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 39).
[2019-08-13 16:01:21,136] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 39).
[2019-08-13 16:01:21,136] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:21,136] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:21,136] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:21,136] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:22,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:22,057] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:22,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":579}}
[2019-08-13 16:01:22,057] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":579}}
[2019-08-13 16:01:22,057] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(579)
[2019-08-13 16:01:22,057] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(579)
[2019-08-13 16:01:24,013] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:24,013] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:24,013] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":580,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":39}}}
[2019-08-13 16:01:24,013] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":580,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":51,"character":39}}}
[2019-08-13 16:01:24,014] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 39).
[2019-08-13 16:01:24,014] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (51, 39).
[2019-08-13 16:01:24,014] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:24,014] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:24,014] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:24,014] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:24,121] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:24,121] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:24,122] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":580}}
[2019-08-13 16:01:24,122] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":580}}
[2019-08-13 16:01:24,122] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(580)
[2019-08-13 16:01:24,122] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(580)
[2019-08-13 16:01:24,799] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:24,799] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:24,800] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":581,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":2}}}
[2019-08-13 16:01:24,800] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":581,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":2}}}
[2019-08-13 16:01:24,800] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 2).
[2019-08-13 16:01:24,800] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (44, 2).
[2019-08-13 16:01:24,801] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:24,801] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:24,801] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:24,801] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:25,152] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:25,152] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:25,152] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":581}}
[2019-08-13 16:01:25,152] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":581}}
[2019-08-13 16:01:25,152] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(581)
[2019-08-13 16:01:25,152] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(581)
[2019-08-13 16:01:25,303] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:25,303] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:25,303] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":582,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":2}}}
[2019-08-13 16:01:25,303] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":582,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":2}}}
[2019-08-13 16:01:25,304] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 2).
[2019-08-13 16:01:25,304] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 2).
[2019-08-13 16:01:25,304] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:25,304] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:25,304] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:25,304] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:25,452] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:25,452] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:25,452] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":582}}
[2019-08-13 16:01:25,452] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":582}}
[2019-08-13 16:01:25,452] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(582)
[2019-08-13 16:01:25,452] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(582)
[2019-08-13 16:01:26,951] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3380
[2019-08-13 16:01:26,951] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3380
[2019-08-13 16:01:26,951] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":105},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\npatient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:26,951] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":105},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\npatient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:26,952] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:26,952] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:27,095] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:27,095] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:27,096] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":583,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:27,096] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":583,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:27,097] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":583}
[2019-08-13 16:01:27,097] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":583}
[2019-08-13 16:01:27,097] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":583}
[2019-08-13 16:01:27,097] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":583}
[2019-08-13 16:01:27,741] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:27,741] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:27,741] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":584,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":52,"character":10}}}
[2019-08-13 16:01:27,741] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":584,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":52,"character":10}}}
[2019-08-13 16:01:27,742] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (52, 10).
[2019-08-13 16:01:27,742] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (52, 10).
[2019-08-13 16:01:27,742] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:27,742] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:27,742] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:27,742] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:27,789] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:27,789] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:27,789] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":584}}
[2019-08-13 16:01:27,789] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":584}}
[2019-08-13 16:01:27,790] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(584)
[2019-08-13 16:01:27,790] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(584)
[2019-08-13 16:01:28,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:28,541] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:28,541] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":585,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":0}}}
[2019-08-13 16:01:28,541] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":585,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":0}}}
[2019-08-13 16:01:28,542] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 0).
[2019-08-13 16:01:28,542] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 0).
[2019-08-13 16:01:28,542] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:28,542] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:28,542] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:28,542] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:28,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:28,692] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:28,693] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":585}}
[2019-08-13 16:01:28,693] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":585}}
[2019-08-13 16:01:28,693] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(585)
[2019-08-13 16:01:28,693] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(585)
[2019-08-13 16:01:30,293] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:30,293] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:30,293] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":586,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":52,"character":17}}}
[2019-08-13 16:01:30,293] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":586,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":52,"character":17}}}
[2019-08-13 16:01:30,294] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (52, 17).
[2019-08-13 16:01:30,294] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (52, 17).
[2019-08-13 16:01:30,294] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:30,294] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:30,294] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:30,294] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:30,343] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:30,343] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:30,343] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":586}}
[2019-08-13 16:01:30,343] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":586}}
[2019-08-13 16:01:30,344] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(586)
[2019-08-13 16:01:30,344] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(586)
[2019-08-13 16:01:33,505] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:33,505] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:33,505] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":587,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":34,"character":18}}}
[2019-08-13 16:01:33,505] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":587,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":34,"character":18}}}
[2019-08-13 16:01:33,506] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (34, 18).
[2019-08-13 16:01:33,506] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (34, 18).
[2019-08-13 16:01:33,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:33,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:33,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:33,506] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:33,650] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:33,650] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:33,650] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":587}}
[2019-08-13 16:01:33,650] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":587}}
[2019-08-13 16:01:33,651] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(587)
[2019-08-13 16:01:33,651] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(587)
[2019-08-13 16:01:34,233] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:34,233] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:34,233] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":588,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":19}}}
[2019-08-13 16:01:34,233] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":588,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":49,"character":19}}}
[2019-08-13 16:01:34,234] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 19).
[2019-08-13 16:01:34,234] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (49, 19).
[2019-08-13 16:01:34,234] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:34,234] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:34,234] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:34,234] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:34,379] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:34,379] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:34,379] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":588}}
[2019-08-13 16:01:34,379] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":588}}
[2019-08-13 16:01:34,379] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(588)
[2019-08-13 16:01:34,379] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(588)
[2019-08-13 16:01:38,343] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:38,343] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:38,343] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":589,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":56,"character":27}}}
[2019-08-13 16:01:38,343] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":589,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":56,"character":27}}}
[2019-08-13 16:01:38,343] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (56, 27).
[2019-08-13 16:01:38,343] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (56, 27).
[2019-08-13 16:01:38,344] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:38,344] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:38,344] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:38,344] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:38,380] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:38,380] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:38,380] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":589}}
[2019-08-13 16:01:38,380] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":589}}
[2019-08-13 16:01:38,380] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(589)
[2019-08-13 16:01:38,380] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(589)
[2019-08-13 16:01:38,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:38,743] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:38,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":590,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":56,"character":28}}}
[2019-08-13 16:01:38,743] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":590,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":56,"character":28}}}
[2019-08-13 16:01:38,743] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (56, 28).
[2019-08-13 16:01:38,743] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (56, 28).
[2019-08-13 16:01:38,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:38,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:38,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:38,744] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:38,981] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:38,981] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:38,982] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":590}}
[2019-08-13 16:01:38,982] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":590}}
[2019-08-13 16:01:38,982] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(590)
[2019-08-13 16:01:38,982] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(590)
[2019-08-13 16:01:39,437] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:39,437] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:39,437] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":591,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":29}}}
[2019-08-13 16:01:39,437] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":591,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":63,"character":29}}}
[2019-08-13 16:01:39,437] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 29).
[2019-08-13 16:01:39,437] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (63, 29).
[2019-08-13 16:01:39,438] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:39,438] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:39,438] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:39,438] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:40,364] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:40,364] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:40,365] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":591}}
[2019-08-13 16:01:40,365] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":591}}
[2019-08-13 16:01:40,365] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(591)
[2019-08-13 16:01:40,365] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(591)
[2019-08-13 16:01:45,272] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:45,272] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:45,272] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":592,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":0}}}
[2019-08-13 16:01:45,272] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":592,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":24,"character":0}}}
[2019-08-13 16:01:45,272] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 0).
[2019-08-13 16:01:45,272] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (24, 0).
[2019-08-13 16:01:45,272] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:45,272] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:45,272] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:45,272] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:45,435] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:45,435] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:45,435] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":592}}
[2019-08-13 16:01:45,435] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":592}}
[2019-08-13 16:01:45,435] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(592)
[2019-08-13 16:01:45,435] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(592)
[2019-08-13 16:01:46,556] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:46,556] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:46,556] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":593,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":29,"character":6}}}
[2019-08-13 16:01:46,556] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":593,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":29,"character":6}}}
[2019-08-13 16:01:46,557] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (29, 6).
[2019-08-13 16:01:46,557] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (29, 6).
[2019-08-13 16:01:46,557] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:46,557] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:46,557] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:46,557] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:46,579] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:46,579] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:46,579] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":503}}
[2019-08-13 16:01:46,579] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":503}}
[2019-08-13 16:01:46,579] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(503)
[2019-08-13 16:01:46,579] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(503)
[2019-08-13 16:01:46,579] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:46,579] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:46,579] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":594,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":29,"character":7}}}
[2019-08-13 16:01:46,579] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":594,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":29,"character":7}}}
[2019-08-13 16:01:46,579] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (29, 7).
[2019-08-13 16:01:46,579] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (29, 7).
[2019-08-13 16:01:46,579] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:46,579] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:46,706] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:46,706] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:46,707] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":593}}
[2019-08-13 16:01:46,707] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":593}}
[2019-08-13 16:01:46,707] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(593)
[2019-08-13 16:01:46,707] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(593)
[2019-08-13 16:01:46,955] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:46,955] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:46,955] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":595,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":5}}}
[2019-08-13 16:01:46,955] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":595,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":30,"character":5}}}
[2019-08-13 16:01:46,955] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 5).
[2019-08-13 16:01:46,955] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (30, 5).
[2019-08-13 16:01:46,956] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:46,956] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:46,956] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:46,956] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:47,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:47,123] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:47,123] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":595}}
[2019-08-13 16:01:47,123] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":595}}
[2019-08-13 16:01:47,123] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(595)
[2019-08-13 16:01:47,123] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(595)
[2019-08-13 16:01:49,047] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:49,047] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:49,047] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":596,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":0}}}
[2019-08-13 16:01:49,047] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":596,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":0}}}
[2019-08-13 16:01:49,047] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 0).
[2019-08-13 16:01:49,047] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 0).
[2019-08-13 16:01:49,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:49,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:49,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:49,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:49,096] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:49,096] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:49,097] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":596}}
[2019-08-13 16:01:49,097] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":596}}
[2019-08-13 16:01:49,097] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(596)
[2019-08-13 16:01:49,097] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(596)
[2019-08-13 16:01:49,890] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:49,890] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:49,890] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":597,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":0}}}
[2019-08-13 16:01:49,890] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":597,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":0}}}
[2019-08-13 16:01:49,891] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 0).
[2019-08-13 16:01:49,891] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (43, 0).
[2019-08-13 16:01:49,891] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:49,891] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:49,891] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:49,891] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:50,058] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,058] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,058] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":597}}
[2019-08-13 16:01:50,058] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":597}}
[2019-08-13 16:01:50,059] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(597)
[2019-08-13 16:01:50,059] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(597)
[2019-08-13 16:01:50,229] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,229] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,229] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":594}}
[2019-08-13 16:01:50,229] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":594}}
[2019-08-13 16:01:50,230] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(594)
[2019-08-13 16:01:50,230] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(594)
[2019-08-13 16:01:50,230] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:50,230] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:50,230] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":598,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":0}}}
[2019-08-13 16:01:50,230] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":598,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":43,"character":0}}}
[2019-08-13 16:01:50,230] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (43, 0).
[2019-08-13 16:01:50,230] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (43, 0).
[2019-08-13 16:01:50,231] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:50,231] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:50,374] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,374] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,374] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":598}}
[2019-08-13 16:01:50,374] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":598}}
[2019-08-13 16:01:50,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(598)
[2019-08-13 16:01:50,375] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(598)
[2019-08-13 16:01:50,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:50,375] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:50,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":599,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":2}}}
[2019-08-13 16:01:50,375] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":599,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":44,"character":2}}}
[2019-08-13 16:01:50,375] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (44, 2).
[2019-08-13 16:01:50,375] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (44, 2).
[2019-08-13 16:01:50,376] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:50,376] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:50,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,472] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":599}}
[2019-08-13 16:01:50,472] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":599}}
[2019-08-13 16:01:50,473] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(599)
[2019-08-13 16:01:50,473] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(599)
[2019-08-13 16:01:50,473] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:01:50,473] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3383
[2019-08-13 16:01:50,473] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":106},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nvalpatient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:50,473] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":106},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nvalpatient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:50,474] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:50,474] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:50,474] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:50,474] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 221
[2019-08-13 16:01:50,474] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":600,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":45,"character":5}}}
[2019-08-13 16:01:50,474] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":600,"method":"textDocument/definition","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":45,"character":5}}}
[2019-08-13 16:01:50,474] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (45, 5).
[2019-08-13 16:01:50,474] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got goto definition request at (45, 5).
[2019-08-13 16:01:50,474] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:50,474] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Goto Definition future completed: succes? false
[2019-08-13 16:01:50,792] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:50,792] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:50,793] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":601,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:50,793] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":601,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:50,794] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":601}
[2019-08-13 16:01:50,794] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":601}
[2019-08-13 16:01:50,794] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":601}
[2019-08-13 16:01:50,794] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":601}
[2019-08-13 16:01:50,824] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:50,824] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:50,824] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":602,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":45,"character":6}}}
[2019-08-13 16:01:50,824] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":602,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":45,"character":6}}}
[2019-08-13 16:01:50,824] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (45, 6).
[2019-08-13 16:01:50,824] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (45, 6).
[2019-08-13 16:01:50,825] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:50,825] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:50,825] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:50,825] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:50,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,868] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:50,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":602}}
[2019-08-13 16:01:50,868] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":602}}
[2019-08-13 16:01:50,869] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(602)
[2019-08-13 16:01:50,869] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(602)
[2019-08-13 16:01:51,070] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3384
[2019-08-13 16:01:51,070] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3384
[2019-08-13 16:01:51,070] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":107},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:51,070] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":107},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:51,072] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:51,072] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:51,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:51,215] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:51,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":603,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:51,216] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":603,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:51,217] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":603}
[2019-08-13 16:01:51,217] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":603}
[2019-08-13 16:01:51,217] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":603}
[2019-08-13 16:01:51,217] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":603}
[2019-08-13 16:01:52,445] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:52,445] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:52,446] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":604,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":0}}}
[2019-08-13 16:01:52,446] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":604,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":0}}}
[2019-08-13 16:01:52,446] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 0).
[2019-08-13 16:01:52,446] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 0).
[2019-08-13 16:01:52,446] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:52,446] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:52,446] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:52,446] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:52,595] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:52,595] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:52,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":604}}
[2019-08-13 16:01:52,595] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":604}}
[2019-08-13 16:01:52,595] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(604)
[2019-08-13 16:01:52,595] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(604)
[2019-08-13 16:01:53,418] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:53,418] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:53,418] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":605,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":6}}}
[2019-08-13 16:01:53,418] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":605,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":6}}}
[2019-08-13 16:01:53,419] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 6).
[2019-08-13 16:01:53,419] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 6).
[2019-08-13 16:01:53,419] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:53,419] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:53,419] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:53,419] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:53,436] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:53,436] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:53,436] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":605}}
[2019-08-13 16:01:53,436] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":605}}
[2019-08-13 16:01:53,437] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(605)
[2019-08-13 16:01:53,437] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(605)
[2019-08-13 16:01:53,638] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3387
[2019-08-13 16:01:53,638] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3387
[2019-08-13 16:01:53,639] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":108},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nvalschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:53,639] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":108},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nvalschema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:53,640] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:53,640] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:53,720] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:53,720] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:01:53,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":606,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":7}}}
[2019-08-13 16:01:53,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":606,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":53,"character":7}}}
[2019-08-13 16:01:53,720] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 7).
[2019-08-13 16:01:53,720] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (53, 7).
[2019-08-13 16:01:53,720] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:53,720] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:53,720] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:53,720] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:53,765] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:53,765] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:53,765] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":606}}
[2019-08-13 16:01:53,765] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":606}}
[2019-08-13 16:01:53,765] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(606)
[2019-08-13 16:01:53,765] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(606)
[2019-08-13 16:01:53,965] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3388
[2019-08-13 16:01:53,965] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 3388
[2019-08-13 16:01:53,965] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":109},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:53,965] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":109},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n  val schema = StructType(\n    List(\n      StructField(\"deviceId\", StringType, true),\n      StructField(\"time\", LongType, true),\n      StructField(\"signals\", ArrayType(StructType(Array(\n        StructField(\"time\", LongType, true),\n        StructField(\"networkType\", StringType, true),\n        StructField(\"rxSpeed\", DoubleType, true),\n        StructField(\"txSpeed\", DoubleType, true),\n        StructField(\"rxData\", LongType, true),\n        StructField(\"txData\", LongType, true),\n        StructField(\"latitude\", DoubleType, true),\n        StructField(\"longitude\", DoubleType, true)\n      ))))\n    )\n  )\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:01:53,965] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:53,965] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:01:54,117] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:54,117] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:01:54,117] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":607,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:54,117] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":607,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:01:54,118] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":607}
[2019-08-13 16:01:54,118] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":607}
[2019-08-13 16:01:54,118] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":607}
[2019-08-13 16:01:54,118] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":607}
[2019-08-13 16:01:54,424] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:54,424] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:54,424] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":608,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":34}}}
[2019-08-13 16:01:54,424] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":608,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":34}}}
[2019-08-13 16:01:54,425] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 34).
[2019-08-13 16:01:54,425] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 34).
[2019-08-13 16:01:54,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:54,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:54,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:54,425] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:54,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:54,501] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:54,501] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":608}}
[2019-08-13 16:01:54,501] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":608}}
[2019-08-13 16:01:54,502] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(608)
[2019-08-13 16:01:54,502] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(608)
[2019-08-13 16:01:55,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:55,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:55,174] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":609,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":40}}}
[2019-08-13 16:01:55,174] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":609,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":40}}}
[2019-08-13 16:01:55,175] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 40).
[2019-08-13 16:01:55,175] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 40).
[2019-08-13 16:01:55,175] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:55,175] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:55,175] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:55,175] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:55,776] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:55,776] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:55,776] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":609}}
[2019-08-13 16:01:55,776] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":609}}
[2019-08-13 16:01:55,777] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(609)
[2019-08-13 16:01:55,777] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(609)
[2019-08-13 16:01:55,927] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:55,927] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:55,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":610,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":40}}}
[2019-08-13 16:01:55,927] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":610,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":67,"character":40}}}
[2019-08-13 16:01:55,927] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 40).
[2019-08-13 16:01:55,927] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (67, 40).
[2019-08-13 16:01:55,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:55,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:55,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:55,928] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:56,329] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:56,329] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:56,329] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":610}}
[2019-08-13 16:01:56,329] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":610}}
[2019-08-13 16:01:56,330] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(610)
[2019-08-13 16:01:56,330] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(610)
[2019-08-13 16:01:59,656] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:59,656] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:01:59,657] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":611,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":54}}}
[2019-08-13 16:01:59,657] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":611,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":54,"character":54}}}
[2019-08-13 16:01:59,657] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 54).
[2019-08-13 16:01:59,657] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (54, 54).
[2019-08-13 16:01:59,657] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:59,657] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:59,657] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:01:59,657] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:01:59,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:59,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:01:59,705] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":611}}
[2019-08-13 16:01:59,705] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":611}}
[2019-08-13 16:01:59,706] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(611)
[2019-08-13 16:01:59,706] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(611)
[2019-08-13 16:02:01,704] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:01,704] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:01,704] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":612,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":37}}}
[2019-08-13 16:02:01,704] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":612,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":50,"character":37}}}
[2019-08-13 16:02:01,705] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 37).
[2019-08-13 16:02:01,705] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (50, 37).
[2019-08-13 16:02:01,705] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:01,705] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:01,705] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:01,705] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:01,831] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:01,831] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:01,831] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":612}}
[2019-08-13 16:02:01,831] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":612}}
[2019-08-13 16:02:01,832] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(612)
[2019-08-13 16:02:01,832] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(612)
[2019-08-13 16:02:08,558] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2748
[2019-08-13 16:02:08,558] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2748
[2019-08-13 16:02:08,558] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":110},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:08,558] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":110},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:08,560] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:08,560] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:08,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:08,705] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:08,706] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":613,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:08,706] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":613,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:08,706] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":613}
[2019-08-13 16:02:08,706] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":613}
[2019-08-13 16:02:08,707] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":613}
[2019-08-13 16:02:08,707] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":613}
[2019-08-13 16:02:09,376] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-13 16:02:09,376] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-13 16:02:09,377] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":111},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:09,377] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":111},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:09,378] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:09,378] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:09,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:09,526] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:09,526] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":614,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:09,526] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":614,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:09,527] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":614}
[2019-08-13 16:02:09,527] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":614}
[2019-08-13 16:02:09,527] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":614}
[2019-08-13 16:02:09,527] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":614}
[2019-08-13 16:02:16,335] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:16,335] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:16,336] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":615,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":53}}}
[2019-08-13 16:02:16,336] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":615,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":53}}}
[2019-08-13 16:02:16,336] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (37, 53).
[2019-08-13 16:02:16,336] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (37, 53).
[2019-08-13 16:02:16,337] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:16,337] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:16,337] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:16,337] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:16,424] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:16,424] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:16,424] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":615}}
[2019-08-13 16:02:16,424] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":615}}
[2019-08-13 16:02:16,425] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(615)
[2019-08-13 16:02:16,425] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(615)
[2019-08-13 16:02:18,179] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2748
[2019-08-13 16:02:18,179] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2748
[2019-08-13 16:02:18,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":113},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", thpatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:18,180] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":113},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", thpatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:18,181] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:18,181] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:18,529] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2750
[2019-08-13 16:02:18,529] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2750
[2019-08-13 16:02:18,529] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":115},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", thispatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:18,529] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":115},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", thispatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:18,530] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:18,530] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:18,654] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:18,654] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:18,654] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":616,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:18,654] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":616,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:18,655] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":616}
[2019-08-13 16:02:18,655] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":616}
[2019-08-13 16:02:18,655] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":616}
[2019-08-13 16:02:18,655] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":616}
[2019-08-13 16:02:19,823] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2751
[2019-08-13 16:02:19,823] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2751
[2019-08-13 16:02:19,823] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":116},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", this.patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:19,823] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":116},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", this.patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:02:19,824] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:19,824] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:02:19,825] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 16:02:19,825] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 16:02:19,825] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":617,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":58}}}
[2019-08-13 16:02:19,825] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":617,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":58}}}
[2019-08-13 16:02:19,825] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 16:02:19,825] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 16:02:20,166] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:20,166] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:02:20,167] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":618,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:20,167] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":618,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:02:20,168] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":618}
[2019-08-13 16:02:20,168] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":618}
[2019-08-13 16:02:20,168] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":618}
[2019-08-13 16:02:20,168] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":618}
[2019-08-13 16:02:20,783] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:20,783] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:20,783] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":617}}
[2019-08-13 16:02:20,783] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":617}}
[2019-08-13 16:02:20,784] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(617)
[2019-08-13 16:02:20,784] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(617)
[2019-08-13 16:02:20,784] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 16:02:20,784] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 222
[2019-08-13 16:02:20,784] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":619,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":58}}}
[2019-08-13 16:02:20,784] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":619,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":58}}}
[2019-08-13 16:02:20,785] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 16:02:20,785] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Completions future completed: succes? false
[2019-08-13 16:02:32,121] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:32,121] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:32,121] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":620,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":36,"character":55}}}
[2019-08-13 16:02:32,121] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":620,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":36,"character":55}}}
[2019-08-13 16:02:32,122] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (36, 55).
[2019-08-13 16:02:32,122] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (36, 55).
[2019-08-13 16:02:32,122] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:32,122] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:32,122] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:32,122] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:32,252] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:32,252] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:32,252] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":620}}
[2019-08-13 16:02:32,252] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":620}}
[2019-08-13 16:02:32,252] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(620)
[2019-08-13 16:02:32,252] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(620)
[2019-08-13 16:02:34,750] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:34,750] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:34,750] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":619}}
[2019-08-13 16:02:34,750] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":619}}
[2019-08-13 16:02:34,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(619)
[2019-08-13 16:02:34,750] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(619)
[2019-08-13 16:02:53,958] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:53,958] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:02:53,958] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":621,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":14,"character":13}}}
[2019-08-13 16:02:53,958] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":621,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":14,"character":13}}}
[2019-08-13 16:02:53,959] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (14, 13).
[2019-08-13 16:02:53,959] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (14, 13).
[2019-08-13 16:02:53,959] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:53,959] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:53,959] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:53,959] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:54,008] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:54,008] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:54,008] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":621}}
[2019-08-13 16:02:54,008] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":621}}
[2019-08-13 16:02:54,009] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(621)
[2019-08-13 16:02:54,009] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(621)
[2019-08-13 16:02:54,846] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:02:54,846] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 216
[2019-08-13 16:02:54,846] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":622,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":9,"character":17}}}
[2019-08-13 16:02:54,846] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":622,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":9,"character":17}}}
[2019-08-13 16:02:54,846] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (9, 17).
[2019-08-13 16:02:54,846] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (9, 17).
[2019-08-13 16:02:54,847] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:54,847] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:02:54,847] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:54,847] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:02:54,895] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:54,895] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:02:54,896] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":622}}
[2019-08-13 16:02:54,896] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":622}}
[2019-08-13 16:02:54,896] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(622)
[2019-08-13 16:02:54,896] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(622)
[2019-08-13 16:03:57,164] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:03:57,164] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:03:57,164] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":623,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":30}}}
[2019-08-13 16:03:57,164] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":623,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":28,"character":30}}}
[2019-08-13 16:03:57,164] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 30).
[2019-08-13 16:03:57,164] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (28, 30).
[2019-08-13 16:03:57,165] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:03:57,165] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:03:57,165] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:03:57,165] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:03:57,305] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:03:57,305] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:03:57,305] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":623}}
[2019-08-13 16:03:57,305] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":623}}
[2019-08-13 16:03:57,306] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(623)
[2019-08-13 16:03:57,306] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(623)
[2019-08-13 16:03:59,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:03:59,221] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:03:59,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":624,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":57}}}
[2019-08-13 16:03:59,221] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":624,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":37,"character":57}}}
[2019-08-13 16:03:59,222] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (37, 57).
[2019-08-13 16:03:59,222] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (37, 57).
[2019-08-13 16:03:59,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:03:59,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:03:59,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:03:59,222] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:03:59,266] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:03:59,266] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:03:59,266] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":624}}
[2019-08-13 16:03:59,266] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":624}}
[2019-08-13 16:03:59,266] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(624)
[2019-08-13 16:03:59,266] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(624)
[2019-08-13 16:04:03,636] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2748
[2019-08-13 16:04:03,636] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2748
[2019-08-13 16:04:03,636] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":119},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", thpatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:04:03,636] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":119},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", thpatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:04:03,638] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:04:03,638] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:04:03,939] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2747
[2019-08-13 16:04:03,939] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2747
[2019-08-13 16:04:03,940] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":120},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", tpatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:04:03,940] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":120},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", tpatient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:04:03,941] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:04:03,941] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:04:04,154] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-13 16:04:04,154] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-13 16:04:04,155] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:04:04,155] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-13 16:04:04,156] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:04:04,156] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-13 16:04:04,309] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:04:04,309] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 188
[2019-08-13 16:04:04,309] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":625,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:04:04,309] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":625,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-13 16:04:04,310] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":625}
[2019-08-13 16:04:04,310] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":625}
[2019-08-13 16:04:04,310] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":625}
[2019-08-13 16:04:04,310] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":625}
[2019-08-13 16:04:07,669] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:04:07,669] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 217
[2019-08-13 16:04:07,670] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":626,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":35,"character":19}}}
[2019-08-13 16:04:07,670] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":626,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"},"position":{"line":35,"character":19}}}
[2019-08-13 16:04:07,670] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (35, 19).
[2019-08-13 16:04:07,670] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (35, 19).
[2019-08-13 16:04:07,670] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:04:07,670] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:04:07,670] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:04:07,670] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:04:07,719] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:04:07,719] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:04:07,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":626}}
[2019-08-13 16:04:07,720] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":626}}
[2019-08-13 16:04:07,720] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(626)
[2019-08-13 16:04:07,720] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(626)
[2019-08-13 16:04:51,153] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 16:04:51,153] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 170
[2019-08-13 16:04:51,154] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 16:04:51,154] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala"}}}
[2019-08-13 16:04:51,154] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 16:04:51,154] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/SparkApplication.scala from Ensime.
[2019-08-13 16:04:51,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2315
[2019-08-13 16:04:51,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2315
[2019-08-13 16:04:51,174] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.streaming._\nimport org.scalatest._\n\ntrait SparkStreamingSpec extends SparkSpec {\n  this: Suite =>\n\n  import java.nio.file.Files\n  import java.util.concurrent.TimeUnit\n\n  import ClockWrapper._\n\n  private var sscVar: StreamingContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    sscVar = new StreamingContext(sc, batchDuration)\n    sscVar.checkpoint(checkpointDir)\n  }\n\n  def batchDuration: Duration = Seconds(1)\n\n  def checkpointDir: String = Files.createTempDirectory(this.getClass.getSimpleName).toUri.toString\n\n  override def afterAll(): Unit = {\n    if (sscVar != null) {\n      sscVar.stop(stopSparkContext = false, stopGracefully = false)\n      sscVar = null // scalastyle:ignore null\n    }\n\n    super.afterAll()\n  }\n\n  override def sparkConfig: Map[String, String] = {\n    super.sparkConfig + (\"spark.streaming.clock\" -> \"org.apache.spark.streaming.util.ManualClock\")\n  }\n\n  def ssc: StreamingContext = sscVar\n\n  def advanceClock(timeToAdd: FiniteDuration): Unit = {\n    advance(sscVar, timeToAdd)\n  }\n\n  def advanceClockOneBatch(): Unit = {\n    advance(sscVar, FiniteDuration(batchDuration.milliseconds, TimeUnit.MILLISECONDS))\n  }\n\n}\n"}}}
[2019-08-13 16:04:51,174] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport scala.concurrent.duration.FiniteDuration\n\nimport org.apache.spark.streaming._\nimport org.scalatest._\n\ntrait SparkStreamingSpec extends SparkSpec {\n  this: Suite =>\n\n  import java.nio.file.Files\n  import java.util.concurrent.TimeUnit\n\n  import ClockWrapper._\n\n  private var sscVar: StreamingContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    sscVar = new StreamingContext(sc, batchDuration)\n    sscVar.checkpoint(checkpointDir)\n  }\n\n  def batchDuration: Duration = Seconds(1)\n\n  def checkpointDir: String = Files.createTempDirectory(this.getClass.getSimpleName).toUri.toString\n\n  override def afterAll(): Unit = {\n    if (sscVar != null) {\n      sscVar.stop(stopSparkContext = false, stopGracefully = false)\n      sscVar = null // scalastyle:ignore null\n    }\n\n    super.afterAll()\n  }\n\n  override def sparkConfig: Map[String, String] = {\n    super.sparkConfig + (\"spark.streaming.clock\" -> \"org.apache.spark.streaming.util.ManualClock\")\n  }\n\n  def ssc: StreamingContext = sscVar\n\n  def advanceClock(timeToAdd: FiniteDuration): Unit = {\n    advance(sscVar, timeToAdd)\n  }\n\n  def advanceClockOneBatch(): Unit = {\n    advance(sscVar, FiniteDuration(batchDuration.milliseconds, TimeUnit.MILLISECONDS))\n  }\n\n}\n"}}}
[2019-08-13 16:04:51,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 16:04:51,174] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 187
[2019-08-13 16:04:51,174] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":627,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 16:04:51,174] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":627,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 16:04:51,175] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":627}
[2019-08-13 16:04:51,175] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":627}
[2019-08-13 16:04:51,175] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":627}
[2019-08-13 16:04:51,175] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":627}
[2019-08-13 16:04:53,819] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 172
[2019-08-13 16:04:53,819] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 172
[2019-08-13 16:04:53,819] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 16:04:53,819] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala"}}}
[2019-08-13 16:04:53,820] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala from Ensime.
[2019-08-13 16:04:53,820] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkStreamingSpec.scala from Ensime.
[2019-08-13 16:04:53,833] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1719
[2019-08-13 16:04:53,833] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 1719
[2019-08-13 16:04:53,833] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport org.apache.spark._\nimport org.scalatest._\n\ntrait SparkSpec extends BeforeAndAfterAll {\n  this: Suite =>\n\n  private var scVar: SparkContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    val conf = new SparkConf()\n      .setMaster(\"local[*]\")\n      .setAppName(this.getClass.getSimpleName)\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    scVar = new SparkContext(conf)\n  }\n\n  def sparkConfig: Map[String, String] = Map.empty\n\n  override def afterAll(): Unit = {\n    if (scVar != null) {\n      scVar.stop()\n      scVar = null // scalastyle:ignore null\n    }\n    super.afterAll()\n  }\n\n  def sc: SparkContext = scVar\n\n}\n"}}}
[2019-08-13 16:04:53,833] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala","languageId":"scala","version":1,"text":"// Copyright (C) 2011-2012 the original author or authors.\n// See the LICENCE.txt file distributed with this work for additional\n// information regarding copyright ownership.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage org.spark.stream\n\nimport org.apache.spark._\nimport org.scalatest._\n\ntrait SparkSpec extends BeforeAndAfterAll {\n  this: Suite =>\n\n  private var scVar: SparkContext = _ // scalastyle:ignore var.field\n\n  override def beforeAll(): Unit = {\n    super.beforeAll()\n\n    val conf = new SparkConf()\n      .setMaster(\"local[*]\")\n      .setAppName(this.getClass.getSimpleName)\n\n    sparkConfig.foreach { case (k, v) => conf.setIfMissing(k, v) }\n\n    scVar = new SparkContext(conf)\n  }\n\n  def sparkConfig: Map[String, String] = Map.empty\n\n  override def afterAll(): Unit = {\n    if (scVar != null) {\n      scVar.stop()\n      scVar = null // scalastyle:ignore null\n    }\n    super.afterAll()\n  }\n\n  def sc: SparkContext = scVar\n\n}\n"}}}
[2019-08-13 16:04:53,835] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 178
[2019-08-13 16:04:53,835] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 178
[2019-08-13 16:04:53,835] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":628,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 16:04:53,835] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":628,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-13 16:04:53,835] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":628}
[2019-08-13 16:04:53,835] DEBUG langserver.core.MessageWriter - Content-Length: 38



{"jsonrpc":"2.0","result":[],"id":628}
[2019-08-13 16:04:53,835] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":628}
[2019-08-13 16:04:53,835] DEBUG langserver.core.MessageWriter - payload: {"jsonrpc":"2.0","result":[],"id":628}
[2019-08-13 16:07:27,547] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 206
[2019-08-13 16:07:27,547] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 206
[2019-08-13 16:07:27,547] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":629,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":5,"character":41}}}
[2019-08-13 16:07:27,547] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":629,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":5,"character":41}}}
[2019-08-13 16:07:27,548] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 41).
[2019-08-13 16:07:27,548] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (5, 41).
[2019-08-13 16:07:27,549] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:07:27,549] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:07:27,549] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:07:27,549] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:07:27,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:07:27,596] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:07:27,596] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":629}}
[2019-08-13 16:07:27,596] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":629}}
[2019-08-13 16:07:27,597] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(629)
[2019-08-13 16:07:27,597] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(629)
[2019-08-13 16:07:28,046] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 207
[2019-08-13 16:07:28,046] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 207
[2019-08-13 16:07:28,047] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":630,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":10,"character":38}}}
[2019-08-13 16:07:28,047] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","id":630,"method":"textDocument/hover","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"},"position":{"line":10,"character":38}}}
[2019-08-13 16:07:28,047] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (10, 38).
[2019-08-13 16:07:28,047] INFO org.github.dragos.vscode.EnsimeLanguageServer - Got hover request at (10, 38).
[2019-08-13 16:07:28,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:07:28,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - DocUriAtPointReq future completed: succes? false
[2019-08-13 16:07:28,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:07:28,047] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - TypeAtPointReq future completed: succes? false
[2019-08-13 16:07:28,119] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:07:28,119] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 64
[2019-08-13 16:07:28,120] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":630}}
[2019-08-13 16:07:28,120] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"$/cancelRequest","params":{"id":630}}
[2019-08-13 16:07:28,120] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(630)
[2019-08-13 16:07:28,120] ERROR org.github.dragos.vscode.EnsimeLanguageServer - Unknown notification CancelRequest(630)
[2019-08-14 08:57:46,429] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 163
[2019-08-14 08:57:46,429] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 163
[2019-08-14 08:57:46,429] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-14 08:57:46,429] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala"}}}
[2019-08-14 08:57:46,429] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala from Ensime.
[2019-08-14 08:57:46,429] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/test/scala/org/spark/stream/SparkSpec.scala from Ensime.
[2019-08-14 09:31:39,425] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-14 09:31:39,425] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-14 09:31:39,425] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-14 09:31:39,425] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-14 09:31:39,425] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-14 09:31:39,425] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-14 09:31:40,944] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-14 09:31:40,944] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 2746
[2019-08-14 09:31:40,944] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-14 09:31:40,944] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121},"contentChanges":[{"text":"package org.spark.stream\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types.{StructField, _}\n\n/**\n  * Spark Streaming Kafka Cassandra\n  */\nobject NetworkQualityStreamingJob extends App {\n\n  val config = ConfigUtil.getConfig(\"spark\")\n\n  // spark config\n  val spark: SparkSession = SparkSession.builder\n    .appName(getClass.getSimpleName)\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-sql-kafka-0-10_2.11:2.3.3\")\n    .config(\"spark.executor.memory\", \"10G\")\n    .config(\"spark.driver.memory\", \"10G\")\n    .config(\"spark.driver.maxResultSize\", \"10G\")\n    .getOrCreate()\n\n  import spark.implicits._\n\n  // define schema for json\n\nval patient= StructType(ArrayType(\n  StructField(\"patient_id\", LongType, True),\n  StructField(\"date_created\", LongType, True),\n  StructField(\"creator\", LongType, True)\n))\n\nval schema= StructType(ArrayType(\n                StructField(\"schema\", StringType,\n                StructField(\"payload\", \n                           StructType(ArrayType(\n                                StructField(\"before\", StringType,\n                                StructField(\"after\", patient)\n                           ))\n                           )\n))\n\n  // create stream\n  val df = spark\n    .readStream\n    .format(\"kafka\")\n    .option(\"kafka.bootstrap.servers\", \"localhost:9092\")\n    .option(\"subscribe\", \"dbserver1.openmrs.patient\")\n    .load()\n    .selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n    .select(from_json($\"value\", schema).alias(\"parsed_value\"))\n  //.withColumn(\"after\", explode($\"parsed_value.payload\"))\n\n  df.createOrReplaceTempView(\"patients\")\n\n  val sql =\n    \"\"\"\n    SELECT\n      WINDOW(FROM_UNIXTIME(parsed_value.payload.after.date_created/1000), \"1 hour\", \"10 minutes\") AS eventWindow,\n      parsed_value.payload.after.creator AS creator,\n      AVG(parsed_value.payload.after.patient_id) AS avgAge,\n      MIN(parsed_value.payload.after.patient_id) AS minAge,\n      MAX(parsed_value.payload.after.patient_id) AS maxAge\n    FROM\n      patients\n    GROUP BY\n      eventWindow,\n      creator\n    ORDER BY\n      eventWindow,\n      creator\n  \"\"\"\n  val query = spark.sql(sql)\n\n  // show results\n  val result = query.writeStream\n    .format(\"console\")\n    .outputMode(\"complete\")\n    .option(\"truncate\", \"false\")\n    .start()\n\n  result.awaitTermination()\n\n}"}]}}
[2019-08-14 09:31:40,944] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-14 09:31:40,944] ERROR langserver.core.Connection - failed notification handler
java.lang.NullPointerException: null
	at org.github.dragos.vscode.EnsimeLanguageServer.onChangeTextDocument(EnsimeLanguageServer.scala:167)
	at langserver.core.LanguageServer.$anonfun$new$1(LanguageServer.scala:42)
	at langserver.core.LanguageServer.$anonfun$new$1$adapted(LanguageServer.scala:40)
	at langserver.core.Connection.$anonfun$notifySubscribers$2(Connection.scala:42)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at scala.util.Try$.apply(Try.scala:209)
	at langserver.core.Connection.$anonfun$notifySubscribers$1(Connection.scala:42)
	at scala.collection.immutable.List.foreach(List.scala:389)
	at scala.collection.generic.TraversableForwarder.foreach(TraversableForwarder.scala:35)
	at scala.collection.generic.TraversableForwarder.foreach$(TraversableForwarder.scala:35)
	at scala.collection.mutable.ListBuffer.foreach(ListBuffer.scala:44)
	at langserver.core.Connection.notifySubscribers(Connection.scala:41)
	at langserver.core.Connection.$anonfun$start$4(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$4$adapted(Connection.scala:99)
	at play.api.libs.json.JsSuccess.fold(JsResult.scala:15)
	at langserver.core.Connection.$anonfun$start$2(Connection.scala:99)
	at langserver.core.Connection.$anonfun$start$2$adapted(Connection.scala:97)
	at scala.Option.fold(Option.scala:158)
	at langserver.core.Connection.start(Connection.scala:97)
	at langserver.core.LanguageServer.start(LanguageServer.scala:50)
	at org.github.dragos.vscode.EnsimeLanguageServer.start(EnsimeLanguageServer.scala:51)
	at org.github.dragos.vscode.Main$.main(Main.scala:23)
	at org.github.dragos.vscode.Main.main(Main.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.cli.qn.a(Unknown Source)
	at coursier.cli.qm.i(Unknown Source)
	at coursier.cli.qs.a(Unknown Source)
	at c.g.a.c(Unknown Source)
	at a.b.d_(Unknown Source)
	at c.b.d.E.g(Unknown Source)
	at c.b.e.aU.g(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.qm.b(Unknown Source)
	at coursier.cli.M.b(Unknown Source)
	at a.J.d_(Unknown Source)
	at c.E.h(Unknown Source)
	at a.c.a(Unknown Source)
	at coursier.cli.Coursier.main(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at coursier.Bootstrap.main(Bootstrap.java:412)
[2019-08-14 09:31:40,944] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 186
[2019-08-14 09:31:40,944] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 186
[2019-08-14 09:31:40,944] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121}}}
[2019-08-14 09:31:40,944] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala","version":121}}}
[2019-08-14 09:31:40,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala)
[2019-08-14 09:31:40,944] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - saveTextDocuemnt TextDocumentIdentifier(file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala)
[2019-08-14 09:31:40,945] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-14 09:31:40,945] DEBUG langserver.core.MessageReader - Received headers:
Content-Length: 173
[2019-08-14 09:31:40,945] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-14 09:31:40,945] DEBUG langserver.core.Connection - Received {"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala"}}}
[2019-08-14 09:31:40,945] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala from Ensime.
[2019-08-14 09:31:40,945] DEBUG org.github.dragos.vscode.EnsimeLanguageServer - Removing file:///home/air/openmrs-etl/src/main/scala/org/spark/stream/StructuredStreaming.scala from Ensime.
